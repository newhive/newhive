{# 
  Render a tag
  main_view: true if main tag list, false if on expr hover
  suppress_link: true to suppress the natural tag link behavior
  item: tag name
#}
{set "tag_name" item}
{<unless suppress_link}
  <a {<if (and
        (or (eq tag_name "remix") (eq tag_name "remixed")) 
        (or remix_root_tag expr.remix_root_tag)) }
      {anchor_attrs "expressions_tag" "owner_name" 
        (or expr.remix_root_owner remix_root_owner)
        "tag_name" (or remix_root_tag expr.remix_root_tag)}
    {>}{<else}
      {<if (and route.include_categories main_view)}
        { anchor_attrs "collections_grid_cat" "owner_name" owner.name 
          "tag_name" tag_name}
      {>}{<elif route.include_tags}
        {# { search_attrs "@" page_data.owner.name " " "" "#" tag_name } #}
        {<if (and route.private (eq user.name page_data.owner.name))}
          {anchor_attrs "expressions_tag_private" 
            "entropy" (get tag_entropy tag_name) "owner_name" owner.name "tag_name" tag_name}
        {>}{<else}
          {<if (or (eq route_name "expressions_tag") 
            (eq route_name "expressions_public_tags"))}
            {anchor_attrs "expressions_tag" "owner_name" owner.name "tag_name" tag_name}
          {>}{<else}
            {anchor_attrs "expressions_public_grid_tags" "owner_name" 
              owner.name "tag_name" tag_name}
          {>}
        {>}
      {>}{<else}
        { query_attrs "search" (concat "q=#" tag_name) }
      {>}
    {>}
  >
{>}
<div class=
  {<if (and main_view tag_selected (neq tag_selected tag_name))}
    "tag_label tag_unselected"
  {>}{<else}
    "tag_label tag_{mod tagnum 16}"
  {>}
>{tag_name}</div>
{cond suppress_link "" "</a>"}
