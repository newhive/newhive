{% extends "emails/colorful.html" %}

{% block body_classes%}{{super()}} {{type}}{% endblock %}
{% block body %}

{% macro link(entity, class='', id='') -%}
<a href="{{ entity.url | modify_query({'email_id': email_id})}}" title="{{ entity.title or entity.fullname }}" class="{{ class }}" id="{{ id}}">
    {{ caller() }}
</a>
{%- endmacro %}
{% from "emails/base.html" import track_link %}

{% if recipient and recipient.name %}
    <h2 id="greeting" class="line">
        Hi {{ recipient.name }},
    </h2>
{% endif %}

{% block main_message scoped %}
    {% if header %}
    <h2 id="main_message">
            <div class="line" id="line1">
                {% if initiator %}
                    {% call link(initiator, class="sender") -%}
                        {{ initiator.name }}
                    {%- endcall %}
                {% endif %}
                {{ header[0] | safe }}
                <img src="{{icon}}"/>
            </div>
            <div class="line" id="line2">
                {{ header[1] | safe }}
            </div>
        </h2>
    {% endif %}
{% endblock %}

{% if message %}
    <p id="message">
        {% if message_safe %}
        {{ message | safe }}
        {% else %}
        {{ message | escape | html_breaks }}
        {% endif %}
    </p>
{% endif %}

{% if expr %}
  {% include 'emails/parts/expr_card.html' %}
{% endif %}

{% if featured_exprs %}
    <div id="featured_exprs">
        {% if initiator and initiator.name %}
        <h4 class="user"><span>
            Check out some of {{initiator.name}}'s expressions:
        </h4></span>
        {% else %}
        <h4 class="site"><span>
            Explore Expressions
        </h4></span>
        {% endif %}
        {% for expr in featured_exprs -%}
          <a href="{{expr.url}}" title="{{expr.title}}" id="{{expr.id}}"
              ><img class="featured_thumb" src="{{expr.thumb}}"/
          ></a>
        {%- endfor %}
    </div>
{% endif %}

{% block footer_message scoped %}
    <h4 id="footer_message">
        {% if recipient and recipient.id %}
            Love Newhive?<br/>
            <a class="highlight" href="{{ invite_friends_url }}" title="Invite your friends">Invite your friends!</a>
        {% else %}
            Want to make your own expression?<br/>
            {% call track_link(signup_url, "Create your account", email_id) -%}
                Create your Newhive account!
            {%- endcall %}
        {% endif %}
    </h4>
{% endblock %}

{% endblock %}
