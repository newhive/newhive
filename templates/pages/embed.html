<!DOCTYPE HTML>
<html>
<head>
  <link id='css_minimal' rel='stylesheet' type='text/css' href='{{ asset_bundle('minimal.css')[0] }}'>
  <meta id='viewport' name='viewport'>
  <meta property='og:url' content='{{ expr.url }}'>
  <style>

body, html, #exprs { height:100%; }
body { overflow:hidden; }
iframe { border:none; width:100%; height:100% }
.hide { display:none; }
.icon { display:inline-block; background-size:100%; }
.hinv:hover { filter:invert(100%); -webkit-filter:invert(100%); }
.center { margin:auto; left:0;top:0;right:0;bottom:0; }

.snapshot { width:100%; position:fixed; }
#play { position:fixed; width:50%; height:50%; margin:auto;
  top:0;right:0;bottom:0;left:0; opacity:.85; }

.bbar { position:fixed; bottom:0; height:60px; width:100%; }
#bbar { transition-property:opacity; transition-duration:1s; opacity:0; }
#bbar:hover { opacity: 1; }
#bbar .shader { background-color:#fff; opacity:.85; }
#bbar .icon { height:60px; width:60px; }
#bbar .right { position:absolute; right:0; top:0;
  width:180px; height:100%; margin-right:5px; }
#bbar .logo { margin-left:5px;
  background-image:url('{{ "skin/nav/logo.png"|asset_url }}'); }
#bbar .logo:hover {
  background-image:url('{{ "skin/nav/logo-hover.png"|asset_url }}');
  background-color: black; }
#bbar .hinv:hover { background-color:white; }

#share { position:absolute; width:575px; height:190px; }
#share .icon { width:150px; height:150px; border-radius:75px;
  background-color:black; margin:20px; }
#share .icon img { width:100px; padding:25px; }
#share .link { position:absolute; right:0; bottom:0; width:200px;
  font-size:large; }

  </style>
</head>
<body class='{% block body_class %}{% endblock %}'>
  <div id='overlays'>
    <div class='bbar{% if not query.autoplay %} hide{% endif %}' id='bbar'>
      <div class='bbar shader' id='shader'></div>
      <div class='bbar unshaded'>
        <a href='{{ expr.url }}' class='icon logo'></a>
        <div class='right'
          ><img class='icon hinv' id='share_btn'
            src='{{ "skin/nav/share.png"|asset_url }}'
          ><img class='icon hinv' id='full'
            src='{{ "skin/nav/fullscreen.png"|asset_url }}'
          ><img class='icon hinv' id='pause'
            src='{{ "skin/nav/pause.svg"|asset_url }}'
        ></div>
      </div> 
    </div>
    <div id='share' class='hide center'
      ><a href='https://twitter.com/share?url={{ expr.url }}&related=NewHive&text={{ ("\""+expr.title+"\" by "+expr.owner.fullname)|e }}' target='_new' title='Share on twitter'><div class='icon hinv'><img src='{{ "skin/nav/twitter.svg"|asset_url }}'></div></a
      ><a href='https://www.facebook.com/sharer/sharer.php?u={{ expr.url|e }}'target='_new' title='Share on facebook'><div class='icon hinv'><img src='{{ "skin/nav/fb-f.svg"|asset_url }}'></div></a
      ><div class='icon hinv' id='link_btn'
        ><img src='{{ "skin/nav/link.svg"|asset_url }}'
        ><input readonly type='text' value='{{ expr.url }}' id='link'
          class='link hide'
      ></div
    ></div>
  </div>

  <div id='exprs'>
    <iframe id='expr_{{ expr.id }}' data-src='{{ content_url }}'
      {% if not query.autoplay %}
        src='{{ content_url }}'
        class='expr hide'
      {% else %}
        class='expr'
      {% endif %}
      allowfullscreen></iframe>
    <div id='preview' class='{% if query.autoplay %}hide{% endif %}'>
      <img src='{{ expr.snapshot_name('big') }}' class='snapshot center'>
      <img id='play' class='hinv' src='{{ "skin/nav/newhive-play.svg"|asset_url }}'>
    </div>
  </div>
  <script>

var play_btn = document.getElementById('play')
   ,preview = document.getElementById('preview')
   ,bbar = document.getElementById('bbar')
   ,pause = document.getElementById('pause')
   ,full = document.getElementById('full')
   ,share = document.getElementById('share')
   ,link = document.getElementById('link')
   ,link_btn = document.getElementById('link_btn')
   ,f = document.getElementById('expr_' + {{ expr.id|json }})

play.onclick = function(){
  preview.classList.add('hide')
  f.setAttribute('src', f.getAttribute('data-src'))
  f.classList.remove('hide')
  bbar.classList.remove('hide')
}
pause.onclick = function(){
  f.classList.add('hide')
  preview.classList.remove('hide')
  f.setAttribute('src', '')
  bbar.classList.add('hide')
}

full.onclick = function(){
  (f.webkitRequestFullscreen || f.mozRequestFullScreen || f.requestFullscreen
    ).call(f)
}

document.getElementById('share_btn').onclick = function(){
  share.classList.remove('hide') }
onmessage = function(){ share.classList.add('hide') }
link_btn.onmouseover = function(){
  link.classList.remove('hide')
  link.focus()
  link.select()
}
link_btn.onmouseout = function(){
  link.classList.add('hide')
}

  </script>
</body>
</html>
