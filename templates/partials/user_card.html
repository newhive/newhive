{% from "macros/main.html" import person_thumb, listen_button %} 

<a href='{{ item.url }}'><div class='user card item border_right border_bottom {{ item.id }} with_hide' draggable='false'>
  <input type='hidden' class='entity_id' value='{{ item.id }}'>
  <img src='{{ item.thumb }}' style='background: {{ colors[range(32)|random] }};' class='thumb'>
  <div class='title'>{{ item.fullname|e }}</div>
  <div class='tags'>{% if item and item.expr_count > 0 %}{{ item.expr_count ~ " expression" ~ ("s" if item.expr_count > 1) }}{% endif %}</div>
  <div class='other'><span>{{ item.name }}</span></div>
  {% if item != user %}<div class='stats inactive_hide'>{{ listen_button(item, user) }}</div>{% endif %}
  {% if item.feed %}
    <div class='feed_info'>
      {% if item.feed[0].class_name == 'Star' and item.feed[0].initiator == user %}
        <div>you're listening to {{ item.feed[0].entity.name }}</div>
      {% elif item.feed[0].class_name == 'Star' and item.feed[0].entity == user %}
        <div>{{ item.feed[0].initiator.name }} is listening to you</div>
      {% elif item.feed[0].class_name == 'Star' %}
        <div>{{ item.feed[0].initiator.name }} is listening to {{ item.feed[0].entity.name }}</div>
      {% else %}
        <div>{{ 'you' if item.feed[0].initiator == user else item.feed[0].initiator.name }}
          {{ item.feed[0].action_name }}</div>
      {% endif %}
    </div>
  {% endif %}
</div></a>
