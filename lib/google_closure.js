var COMPILED=false;var goog=goog||{};goog.global=this;goog.DEBUG=true;goog.LOCALE="en";goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a)){throw Error('Namespace "'+a+'" already declared.')}delete goog.implicitNamespaces_[a];var b=a;while((b=b.substring(0,b.lastIndexOf(".")))){if(goog.getObjectByName(b)){break}goog.implicitNamespaces_[b]=true}}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG){a=a||"";throw Error("Importing test-only code into non-debug environment"+a?": "+a:".")}};if(!COMPILED){goog.isProvided_=function(a){return !goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)};goog.implicitNamespaces_={}}goog.exportPath_=function(c,a,f){var d=c.split(".");var e=f||goog.global;if(!(d[0] in e)&&e.execScript){e.execScript("var "+d[0])}for(var b;d.length&&(b=d.shift());){if(!d.length&&goog.isDef(a)){e[b]=a}else{if(e[b]){e=e[b]}else{e=e[b]={}}}}};goog.getObjectByName=function(b,c){var d=b.split(".");var e=c||goog.global;for(var a;a=d.shift();){if(goog.isDefAndNotNull(e[a])){e=e[a]}else{return null}}return e};goog.globalize=function(d,b){var c=b||goog.global;for(var a in d){c[a]=d[a]}};goog.addDependency=function(e,d,k){if(!COMPILED){var f,a;var h=e.replace(/\\/g,"/");var g=goog.dependencies_;for(var c=0;f=d[c];c++){g.nameToPath[f]=h;if(!(h in g.pathToNames)){g.pathToNames[h]={}}g.pathToNames[h][f]=true}for(var b=0;a=k[b];b++){if(!(h in g.requires)){g.requires[h]={}}g.requires[h][a]=true}}};goog.ENABLE_DEBUG_LOADER=true;goog.require=function(b){if(!COMPILED){if(goog.isProvided_(b)){return}if(goog.ENABLE_DEBUG_LOADER){var c=goog.getPathFromDeps_(b);if(c){goog.included_[c]=true;goog.writeScripts_();return}}var a="goog.require could not find: "+b;if(goog.global.console){goog.global.console.error(a)}throw Error(a)}};goog.basePath="";goog.global.CLOSURE_BASE_PATH;goog.global.CLOSURE_NO_DEPS;goog.global.CLOSURE_IMPORT_SCRIPT;goog.nullFunction=function(){};goog.identityFunction=function(b,a){return b};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_){return a.instance_}if(goog.DEBUG){goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a}return a.instance_=new a}};goog.instantiatedSingletons_=[];if(!COMPILED&&goog.ENABLE_DEBUG_LOADER){goog.included_={};goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}};goog.inHtmlDocument_=function(){var a=goog.global.document;return typeof a!="undefined"&&"write" in a};goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH){goog.basePath=goog.global.CLOSURE_BASE_PATH;return}else{if(!goog.inHtmlDocument_()){return}}var e=goog.global.document;var a=e.getElementsByTagName("script");for(var c=a.length-1;c>=0;--c){var f=a[c].src;var d=f.lastIndexOf("?");var b=d==-1?f.length:d;if(f.substr(b-7,7)=="base.js"){goog.basePath=f.substr(0,b-7);return}}};goog.importScript_=function(b){var a=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;if(!goog.dependencies_.written[b]&&a(b)){goog.dependencies_.written[b]=true}};goog.writeScriptTag_=function(b){if(goog.inHtmlDocument_()){var a=goog.global.document;a.write('<script type="text/javascript" src="'+b+'"><\/script>');return true}else{return false}};goog.writeScripts_=function(){var a=[];var b={};var f=goog.dependencies_;function e(g){if(g in f.written){return}if(g in f.visited){if(!(g in b)){b[g]=true;a.push(g)}return}f.visited[g]=true;if(g in f.requires){for(var h in f.requires[g]){if(!goog.isProvided_(h)){if(h in f.nameToPath){e(f.nameToPath[h])}else{throw Error("Undefined nameToPath for "+h)}}}}if(!(g in b)){b[g]=true;a.push(g)}}for(var d in goog.included_){if(!f.written[d]){e(d)}}for(var c=0;c<a.length;c++){if(a[c]){goog.importScript_(goog.basePath+a[c])}else{throw Error("Undefined script input")}}};goog.getPathFromDeps_=function(a){if(a in goog.dependencies_.nameToPath){return goog.dependencies_.nameToPath[a]}else{return null}};goog.findBasePath_();if(!goog.global.CLOSURE_NO_DEPS){goog.importScript_(goog.basePath+"deps.js")}}goog.typeOf=function(c){var b=typeof c;if(b=="object"){if(c){if(c instanceof Array){return"array"}else{if(c instanceof Object){return b}}var a=Object.prototype.toString.call((c));if(a=="[object Window]"){return"object"}if((a=="[object Array]"||typeof c.length=="number"&&typeof c.splice!="undefined"&&typeof c.propertyIsEnumerable!="undefined"&&!c.propertyIsEnumerable("splice"))){return"array"}if((a=="[object Function]"||typeof c.call!="undefined"&&typeof c.propertyIsEnumerable!="undefined"&&!c.propertyIsEnumerable("call"))){return"function"}}else{return"null"}}else{if(b=="function"&&typeof c.call=="undefined"){return"object"}}return b};goog.isDef=function(a){return a!==undefined};goog.isNull=function(a){return a===null};goog.isDefAndNotNull=function(a){return a!=null};goog.isArray=function(a){return goog.typeOf(a)=="array"};goog.isArrayLike=function(b){var a=goog.typeOf(b);return a=="array"||a=="object"&&typeof b.length=="number"};goog.isDateLike=function(a){return goog.isObject(a)&&typeof a.getFullYear=="function"};goog.isString=function(a){return typeof a=="string"};goog.isBoolean=function(a){return typeof a=="boolean"};goog.isNumber=function(a){return typeof a=="number"};goog.isFunction=function(a){return goog.typeOf(a)=="function"};goog.isObject=function(b){var a=typeof b;return a=="object"&&b!=null||a=="function"};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(b){if("removeAttribute" in b){b.removeAttribute(goog.UID_PROPERTY_)}try{delete b[goog.UID_PROPERTY_]}catch(a){}};goog.UID_PROPERTY_="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(c){var b=goog.typeOf(c);if(b=="object"||b=="array"){if(c.clone){return c.clone()}var d=b=="array"?[]:{};for(var a in c){d[a]=goog.cloneObject(c[a])}return d}return c};Object.prototype.clone;goog.bindNative_=function(a,c,b){return(a.call.apply(a.bind,arguments))};goog.bindJs_=function(a,d,b){if(!a){throw new Error()}if(arguments.length>2){var c=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,c);return a.apply(d,e)}}else{return function(){return a.apply(d,arguments)}}};goog.bind=function(a,c,b){if(Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1){goog.bind=goog.bindNative_}else{goog.bind=goog.bindJs_}return goog.bind.apply(null,arguments)};goog.partial=function(b,c){var a=Array.prototype.slice.call(arguments,1);return function(){var d=Array.prototype.slice.call(arguments);d.unshift.apply(d,a);return b.apply(this,d)}};goog.mixin=function(c,b){for(var a in b){c[a]=b[a]}};goog.now=Date.now||(function(){return +new Date()});goog.globalEval=function(script){if(goog.global.execScript){goog.global.execScript(script,"JavaScript")}else{if(goog.global.eval){if(goog.evalWorksForGlobals_==null){goog.global.eval("var _et_ = 1;");if(typeof goog.global._et_!="undefined"){delete goog.global._et_;goog.evalWorksForGlobals_=true}else{goog.evalWorksForGlobals_=false}}if(goog.evalWorksForGlobals_){goog.global.eval(script)}else{var doc=goog.global.document;var scriptElt=doc.createElement("script");scriptElt.type="text/javascript";scriptElt.defer=false;scriptElt.appendChild(doc.createTextNode(script));doc.body.appendChild(scriptElt);doc.body.removeChild(scriptElt)}}else{throw Error("goog.globalEval not available")}}};goog.evalWorksForGlobals_=null;goog.cssNameMapping_;goog.cssNameMappingStyle_;goog.getCssName=function(e,c){var d=function(f){return goog.cssNameMapping_[f]||f};var b=function(j){var h=j.split("-");var f=[];for(var g=0;g<h.length;g++){f.push(d(h[g]))}return f.join("-")};var a;if(goog.cssNameMapping_){a=goog.cssNameMappingStyle_=="BY_WHOLE"?d:b}else{a=function(f){return f}}if(c){return e+"-"+a(c)}else{return a(e)}};goog.setCssNameMapping=function(b,a){goog.cssNameMapping_=b;goog.cssNameMappingStyle_=a};goog.global.CLOSURE_CSS_NAME_MAPPING;if(!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING){goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING}goog.getMsg=function(d,e){var a=e||{};for(var b in a){var c=(""+a[b]).replace(/\$/g,"$$$$");d=d.replace(new RegExp("\\{\\$"+b+"\\}","gi"),c)}return d};goog.exportSymbol=function(b,a,c){goog.exportPath_(b,a,c)};goog.exportProperty=function(b,a,c){b[a]=c};goog.inherits=function(b,a){function c(){}c.prototype=a.prototype;b.superClass_=a.prototype;b.prototype=new c();b.prototype.constructor=b};goog.base=function(e,a,g){var c=arguments.callee.caller;if(c.superClass_){return c.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1))}var b=Array.prototype.slice.call(arguments,2);var f=false;for(var d=e.constructor;d;d=d.superClass_&&d.superClass_.constructor){if(d.prototype[a]===c){f=true}else{if(f){return d.prototype[a].apply(e,b)}}}if(e[a]===c){return e.constructor.prototype[a].apply(e,b)}else{throw Error("goog.base called from a method of one name to a method of a different name")}};goog.scope=function(a){a.call(goog.global)};goog.provide("goog.debug.Error");goog.debug.Error=function(a){if(Error.captureStackTrace){Error.captureStackTrace(this,goog.debug.Error)}else{this.stack=new Error().stack||""}if(a){this.message=String(a)}};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.provide("goog.string");goog.provide("goog.string.Unicode");goog.string.Unicode={NBSP:"\xa0"};goog.string.startsWith=function(b,a){return b.lastIndexOf(a,0)==0};goog.string.endsWith=function(c,b){var a=c.length-b.length;return a>=0&&c.indexOf(b,a)==a};goog.string.caseInsensitiveStartsWith=function(b,a){return goog.string.caseInsensitiveCompare(a,b.substr(0,a.length))==0};goog.string.caseInsensitiveEndsWith=function(b,a){return goog.string.caseInsensitiveCompare(a,b.substr(b.length-a.length,a.length))==0};goog.string.subs=function(d,c){for(var a=1;a<arguments.length;a++){var b=String(arguments[a]).replace(/\$/g,"$$$$");d=d.replace(/\%s/,b)}return d};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptySafe=function(a){return goog.string.isEmpty(goog.string.makeSafe(a))};goog.string.isBreakingWhitespace=function(a){return !/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return !/[^a-zA-Z]/.test(a)};goog.string.isNumeric=function(a){return !/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return !/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return a==" "};goog.string.isUnicodeChar=function(a){return a.length==1&&a>=" "&&a<="~"||a>="\u0080"&&a<="\uFFFD"};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(d,c){var b=String(d).toLowerCase();var a=String(c).toLowerCase();if(b<a){return -1}else{if(b==a){return 0}else{return 1}}};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;goog.string.numerateCompare=function(f,e){if(f==e){return 0}if(!f){return -1}if(!e){return 1}var d=f.toLowerCase().match(goog.string.numerateCompareRegExp_);var c=e.toLowerCase().match(goog.string.numerateCompareRegExp_);var h=Math.min(d.length,c.length);for(var g=0;g<h;g++){var m=d[g];var l=c[g];if(m!=l){var k=parseInt(m,10);if(!isNaN(k)){var j=parseInt(l,10);if(!isNaN(j)&&k-j){return k-j}}return m<l?-1:1}}if(d.length!=c.length){return d.length-c.length}return f<e?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(b,a){return b.replace(/(\r\n|\r|\n)/g,a?"<br />":"<br>")};goog.string.htmlEscape=function(b,a){if(a){return b.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;")}else{if(!goog.string.allRe_.test(b)){return b}if(b.indexOf("&")!=-1){b=b.replace(goog.string.amperRe_,"&amp;")}if(b.indexOf("<")!=-1){b=b.replace(goog.string.ltRe_,"&lt;")}if(b.indexOf(">")!=-1){b=b.replace(goog.string.gtRe_,"&gt;")}if(b.indexOf('"')!=-1){b=b.replace(goog.string.quotRe_,"&quot;")}return b}};goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(a){if(goog.string.contains(a,"&")){if("document" in goog.global){return goog.string.unescapeEntitiesUsingDom_(a)}else{return goog.string.unescapePureXmlEntities_(a)}}return a};goog.string.unescapeEntitiesUsingDom_=function(b){var a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};var c=document.createElement("div");return b.replace(goog.string.HTML_ENTITY_PATTERN_,function(e,d){var f=a[e];if(f){return f}if(d.charAt(0)=="#"){var g=Number("0"+d.substr(1));if(!isNaN(g)){f=String.fromCharCode(g)}}if(!f){c.innerHTML=e+" ";f=c.firstChild.nodeValue.slice(0,-1)}return a[e]=f})};goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(c,b){switch(b){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if(b.charAt(0)=="#"){var d=Number("0"+b.substr(1));if(!isNaN(d)){return String.fromCharCode(d)}}return c}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(b,a){return goog.string.newLineToBr(b.replace(/  /g," &#160;"),a)};goog.string.stripQuotes=function(e,a){var d=a.length;for(var c=0;c<d;c++){var b=d==1?a:a.charAt(c);if(e.charAt(0)==b&&e.charAt(e.length-1)==b){return e.substring(1,e.length-1)}}return e};goog.string.truncate=function(c,b,a){if(a){c=goog.string.unescapeEntities(c)}if(c.length>b){c=c.substring(0,b-3)+"..."}if(a){c=goog.string.htmlEscape(c)}return c};goog.string.truncateMiddle=function(h,f,e,a){if(e){h=goog.string.unescapeEntities(h)}if(a&&h.length>f){if(a>f){a=f}var c=h.length-a;var d=f-a;h=h.substring(0,d)+"..."+h.substring(c)}else{if(h.length>f){var g=Math.floor(f/2);var b=h.length-g;g+=f%2;h=h.substring(0,g)+"..."+h.substring(b)}}if(e){h=goog.string.htmlEscape(h)}return h};goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};goog.string.quote=function(c){c=String(c);if(c.quote){return c.quote()}else{var e=['"'];for(var a=0;a<c.length;a++){var b=c.charAt(a);var d=b.charCodeAt(0);e[a+1]=goog.string.specialEscapeChars_[b]||((d>31&&d<127)?b:goog.string.escapeChar(b))}e.push('"');return e.join("")}};goog.string.escapeString=function(b){var c=[];for(var a=0;a<b.length;a++){c[a]=goog.string.escapeChar(b.charAt(a))}return c.join("")};goog.string.escapeChar=function(d){if(d in goog.string.jsEscapeCache_){return goog.string.jsEscapeCache_[d]}if(d in goog.string.specialEscapeChars_){return goog.string.jsEscapeCache_[d]=goog.string.specialEscapeChars_[d]}var b=d;var a=d.charCodeAt(0);if(a>31&&a<127){b=d}else{if(a<256){b="\\x";if(a<16||a>256){b+="0"}}else{b="\\u";if(a<4096){b+="0"}}b+=a.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[d]=b};goog.string.toMap=function(b){var c={};for(var a=0;a<b.length;a++){c[b.charAt(a)]=true}return c};goog.string.contains=function(b,a){return b.indexOf(a)!=-1};goog.string.countOf=function(b,a){return b&&a?b.split(a).length-1:0};goog.string.removeAt=function(d,b,a){var c=d;if(b>=0&&b<d.length&&a>0){c=d.substr(0,b)+d.substr(b+a,d.length-b-a)}return c};goog.string.remove=function(c,a){var b=new RegExp(goog.string.regExpEscape(a),"");return c.replace(b,"")};goog.string.removeAll=function(c,a){var b=new RegExp(goog.string.regExpEscape(a),"g");return c.replace(b,"")};goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return new Array(b+1).join(a)};goog.string.padNumber=function(c,e,a){var d=goog.isDef(a)?c.toFixed(a):String(c);var b=d.indexOf(".");if(b==-1){b=d.length}return goog.string.repeat("0",Math.max(0,e-b))+d};goog.string.makeSafe=function(a){return a==null?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){var a=2147483648;return Math.floor(Math.random()*a).toString(36)+Math.abs(Math.floor(Math.random()*a)^goog.now()).toString(36)};goog.string.compareVersions=function(b,o){var c=0;var j=goog.string.trim(String(b)).split(".");var i=goog.string.trim(String(o)).split(".");var f=Math.max(j.length,i.length);for(var g=0;c==0&&g<f;g++){var a=j[g]||"";var n=i[g]||"";var k=new RegExp("(\\d*)(\\D*)","g");var e=new RegExp("(\\d*)(\\D*)","g");do{var m=k.exec(a)||["","",""];var l=e.exec(n)||["","",""];if(m[0].length==0&&l[0].length==0){break}var h=m[1].length==0?0:parseInt(m[1],10);var d=l[1].length==0?0:parseInt(l[1],10);c=goog.string.compareElements_(h,d)||goog.string.compareElements_(m[2].length==0,l[2].length==0)||goog.string.compareElements_(m[2],l[2])}while(c==0)}return c};goog.string.compareElements_=function(b,a){if(b<a){return -1}else{if(b>a){return 1}}return 0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(c){var a=0;for(var b=0;b<c.length;++b){a=31*a+c.charCodeAt(b);a%=goog.string.HASHCODE_MAX_}return a};goog.string.uniqueStringCounter_=Math.random()*2147483648|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};goog.string.toNumber=function(b){var a=Number(b);if(a==0&&goog.string.isEmpty(b)){return NaN}return a};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(c,b){return b.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(d,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";c=c?"|["+c+"]+":"";var a=new RegExp("(^"+c+")([a-z])","g");return d.replace(a,function(e,g,f){return g+f.toUpperCase()})};goog.string.parseInt=function(a){if(isFinite(a)){a=String(a)}if(goog.isString(a)){return/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10)}return NaN};goog.provide("goog.asserts");goog.provide("goog.asserts.AssertionError");goog.require("goog.debug.Error");goog.require("goog.string");goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(b,a){a.unshift(b);goog.debug.Error.call(this,goog.string.subs.apply(null,a));a.shift();this.messagePattern=b};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.doAssertFailure_=function(c,f,d,b){var e="Assertion failed";if(d){e+=": "+d;var a=b}else{if(c){e+=": "+c;a=f}}throw new goog.asserts.AssertionError(""+e,a||[])};goog.asserts.assert=function(c,b,a){if(goog.asserts.ENABLE_ASSERTS&&!c){goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2))}return c};goog.asserts.fail=function(b,a){if(goog.asserts.ENABLE_ASSERTS){throw new goog.asserts.AssertionError("Failure"+(b?": "+b:""),Array.prototype.slice.call(arguments,1))}};goog.asserts.assertNumber=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)){goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertString=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)){goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertFunction=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)){goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertObject=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)){goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertArray=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)){goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertBoolean=function(a,c,b){if(goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)){goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],c,Array.prototype.slice.call(arguments,2))}return(a)};goog.asserts.assertInstanceof=function(b,a,d,c){if(goog.asserts.ENABLE_ASSERTS&&!(b instanceof a)){goog.asserts.doAssertFailure_("instanceof check failed.",null,d,Array.prototype.slice.call(arguments,3))}};goog.provide("goog.array");goog.provide("goog.array.ArrayLike");goog.require("goog.asserts");goog.NATIVE_ARRAY_PROTOTYPES=true;goog.array.ArrayLike;goog.array.peek=function(a){return a[a.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.indexOf?function(a,c,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,c,b)}:function(a,e,b){var d=b==null?0:(b<0?Math.max(0,a.length+b):b);if(goog.isString(a)){if(!goog.isString(e)||e.length!=1){return -1}return a.indexOf(e,d)}for(var c=d;c<a.length;c++){if(c in a&&a[c]===e){return c}}return -1};goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(a,d,b){goog.asserts.assert(a.length!=null);var c=b==null?a.length-1:b;return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,d,c)}:function(a,e,b){var d=b==null?a.length-1:b;if(d<0){d=Math.max(0,a.length+d)}if(goog.isString(a)){if(!goog.isString(e)||e.length!=1){return -1}return a.lastIndexOf(e,d)}for(var c=d;c>=0;c--){if(c in a&&a[c]===e){return c}}return -1};goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.forEach?function(a,c,b){goog.asserts.assert(a.length!=null);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,c,b)}:function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=0;d<b;d++){if(d in c){g.call(e,c[d],d,a)}}};goog.array.forEachRight=function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=b-1;d>=0;--d){if(d in c){g.call(e,c[d],d,a)}}};goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.filter?function(a,c,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,c,b)}:function(e,g,a){var c=e.length;var h=[];var k=0;var j=goog.isString(e)?e.split(""):e;for(var d=0;d<c;d++){if(d in j){var b=j[d];if(g.call(a,b,d,e)){h[k++]=b}}}return h};goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.map?function(a,c,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.map.call(a,c,b)}:function(a,h,g){var b=a.length;var e=new Array(b);var c=goog.isString(a)?a.split(""):a;for(var d=0;d<b;d++){if(d in c){e[d]=h.call(g,c[d],d,a)}}return e};goog.array.reduce=function(a,c,e,b){if(a.reduce){if(b){return a.reduce(goog.bind(c,b),e)}else{return a.reduce(c,e)}}var d=e;goog.array.forEach(a,function(g,f){d=c.call(b,d,g,f,a)});return d};goog.array.reduceRight=function(a,c,e,b){if(a.reduceRight){if(b){return a.reduceRight(goog.bind(c,b),e)}else{return a.reduceRight(c,e)}}var d=e;goog.array.forEachRight(a,function(g,f){d=c.call(b,d,g,f,a)});return d};goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.some?function(a,c,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.some.call(a,c,b)}:function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=0;d<b;d++){if(d in c&&g.call(e,c[d],d,a)){return true}}return false};goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.every?function(a,c,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.every.call(a,c,b)}:function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=0;d<b;d++){if(d in c&&!g.call(e,c[d],d,a)){return false}}return true};goog.array.find=function(a,d,c){var b=goog.array.findIndex(a,d,c);return b<0?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=0;d<b;d++){if(d in c&&g.call(e,c[d],d,a)){return d}}return -1};goog.array.findRight=function(a,d,c){var b=goog.array.findIndexRight(a,d,c);return b<0?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndexRight=function(a,g,e){var b=a.length;var c=goog.isString(a)?a.split(""):a;for(var d=b-1;d>=0;d--){if(d in c&&g.call(e,c[d],d,a)){return d}}return -1};goog.array.contains=function(a,b){return goog.array.indexOf(a,b)>=0};goog.array.isEmpty=function(a){return a.length==0};goog.array.clear=function(a){if(!goog.isArray(a)){for(var b=a.length-1;b>=0;b--){delete a[b]}}a.length=0};goog.array.insert=function(a,b){if(!goog.array.contains(a,b)){a.push(b)}};goog.array.insertAt=function(a,c,b){goog.array.splice(a,b,0,c)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,d,b){var c;if(arguments.length==2||(c=goog.array.indexOf(a,b))<0){a.push(d)}else{goog.array.insertAt(a,d,c)}};goog.array.remove=function(a,c){var b=goog.array.indexOf(a,c);var d;if((d=b>=0)){goog.array.removeAt(a,b)}return d};goog.array.removeAt=function(a,b){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length==1};goog.array.removeIf=function(a,d,c){var b=goog.array.findIndex(a,d,c);if(b>=0){goog.array.removeAt(a,b);return true}return false};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var c=a.length;if(c>0){var d=new Array(c);for(var b=0;b<c;b++){d[b]=a[b]}return d}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(f,h){for(var g=1;g<arguments.length;g++){var c=arguments[g];var b;if(goog.isArray(c)||(b=goog.isArrayLike(c))&&c.hasOwnProperty("callee")){f.push.apply(f,c)}else{if(b){var e=f.length;var a=c.length;for(var d=0;d<a;d++){f[e+d]=c[d]}}else{f.push(c)}}}};goog.array.splice=function(a,b,c,d){goog.asserts.assert(a.length!=null);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};goog.array.slice=function(b,c,a){goog.asserts.assert(b.length!=null);if(arguments.length<=2){return goog.array.ARRAY_PROTOTYPE_.slice.call(b,c)}else{return goog.array.ARRAY_PROTOTYPE_.slice.call(b,c,a)}};goog.array.removeDuplicates=function(a,h){var f=h||a;var b={},g=0,d=0;while(d<a.length){var e=a[d++];var c=goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e;if(!Object.prototype.hasOwnProperty.call(b,c)){b[c]=true;f[g++]=e}}f.length=g};goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,false,b)};goog.array.binarySelect=function(a,c,b){return goog.array.binarySearch_(a,c,true,undefined,b)};goog.array.binarySearch_=function(f,b,d,e,j){var c=0;var g=f.length;var i;while(c<g){var h=(c+g)>>1;var a;if(d){a=b.call(j,f[h],h,f)}else{a=b(e,f[h])}if(a>0){c=h+1}else{g=h;i=!a}}return i?c:~c};goog.array.sort=function(a,b){goog.asserts.assert(a.length!=null);goog.array.ARRAY_PROTOTYPE_.sort.call(a,b||goog.array.defaultCompare)};goog.array.stableSort=function(a,e){for(var d=0;d<a.length;d++){a[d]={index:d,value:a[d]}}var c=e||goog.array.defaultCompare;function b(g,f){return c(g.value,f.value)||g.index-f.index}goog.array.sort(a,b);for(var d=0;d<a.length;d++){a[d]=a[d].value}};goog.array.sortObjectsByKey=function(a,b,d){var c=d||goog.array.defaultCompare;goog.array.sort(a,function(f,e){return c(f[b],e[b])})};goog.array.isSorted=function(a,f,e){var d=f||goog.array.defaultCompare;for(var c=1;c<a.length;c++){var b=d(a[c-1],a[c]);if(b>0||b==0&&e){return false}}return true};goog.array.equals=function(c,b,f){if(!goog.isArrayLike(c)||!goog.isArrayLike(b)||c.length!=b.length){return false}var a=c.length;var e=f||goog.array.defaultCompareEquality;for(var d=0;d<a;d++){if(!e(c[d],b[d])){return false}}return true};goog.array.compare=function(b,a,c){return goog.array.equals(b,a,c)};goog.array.compare3=function(d,c,g){var f=g||goog.array.defaultCompare;var b=Math.min(d.length,c.length);for(var e=0;e<b;e++){var a=f(d[e],c[e]);if(a!=0){return a}}return goog.array.defaultCompare(d.length,c.length)};goog.array.defaultCompare=function(d,c){return d>c?1:d<c?-1:0};goog.array.defaultCompareEquality=function(d,c){return d===c};goog.array.binaryInsert=function(d,b,c){var a=goog.array.binarySearch(d,b,c);if(a<0){goog.array.insertAt(d,b,-(a+1));return true}return false};goog.array.binaryRemove=function(d,b,c){var a=goog.array.binarySearch(d,b,c);return(a>=0)?goog.array.removeAt(d,a):false};goog.array.bucket=function(g,f){var c={};for(var b=0;b<g.length;b++){var d=g[b];var a=f(d,b,g);if(goog.isDef(a)){var e=c[a]||(c[a]=[]);e.push(d)}}return c};goog.array.repeat=function(b,d){var c=[];for(var a=0;a<d;a++){c[a]=b}return c};goog.array.flatten=function(d){var a=[];for(var c=0;c<arguments.length;c++){var b=arguments[c];if(goog.isArray(b)){a.push.apply(a,goog.array.flatten.apply(null,b))}else{a.push(b)}}return a};goog.array.rotate=function(b,a){goog.asserts.assert(b.length!=null);if(b.length){a%=b.length;if(a>0){goog.array.ARRAY_PROTOTYPE_.unshift.apply(b,b.splice(-a,a))}else{if(a<0){goog.array.ARRAY_PROTOTYPE_.push.apply(b,b.splice(0,-a))}}}return b};goog.array.zip=function(f){if(!arguments.length){return[]}var b=[];for(var d=0;true;d++){var e=[];for(var c=0;c<arguments.length;c++){var a=arguments[c];if(d>=a.length){return b}e.push(a[d])}b.push(e)}};goog.array.shuffle=function(b,f){var a=f||Math.random;for(var e=b.length-1;e>0;e--){var c=Math.floor(a()*(e+1));var d=b[e];b[e]=b[c];b[c]=d}};goog.provide("goog.dom.classes");goog.require("goog.array");goog.dom.classes.set=function(a,b){a.className=b};goog.dom.classes.get=function(a){var b=a.className;return goog.isString(b)&&b.match(/\S+/g)||[]};goog.dom.classes.add=function(d,e){var c=goog.dom.classes.get(d);var b=goog.array.slice(arguments,1);var a=c.length+b.length;goog.dom.classes.add_(c,b);d.className=c.join(" ");return c.length==a};goog.dom.classes.remove=function(c,d){var b=goog.dom.classes.get(c);var a=goog.array.slice(arguments,1);var e=goog.dom.classes.getDifference_(b,a);c.className=e.join(" ");return e.length==b.length-a.length};goog.dom.classes.add_=function(c,a){for(var b=0;b<a.length;b++){if(!goog.array.contains(c,a[b])){c.push(a[b])}}};goog.dom.classes.getDifference_=function(b,a){return goog.array.filter(b,function(c){return !goog.array.contains(a,c)})};goog.dom.classes.swap=function(d,f,a){var c=goog.dom.classes.get(d);var e=false;for(var b=0;b<c.length;b++){if(c[b]==f){goog.array.splice(c,b--,1);e=true}}if(e){c.push(a);d.className=c.join(" ")}return e};goog.dom.classes.addRemove=function(c,a,d){var b=goog.dom.classes.get(c);if(goog.isString(a)){goog.array.remove(b,a)}else{if(goog.isArray(a)){b=goog.dom.classes.getDifference_(b,a)}}if(goog.isString(d)&&!goog.array.contains(b,d)){b.push(d)}else{if(goog.isArray(d)){goog.dom.classes.add_(b,d)}}c.className=b.join(" ")};goog.dom.classes.has=function(a,b){return goog.array.contains(goog.dom.classes.get(a),b)};goog.dom.classes.enable=function(b,c,a){if(a){goog.dom.classes.add(b,c)}else{goog.dom.classes.remove(b,c)}};goog.dom.classes.toggle=function(a,b){var c=!goog.dom.classes.has(a,b);goog.dom.classes.enable(a,b,c);return c};goog.provide("goog.object");goog.object.forEach=function(d,c,b){for(var a in d){c.call(b,d[a],a,d)}};goog.object.filter=function(e,d,c){var b={};for(var a in e){if(d.call(c,e[a],a,e)){b[a]=e[a]}}return b};goog.object.map=function(e,d,c){var b={};for(var a in e){b[a]=d.call(c,e[a],a,e)}return b};goog.object.some=function(d,c,b){for(var a in d){if(c.call(b,d[a],a,d)){return true}}return false};goog.object.every=function(d,c,b){for(var a in d){if(!c.call(b,d[a],a,d)){return false}}return true};goog.object.getCount=function(b){var c=0;for(var a in b){c++}return c};goog.object.getAnyKey=function(b){for(var a in b){return a}};goog.object.getAnyValue=function(b){for(var a in b){return b[a]}};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(d){var c=[];var b=0;for(var a in d){c[b++]=d[a]}return c};goog.object.getKeys=function(d){var c=[];var b=0;for(var a in d){c[b++]=a}return c};goog.object.getValueByKeys=function(d,e){var a=goog.isArrayLike(e);var c=a?e:arguments;for(var b=a?0:1;b<c.length;b++){d=d[c[b]];if(!goog.isDef(d)){break}}return d};goog.object.containsKey=function(b,a){return a in b};goog.object.containsValue=function(b,c){for(var a in b){if(b[a]==c){return true}}return false};goog.object.findKey=function(d,c,b){for(var a in d){if(c.call(b,d[a],a,d)){return a}}return undefined};goog.object.findValue=function(d,c,b){var a=goog.object.findKey(d,c,b);return a&&d[a]};goog.object.isEmpty=function(b){for(var a in b){return false}return true};goog.object.clear=function(b){for(var a in b){delete b[a]}};goog.object.remove=function(b,a){var c;if((c=a in b)){delete b[a]}return c};goog.object.add=function(b,a,c){if(a in b){throw Error('The object already contains the key "'+a+'"')}goog.object.set(b,a,c)};goog.object.get=function(c,a,b){if(a in c){return c[a]}return b};goog.object.set=function(c,a,b){c[a]=b};goog.object.setIfUndefined=function(c,a,b){return a in c?c[a]:(c[a]=b)};goog.object.clone=function(c){var b={};for(var a in c){b[a]=c[a]}return b};goog.object.unsafeClone=function(c){var b=goog.typeOf(c);if(b=="object"||b=="array"){if(c.clone){return c.clone()}var d=b=="array"?[]:{};for(var a in c){d[a]=goog.object.unsafeClone(c[a])}return d}return c};goog.object.transpose=function(c){var b={};for(var a in c){b[c[a]]=a}return b};goog.object.PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.object.extend=function(e,f){var c,d;for(var b=1;b<arguments.length;b++){d=arguments[b];for(c in d){e[c]=d[c]}for(var a=0;a<goog.object.PROTOTYPE_FIELDS_.length;a++){c=goog.object.PROTOTYPE_FIELDS_[a];if(Object.prototype.hasOwnProperty.call(d,c)){e[c]=d[c]}}}};goog.object.create=function(b){var d=arguments.length;if(d==1&&goog.isArray(arguments[0])){return goog.object.create.apply(null,arguments[0])}if(d%2){throw Error("Uneven number of arguments")}var c={};for(var a=0;a<d;a+=2){c[arguments[a]]=arguments[a+1]}return c};goog.object.createSet=function(b){var d=arguments.length;if(d==1&&goog.isArray(arguments[0])){return goog.object.createSet.apply(null,arguments[0])}var c={};for(var a=0;a<d;a++){c[arguments[a]]=true}return c};goog.provide("goog.dom.TagName");goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",DD:"DD",DEL:"DEL",DFN:"DFN",DIR:"DIR",DIV:"DIV",DL:"DL",DT:"DT",EM:"EM",FIELDSET:"FIELDSET",FONT:"FONT",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MENU:"MENU",META:"META",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",P:"P",PARAM:"PARAM",PRE:"PRE",Q:"Q",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SELECT:"SELECT",SMALL:"SMALL",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUP:"SUP",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TITLE:"TITLE",TR:"TR",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO"};goog.provide("goog.userAgent");goog.require("goog.string");goog.userAgent.ASSUME_IE=false;goog.userAgent.ASSUME_GECKO=false;goog.userAgent.ASSUME_WEBKIT=false;goog.userAgent.ASSUME_MOBILE_WEBKIT=false;goog.userAgent.ASSUME_OPERA=false;goog.userAgent.ASSUME_ANY_VERSION=false;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.global.navigator?goog.global.navigator.userAgent:null};goog.userAgent.getNavigator=function(){return goog.global.navigator};goog.userAgent.init_=function(){goog.userAgent.detectedOpera_=false;goog.userAgent.detectedIe_=false;goog.userAgent.detectedWebkit_=false;goog.userAgent.detectedMobile_=false;goog.userAgent.detectedGecko_=false;var b;if(!goog.userAgent.BROWSER_KNOWN_&&(b=goog.userAgent.getUserAgentString())){var a=goog.userAgent.getNavigator();goog.userAgent.detectedOpera_=b.indexOf("Opera")==0;goog.userAgent.detectedIe_=!goog.userAgent.detectedOpera_&&b.indexOf("MSIE")!=-1;goog.userAgent.detectedWebkit_=!goog.userAgent.detectedOpera_&&b.indexOf("WebKit")!=-1;goog.userAgent.detectedMobile_=goog.userAgent.detectedWebkit_&&b.indexOf("Mobile")!=-1;goog.userAgent.detectedGecko_=!goog.userAgent.detectedOpera_&&!goog.userAgent.detectedWebkit_&&a.product=="Gecko"}};if(!goog.userAgent.BROWSER_KNOWN_){goog.userAgent.init_()}goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.userAgent.detectedOpera_;goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.userAgent.detectedIe_;goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.userAgent.detectedGecko_;goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.userAgent.detectedWebkit_;goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.detectedMobile_;goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=false;goog.userAgent.ASSUME_WINDOWS=false;goog.userAgent.ASSUME_LINUX=false;goog.userAgent.ASSUME_X11=false;goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11;goog.userAgent.initPlatform_=function(){goog.userAgent.detectedMac_=goog.string.contains(goog.userAgent.PLATFORM,"Mac");goog.userAgent.detectedWindows_=goog.string.contains(goog.userAgent.PLATFORM,"Win");goog.userAgent.detectedLinux_=goog.string.contains(goog.userAgent.PLATFORM,"Linux");goog.userAgent.detectedX11_=!!goog.userAgent.getNavigator()&&goog.string.contains(goog.userAgent.getNavigator()["appVersion"]||"","X11")};if(!goog.userAgent.PLATFORM_KNOWN_){goog.userAgent.initPlatform_()}goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.userAgent.detectedMac_;goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.userAgent.detectedWindows_;goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.detectedLinux_;goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.detectedX11_;goog.userAgent.determineVersion_=function(){var b="",e;if(goog.userAgent.OPERA&&goog.global.opera){var d=goog.global.opera.version;b=typeof d=="function"?d():d}else{if(goog.userAgent.GECKO){e=/rv\:([^\);]+)(\)|;)/}else{if(goog.userAgent.IE){e=/MSIE\s+([^\);]+)(\)|;)/}else{if(goog.userAgent.WEBKIT){e=/WebKit\/(\S+)/}}}if(e){var a=e.exec(goog.userAgent.getUserAgentString());b=a?a[1]:""}}if(goog.userAgent.IE){var c=goog.userAgent.getDocumentMode_();if(c>parseFloat(b)){return String(c)}}return b};goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:undefined};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(b,a){return goog.string.compareVersions(b,a)};goog.userAgent.isVersionCache_={};goog.userAgent.isVersion=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionCache_[a]||(goog.userAgent.isVersionCache_[a]=goog.string.compareVersions(goog.userAgent.VERSION,a)>=0)};goog.userAgent.isDocumentModeCache_={};goog.userAgent.isDocumentMode=function(a){return goog.userAgent.isDocumentModeCache_[a]||(goog.userAgent.isDocumentModeCache_[a]=goog.userAgent.IE&&!!document.documentMode&&document.documentMode>=a)};goog.provide("goog.math.Size");goog.math.Size=function(b,a){this.width=b;this.height=a};goog.math.Size.equals=function(d,c){if(d==c){return true}if(!d||!c){return false}return d.width==c.width&&d.height==c.height};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};if(goog.DEBUG){goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"}}goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return(this.width+this.height)*2};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return !this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Size.prototype.fitsInside=function(a){return this.width<=a.width&&this.height<=a.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(a){this.width*=a;this.height*=a;return this};goog.math.Size.prototype.scaleToFit=function(b){var a=this.aspectRatio()>b.aspectRatio()?b.width/this.width:b.height/this.height;return this.scale(a)};goog.provide("goog.dom.BrowserFeature");goog.require("goog.userAgent");goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentMode(9)||goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersion("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE};goog.provide("goog.math.Coordinate");goog.math.Coordinate=function(b,a){this.x=goog.isDef(b)?b:0;this.y=goog.isDef(a)?a:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};if(goog.DEBUG){goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}}goog.math.Coordinate.equals=function(d,c){if(d==c){return true}if(!d||!c){return false}return d.x==c.x&&d.y==c.y};goog.math.Coordinate.distance=function(e,c){var f=e.x-c.x;var d=e.y-c.y;return Math.sqrt(f*f+d*d)};goog.math.Coordinate.squaredDistance=function(e,c){var f=e.x-c.x;var d=e.y-c.y;return f*f+d*d};goog.math.Coordinate.difference=function(d,c){return new goog.math.Coordinate(d.x-c.x,d.y-c.y)};goog.math.Coordinate.sum=function(d,c){return new goog.math.Coordinate(d.x+c.x,d.y+c.y)};goog.provide("goog.dom");goog.provide("goog.dom.DomHelper");goog.provide("goog.dom.NodeType");goog.require("goog.array");goog.require("goog.dom.BrowserFeature");goog.require("goog.dom.TagName");goog.require("goog.dom.classes");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.userAgent");goog.dom.ASSUME_QUIRKS_MODE=false;goog.dom.ASSUME_STANDARDS_MODE=false;goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.dom.getDomHelper=function(a){return a?new goog.dom.DomHelper(goog.dom.getOwnerDocument(a)):(goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper()))};goog.dom.defaultDomHelper_;goog.dom.getDocument=function(){return document};goog.dom.getElement=function(a){return goog.isString(a)?document.getElementById(a):a};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagNameAndClass=function(c,a,b){return goog.dom.getElementsByTagNameAndClass_(document,c,a,b)};goog.dom.getElementsByClass=function(c,b){var a=b||document;if(goog.dom.canUseQuerySelector_(a)){return a.querySelectorAll("."+c)}else{if(a.getElementsByClassName){return a.getElementsByClassName(c)}}return goog.dom.getElementsByTagNameAndClass_(document,"*",c,b)};goog.dom.getElementByClass=function(c,b){var a=b||document;var d=null;if(goog.dom.canUseQuerySelector_(a)){d=a.querySelector("."+c)}else{d=goog.dom.getElementsByClass(c,b)[0]}return d||null};goog.dom.canUseQuerySelector_=function(a){return !!(a.querySelectorAll&&a.querySelector)};goog.dom.getElementsByTagNameAndClass_=function(k,j,c,m){var l=m||k;var b=(j&&j!="*")?j.toUpperCase():"";if(goog.dom.canUseQuerySelector_(l)&&(b||c)){var h=b+(c?"."+c:"");return l.querySelectorAll(h)}if(c&&l.getElementsByClassName){var d=l.getElementsByClassName(c);if(b){var n={};var f=0;for(var e=0,a;a=d[e];e++){if(b==a.nodeName){n[f++]=a}}n.length=f;return n}else{return d}}var d=l.getElementsByTagName(b||"*");if(c){var n={};var f=0;for(var e=0,a;a=d[e];e++){var g=a.className;if(typeof g.split=="function"&&goog.array.contains(g.split(/\s+/),c)){n[f++]=a}}n.length=f;return n}else{return d}};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(b,a){goog.object.forEach(a,function(d,c){if(c=="style"){b.style.cssText=d}else{if(c=="class"){b.className=d}else{if(c=="for"){b.htmlFor=d}else{if(c in goog.dom.DIRECT_ATTRIBUTE_MAP_){b.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[c],d)}else{if(goog.string.startsWith(c,"aria-")){b.setAttribute(c,d)}else{b[c]=d}}}}}})};goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};goog.dom.getViewportSize=function(a){return goog.dom.getViewportSize_(a||window)};goog.dom.getViewportSize_=function(c){var b=c.document;var a=goog.dom.isCss1CompatMode_(b)?b.documentElement:b.body;return new goog.math.Size(a.clientWidth,a.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeight_=function(f){var e=f.document;var b=0;if(e){var h=goog.dom.getViewportSize_(f).height;var a=e.body;var g=e.documentElement;if(goog.dom.isCss1CompatMode_(e)&&g.scrollHeight){b=g.scrollHeight!=h?g.scrollHeight:g.offsetHeight}else{var c=g.scrollHeight;var d=g.offsetHeight;if(g.clientHeight!=d){c=a.scrollHeight;d=a.offsetHeight}if(c>h){b=c>d?c:d}else{b=c<d?c:d}}}return b};goog.dom.getPageScroll=function(a){var b=a||goog.global||window;return goog.dom.getDomHelper(b.document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};goog.dom.getDocumentScroll_=function(c){var a=goog.dom.getDocumentScrollElement_(c);var b=goog.dom.getWindow_(c);return new goog.math.Coordinate(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};goog.dom.getDocumentScrollElement_=function(a){return !goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body};goog.dom.getWindow=function(a){return a?goog.dom.getWindow_(a):window};goog.dom.getWindow_=function(a){return a.parentWindow||a.defaultView};goog.dom.createDom=function(b,a,c){return goog.dom.createDom_(document,arguments)};goog.dom.createDom_=function(e,b){var d=b[0];var a=b[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&a&&(a.name||a.type)){var g=["<",d];if(a.name){g.push(' name="',goog.string.htmlEscape(a.name),'"')}if(a.type){g.push(' type="',goog.string.htmlEscape(a.type),'"');var f={};goog.object.extend(f,a);a=f;delete a.type}g.push(">");d=g.join("")}var c=e.createElement(d);if(a){if(goog.isString(a)){c.className=a}else{if(goog.isArray(a)){goog.dom.classes.add.apply(null,[c].concat(a))}else{goog.dom.setProperties(c,a)}}}if(b.length>2){goog.dom.append_(e,c,b,2)}return c};goog.dom.append_=function(f,e,b,g){function d(h){if(h){e.appendChild(goog.isString(h)?f.createTextNode(h):h)}}for(var c=g;c<b.length;c++){var a=b[c];if(goog.isArrayLike(a)&&!goog.dom.isNodeLike(a)){goog.array.forEach(goog.dom.isNodeList(a)?goog.array.toArray(a):a,d)}else{d(a)}}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(a){return document.createElement(a)};goog.dom.createTextNode=function(a){return document.createTextNode(a)};goog.dom.createTable=function(c,b,a){return goog.dom.createTable_(document,c,b,!!a)};goog.dom.createTable_=function(h,g,d,e){var c=["<tr>"];for(var b=0;b<d;b++){c.push(e?"<td>&nbsp;</td>":"<td></td>")}c.push("</tr>");c=c.join("");var a=["<table>"];for(b=0;b<g;b++){a.push(c)}a.push("</table>");var f=h.createElement(goog.dom.TagName.DIV);f.innerHTML=a.join("");return(f.removeChild(f.firstChild))};goog.dom.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(document,a)};goog.dom.htmlToDocumentFragment_=function(d,c){var b=d.createElement("div");if(goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT){b.innerHTML="<br>"+c;b.removeChild(b.firstChild)}else{b.innerHTML=c}if(b.childNodes.length==1){return(b.removeChild(b.firstChild))}else{var a=d.createDocumentFragment();while(b.firstChild){a.appendChild(b.firstChild)}return a}};goog.dom.getCompatMode=function(){return goog.dom.isCss1CompatMode()?"CSS1Compat":"BackCompat"};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(a){if(goog.dom.COMPAT_MODE_KNOWN_){return goog.dom.ASSUME_STANDARDS_MODE}return a.compatMode=="CSS1Compat"};goog.dom.canHaveChildren=function(a){if(a.nodeType!=goog.dom.NodeType.ELEMENT){return false}switch(a.tagName){case goog.dom.TagName.APPLET:case goog.dom.TagName.AREA:case goog.dom.TagName.BASE:case goog.dom.TagName.BR:case goog.dom.TagName.COL:case goog.dom.TagName.FRAME:case goog.dom.TagName.HR:case goog.dom.TagName.IMG:case goog.dom.TagName.INPUT:case goog.dom.TagName.IFRAME:case goog.dom.TagName.ISINDEX:case goog.dom.TagName.LINK:case goog.dom.TagName.NOFRAMES:case goog.dom.TagName.NOSCRIPT:case goog.dom.TagName.META:case goog.dom.TagName.OBJECT:case goog.dom.TagName.PARAM:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.STYLE:return false}return true};goog.dom.appendChild=function(a,b){a.appendChild(b)};goog.dom.append=function(a,b){goog.dom.append_(goog.dom.getOwnerDocument(a),a,arguments,1)};goog.dom.removeChildren=function(a){var b;while((b=a.firstChild)){a.removeChild(b)}};goog.dom.insertSiblingBefore=function(b,a){if(a.parentNode){a.parentNode.insertBefore(b,a)}};goog.dom.insertSiblingAfter=function(b,a){if(a.parentNode){a.parentNode.insertBefore(b,a.nextSibling)}};goog.dom.insertChildAt=function(b,c,a){b.insertBefore(c,b.childNodes[a]||null)};goog.dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};goog.dom.replaceNode=function(a,c){var b=c.parentNode;if(b){b.replaceChild(a,c)}};goog.dom.flattenElement=function(a){var c,b=a.parentNode;if(b&&b.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(a.removeNode){return(a.removeNode(false))}else{while((c=a.firstChild)){b.insertBefore(c,a)}return(goog.dom.removeNode(a))}}};goog.dom.getChildren=function(a){if(goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&a.children!=undefined){return a.children}return goog.array.filter(a.childNodes,function(b){return b.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(a){if(a.firstElementChild!=undefined){return(a).firstElementChild}return goog.dom.getNextElementNode_(a.firstChild,true)};goog.dom.getLastElementChild=function(a){if(a.lastElementChild!=undefined){return(a).lastElementChild}return goog.dom.getNextElementNode_(a.lastChild,false)};goog.dom.getNextElementSibling=function(a){if(a.nextElementSibling!=undefined){return(a).nextElementSibling}return goog.dom.getNextElementNode_(a.nextSibling,true)};goog.dom.getPreviousElementSibling=function(a){if(a.previousElementSibling!=undefined){return(a).previousElementSibling}return goog.dom.getNextElementNode_(a.previousSibling,false)};goog.dom.getNextElementNode_=function(b,a){while(b&&b.nodeType!=goog.dom.NodeType.ELEMENT){b=a?b.nextSibling:b.previousSibling}return(b)};goog.dom.getNextNode=function(a){if(!a){return null}if(a.firstChild){return a.firstChild}while(a&&!a.nextSibling){a=a.parentNode}return a?a.nextSibling:null};goog.dom.getPreviousNode=function(a){if(!a){return null}if(!a.previousSibling){return a.parentNode}a=a.previousSibling;while(a&&a.lastChild){a=a.lastChild}return a};goog.dom.isNodeLike=function(a){return goog.isObject(a)&&a.nodeType>0};goog.dom.isElement=function(a){return goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(a){return goog.isObject(a)&&a.window==a};goog.dom.getParentElement=function(a){if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){return a.parentElement}var b=a.parentNode;return goog.dom.isElement(b)?(b):null};goog.dom.contains=function(b,a){if(b.contains&&a.nodeType==goog.dom.NodeType.ELEMENT){return b==a||b.contains(a)}if(typeof b.compareDocumentPosition!="undefined"){return b==a||Boolean(b.compareDocumentPosition(a)&16)}while(a&&b!=a){a=a.parentNode}return a==b};goog.dom.compareNodeOrder=function(h,g){if(h==g){return 0}if(h.compareDocumentPosition){return h.compareDocumentPosition(g)&2?1:-1}if("sourceIndex" in h||(h.parentNode&&"sourceIndex" in h.parentNode)){var c=h.nodeType==goog.dom.NodeType.ELEMENT;var a=g.nodeType==goog.dom.NodeType.ELEMENT;if(c&&a){return h.sourceIndex-g.sourceIndex}else{var d=h.parentNode;var b=g.parentNode;if(d==b){return goog.dom.compareSiblingOrder_(h,g)}if(!c&&goog.dom.contains(d,g)){return -1*goog.dom.compareParentsDescendantNodeIe_(h,g)}if(!a&&goog.dom.contains(b,h)){return goog.dom.compareParentsDescendantNodeIe_(g,h)}return(c?h.sourceIndex:d.sourceIndex)-(a?g.sourceIndex:b.sourceIndex)}}var e=goog.dom.getOwnerDocument(h);var i,f;i=e.createRange();i.selectNode(h);i.collapse(true);f=e.createRange();f.selectNode(g);f.collapse(true);return i.compareBoundaryPoints(goog.global.Range.START_TO_END,f)};goog.dom.compareParentsDescendantNodeIe_=function(d,c){var b=d.parentNode;if(b==c){return -1}var a=c;while(a.parentNode!=b){a=a.parentNode}return goog.dom.compareSiblingOrder_(a,d)};goog.dom.compareSiblingOrder_=function(b,a){var c=a;while((c=c.previousSibling)){if(c==b){return -1}}return 1};goog.dom.findCommonAncestor=function(h){var e,g=arguments.length;if(!g){return null}else{if(g==1){return arguments[0]}}var k=[];var a=Infinity;for(e=0;e<g;e++){var l=[];var c=arguments[e];while(c){l.unshift(c);c=c.parentNode}k.push(l);a=Math.min(a,l.length)}var b=null;for(e=0;e<a;e++){var f=k[0][e];for(var d=1;d<g;d++){if(f!=k[d][e]){return b}}b=f}return b};goog.dom.getOwnerDocument=function(a){return(a.nodeType==goog.dom.NodeType.DOCUMENT?a:a.ownerDocument||a.document)};goog.dom.getFrameContentDocument=function(b){var a=b.contentDocument||b.contentWindow.document;return a};goog.dom.getFrameContentWindow=function(a){return a.contentWindow||goog.dom.getWindow_(goog.dom.getFrameContentDocument(a))};goog.dom.setTextContent=function(a,c){if("textContent" in a){a.textContent=c}else{if(a.firstChild&&a.firstChild.nodeType==goog.dom.NodeType.TEXT){while(a.lastChild!=a.firstChild){a.removeChild(a.lastChild)}a.firstChild.data=c}else{goog.dom.removeChildren(a);var b=goog.dom.getOwnerDocument(a);a.appendChild(b.createTextNode(c))}}};goog.dom.getOuterHtml=function(a){if("outerHTML" in a){return a.outerHTML}else{var b=goog.dom.getOwnerDocument(a);var c=b.createElement("div");c.appendChild(a.cloneNode(true));return c.innerHTML}};goog.dom.findNode=function(a,c){var d=[];var b=goog.dom.findNodes_(a,c,d,true);return b?d[0]:undefined};goog.dom.findNodes=function(a,b){var c=[];goog.dom.findNodes_(a,b,c,false);return c};goog.dom.findNodes_=function(a,c,e,b){if(a!=null){var d=a.firstChild;while(d){if(c(d)){e.push(d);if(b){return true}}if(goog.dom.findNodes_(d,c,e,b)){return true}d=d.nextSibling}}return false};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(b){var c=b.getAttributeNode("tabindex");if(c&&c.specified){var a=b.tabIndex;return goog.isNumber(a)&&a>=0&&a<32768}return false};goog.dom.setFocusableTabIndex=function(b,a){if(a){b.tabIndex=0}else{b.tabIndex=-1;b.removeAttribute("tabIndex")}};goog.dom.getTextContent=function(c){var b;if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&("innerText" in c)){b=goog.string.canonicalizeNewlines(c.innerText)}else{var a=[];goog.dom.getTextContent_(c,a,true);b=a.join("")}b=b.replace(/ \xAD /g," ").replace(/\xAD/g,"");b=b.replace(/\u200B/g,"");if(!goog.dom.BrowserFeature.CAN_USE_INNER_TEXT){b=b.replace(/ +/g," ")}if(b!=" "){b=b.replace(/^\s*/,"")}return b};goog.dom.getRawTextContent=function(b){var a=[];goog.dom.getTextContent_(b,a,false);return a.join("")};goog.dom.getTextContent_=function(c,b,a){if(c.nodeName in goog.dom.TAGS_TO_IGNORE_){}else{if(c.nodeType==goog.dom.NodeType.TEXT){if(a){b.push(String(c.nodeValue).replace(/(\r\n|\r|\n)/g,""))}else{b.push(c.nodeValue)}}else{if(c.nodeName in goog.dom.PREDEFINED_TAG_VALUES_){b.push(goog.dom.PREDEFINED_TAG_VALUES_[c.nodeName])}else{var d=c.firstChild;while(d){goog.dom.getTextContent_(d,b,a);d=d.nextSibling}}}}};goog.dom.getNodeTextLength=function(a){return goog.dom.getTextContent(a).length};goog.dom.getNodeTextOffset=function(d,b){var a=b||goog.dom.getOwnerDocument(d).body;var c=[];while(d&&d!=a){var e=d;while((e=e.previousSibling)){c.unshift(goog.dom.getTextContent(e))}d=d.parentNode}return goog.string.trimLeft(c.join("")).replace(/ +/g," ").length};goog.dom.getNodeAtOffset=function(c,g,d){var a=[c],h=0,f;while(a.length>0&&h<g){f=a.pop();if(f.nodeName in goog.dom.TAGS_TO_IGNORE_){}else{if(f.nodeType==goog.dom.NodeType.TEXT){var e=f.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");h+=e.length}else{if(f.nodeName in goog.dom.PREDEFINED_TAG_VALUES_){h+=goog.dom.PREDEFINED_TAG_VALUES_[f.nodeName].length}else{for(var b=f.childNodes.length-1;b>=0;b--){a.push(f.childNodes[b])}}}}}if(goog.isObject(d)){d.remainder=f?f.nodeValue.length+g-h-1:0;d.node=f}return f};goog.dom.isNodeList=function(a){if(a&&typeof a.length=="number"){if(goog.isObject(a)){return typeof a.item=="function"||typeof a.item=="string"}else{if(goog.isFunction(a)){return typeof a.item=="function"}}}return false};goog.dom.getAncestorByTagNameAndClass=function(c,d,a){if(!d&&!a){return null}var b=d?d.toUpperCase():null;return(goog.dom.getAncestor(c,function(e){return(!b||e.nodeName==b)&&(!a||goog.dom.classes.has(e,a))},true))};goog.dom.getAncestorByClass=function(a,b){return goog.dom.getAncestorByTagNameAndClass(a,null,b)};goog.dom.getAncestor=function(c,e,a,d){if(!a){c=c.parentNode}var f=d==null;var b=0;while(c&&(f||b<=d)){if(e(c)){return c}c=c.parentNode;b++}return null};goog.dom.getActiveElement=function(b){try{return b&&b.activeElement}catch(a){}return null};goog.dom.DomHelper=function(a){this.document_=a||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(a){this.document_=a};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(a){if(goog.isString(a)){return this.document_.getElementById(a)}else{return a}};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(c,a,b){return goog.dom.getElementsByTagNameAndClass_(this.document_,c,a,b)};goog.dom.DomHelper.prototype.getElementsByClass=function(b,a){var c=a||this.document_;return goog.dom.getElementsByClass(b,c)};goog.dom.DomHelper.prototype.getElementByClass=function(b,a){var c=a||this.document_;return goog.dom.getElementByClass(b,c)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(a){return goog.dom.getViewportSize(a||this.getWindow())};goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.Appendable;goog.dom.DomHelper.prototype.createDom=function(b,a,c){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(a){return this.document_.createElement(a)};goog.dom.DomHelper.prototype.createTextNode=function(a){return this.document_.createTextNode(a)};goog.dom.DomHelper.prototype.createTable=function(c,b,a){return goog.dom.createTable_(this.document_,c,b,!!a)};goog.dom.DomHelper.prototype.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(this.document_,a)};goog.dom.DomHelper.prototype.getCompatMode=function(){return this.isCss1CompatMode()?"CSS1Compat":"BackCompat"};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.provide("goog.math.Box");goog.require("goog.math.Coordinate");goog.math.Box=function(d,b,a,c){this.top=d;this.right=b;this.bottom=a;this.left=c};goog.math.Box.boundingBox=function(c){var b=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x);for(var a=1;a<arguments.length;a++){var d=arguments[a];b.top=Math.min(b.top,d.y);b.right=Math.max(b.right,d.x);b.bottom=Math.max(b.bottom,d.y);b.left=Math.min(b.left,d.x)}return b};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};if(goog.DEBUG){goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"}}goog.math.Box.prototype.contains=function(a){return goog.math.Box.contains(this,a)};goog.math.Box.prototype.expand=function(b,d,c,a){if(goog.isObject(b)){this.top-=b.top;this.right+=b.right;this.bottom+=b.bottom;this.left-=b.left}else{this.top-=b;this.right+=d;this.bottom+=c;this.left-=a}return this};goog.math.Box.prototype.expandToInclude=function(a){this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.right=Math.max(this.right,a.right);this.bottom=Math.max(this.bottom,a.bottom)};goog.math.Box.equals=function(d,c){if(d==c){return true}if(!d||!c){return false}return d.top==c.top&&d.right==c.right&&d.bottom==c.bottom&&d.left==c.left};goog.math.Box.contains=function(b,a){if(!b||!a){return false}if(a instanceof goog.math.Box){return a.left>=b.left&&a.right<=b.right&&a.top>=b.top&&a.bottom<=b.bottom}return a.x>=b.left&&a.x<=b.right&&a.y>=b.top&&a.y<=b.bottom};goog.math.Box.relativePositionX=function(a,b){if(b.x<a.left){return b.x-a.left}else{if(b.x>a.right){return b.x-a.right}}return 0};goog.math.Box.relativePositionY=function(a,b){if(b.y<a.top){return b.y-a.top}else{if(b.y>a.bottom){return b.y-a.bottom}}return 0};goog.math.Box.distance=function(b,d){var a=goog.math.Box.relativePositionX(b,d);var c=goog.math.Box.relativePositionY(b,d);return Math.sqrt(a*a+c*c)};goog.math.Box.intersects=function(d,c){return(d.left<=c.right&&c.left<=d.right&&d.top<=c.bottom&&c.top<=d.bottom)};goog.math.Box.intersectsWithPadding=function(d,c,e){return(d.left<=c.right+e&&c.left<=d.right+e&&d.top<=c.bottom+e&&c.top<=d.bottom+e)};goog.provide("goog.math.Rect");goog.require("goog.math.Box");goog.require("goog.math.Size");goog.math.Rect=function(a,d,b,c){this.left=a;this.top=d;this.width=b;this.height=c};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){var b=this.left+this.width;var a=this.top+this.height;return new goog.math.Box(this.top,b,a,this.left)};goog.math.Rect.createFromBox=function(a){return new goog.math.Rect(a.left,a.top,a.right-a.left,a.bottom-a.top)};if(goog.DEBUG){goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"}}goog.math.Rect.equals=function(d,c){if(d==c){return true}if(!d||!c){return false}return d.left==c.left&&d.width==c.width&&d.top==c.top&&d.height==c.height};goog.math.Rect.prototype.intersection=function(e){var b=Math.max(this.left,e.left);var a=Math.min(this.left+this.width,e.left+e.width);if(b<=a){var d=Math.max(this.top,e.top);var c=Math.min(this.top+this.height,e.top+e.height);if(d<=c){this.left=b;this.top=d;this.width=a-b;this.height=c-d;return true}}return false};goog.math.Rect.intersection=function(d,c){var f=Math.max(d.left,c.left);var e=Math.min(d.left+d.width,c.left+c.width);if(f<=e){var h=Math.max(d.top,c.top);var g=Math.min(d.top+d.height,c.top+c.height);if(h<=g){return new goog.math.Rect(f,h,e-f,g-h)}}return null};goog.math.Rect.intersects=function(d,c){return(d.left<=c.left+c.width&&c.left<=d.left+d.width&&d.top<=c.top+c.height&&c.top<=d.top+d.height)};goog.math.Rect.prototype.intersects=function(a){return goog.math.Rect.intersects(this,a)};goog.math.Rect.difference=function(h,g){var c=goog.math.Rect.intersection(h,g);if(!c||!c.height||!c.width){return[h.clone()]}var l=[];var f=h.top;var i=h.height;var d=h.left+h.width;var k=h.top+h.height;var j=g.left+g.width;var e=g.top+g.height;if(g.top>h.top){l.push(new goog.math.Rect(h.left,h.top,h.width,g.top-h.top));f=g.top;i-=g.top-h.top}if(e<k){l.push(new goog.math.Rect(h.left,e,h.width,k-e));i=e-f}if(g.left>h.left){l.push(new goog.math.Rect(h.left,f,g.left-h.left,i))}if(j<d){l.push(new goog.math.Rect(j,f,d-j,i))}return l};goog.math.Rect.prototype.difference=function(a){return goog.math.Rect.difference(this,a)};goog.math.Rect.prototype.boundingRect=function(c){var b=Math.max(this.left+this.width,c.left+c.width);var a=Math.max(this.top+this.height,c.top+c.height);this.left=Math.min(this.left,c.left);this.top=Math.min(this.top,c.top);this.width=b-this.left;this.height=a-this.top};goog.math.Rect.boundingRect=function(d,c){if(!d||!c){return null}var e=d.clone();e.boundingRect(c);return e};goog.math.Rect.prototype.contains=function(a){if(a instanceof goog.math.Rect){return this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height}else{return a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height}};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.provide("goog.style");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");goog.require("goog.userAgent");goog.style.setStyle=function(b,c,a){if(goog.isString(c)){goog.style.setStyle_(b,a,c)}else{goog.object.forEach(c,goog.partial(goog.style.setStyle_,b))}};goog.style.setStyle_=function(a,c,b){a.style[goog.string.toCamelCase(b)]=c};goog.style.getStyle=function(a,b){return a.style[goog.string.toCamelCase(b)]||""};goog.style.getComputedStyle=function(a,c){var d=goog.dom.getOwnerDocument(a);if(d.defaultView&&d.defaultView.getComputedStyle){var b=d.defaultView.getComputedStyle(a,null);if(b){return b[c]||b.getPropertyValue(c)||""}}return""};goog.style.getCascadedStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:null};goog.style.getStyle_=function(a,b){return goog.style.getComputedStyle(a,b)||goog.style.getCascadedStyle(a,b)||(a.style&&a.style[b])};goog.style.getComputedPosition=function(a){return goog.style.getStyle_(a,"position")};goog.style.getBackgroundColor=function(a){return goog.style.getStyle_(a,"backgroundColor")};goog.style.getComputedOverflowX=function(a){return goog.style.getStyle_(a,"overflowX")};goog.style.getComputedOverflowY=function(a){return goog.style.getStyle_(a,"overflowY")};goog.style.getComputedZIndex=function(a){return goog.style.getStyle_(a,"zIndex")};goog.style.getComputedTextAlign=function(a){return goog.style.getStyle_(a,"textAlign")};goog.style.getComputedCursor=function(a){return goog.style.getStyle_(a,"cursor")};goog.style.setPosition=function(d,c,e){var a,f;var b=goog.userAgent.GECKO&&(goog.userAgent.MAC||goog.userAgent.X11)&&goog.userAgent.isVersion("1.9");if(c instanceof goog.math.Coordinate){a=c.x;f=c.y}else{a=c;f=e}d.style.left=goog.style.getPixelStyleValue_((a),b);d.style.top=goog.style.getPixelStyleValue_((f),b)};goog.style.getPosition=function(a){return new goog.math.Coordinate(a.offsetLeft,a.offsetTop)};goog.style.getClientViewportElement=function(b){var a;if(b){a=goog.dom.getOwnerDocument(b)}else{a=goog.dom.getDocument()}if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)&&!goog.dom.getDomHelper(a).isCss1CompatMode()){return a.body}return a.documentElement};goog.style.getViewportPageOffset=function(d){var a=d.body;var b=d.documentElement;var e=a.scrollLeft||b.scrollLeft;var c=a.scrollTop||b.scrollTop;return new goog.math.Coordinate(e,c)};goog.style.getBoundingClientRect_=function(a){var b=a.getBoundingClientRect();if(goog.userAgent.IE){var c=a.ownerDocument;b.left-=c.documentElement.clientLeft+c.body.clientLeft;b.top-=c.documentElement.clientTop+c.body.clientTop}return(b)};goog.style.getOffsetParent=function(b){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(8)){return b.offsetParent}var e=goog.dom.getOwnerDocument(b);var d=goog.style.getStyle_(b,"position");var a=d=="fixed"||d=="absolute";for(var c=b.parentNode;c&&c!=e;c=c.parentNode){d=goog.style.getStyle_((c),"position");a=a&&d=="static"&&c!=e.documentElement&&c!=e.body;if(!a&&(c.scrollWidth>c.clientWidth||c.scrollHeight>c.clientHeight||d=="fixed"||d=="absolute"||d=="relative")){return(c)}}return null};goog.style.getVisibleRectForElement=function(d){var k=new goog.math.Box(0,Infinity,Infinity,0);var c=goog.dom.getDomHelper(d);var f=c.getDocument().body;var i=c.getDocument().documentElement;var l=c.getDocumentScrollElement();for(var a=d;a=goog.style.getOffsetParent(a);){if((!goog.userAgent.IE||a.clientWidth!=0)&&(!goog.userAgent.WEBKIT||a.clientHeight!=0||a!=f)&&(a!=f&&a!=i&&goog.style.getStyle_(a,"overflow")!="visible")){var g=goog.style.getPageOffset(a);var b=goog.style.getClientLeftTop(a);g.x+=b.x;g.y+=b.y;k.top=Math.max(k.top,g.y);k.right=Math.min(k.right,g.x+a.clientWidth);k.bottom=Math.min(k.bottom,g.y+a.clientHeight);k.left=Math.max(k.left,g.x)}}var j=l.scrollLeft,h=l.scrollTop;k.left=Math.max(k.left,j);k.top=Math.max(k.top,h);var e=c.getViewportSize();k.right=Math.min(k.right,j+e.width);k.bottom=Math.min(k.bottom,h+e.height);return k.top>=0&&k.left>=0&&k.bottom>k.top&&k.right>k.left?k:null};goog.style.getContainerOffsetToScrollInto=function(g,a,k){var d=goog.style.getPageOffset(g);var f=goog.style.getPageOffset(a);var c=goog.style.getBorderBox(a);var l=d.x-f.x-c.left;var j=d.y-f.y-c.top;var i=a.clientWidth-g.offsetWidth;var h=a.clientHeight-g.offsetHeight;var e=a.scrollLeft;var b=a.scrollTop;if(k){e+=l-i/2;b+=j-h/2}else{e+=Math.min(l,Math.max(l-i,0));b+=Math.min(j,Math.max(j-h,0))}return new goog.math.Coordinate(e,b)};goog.style.scrollIntoContainerView=function(b,a,c){var d=goog.style.getContainerOffsetToScrollInto(b,a,c);a.scrollLeft=d.x;a.scrollTop=d.y};goog.style.getClientLeftTop=function(a){if(goog.userAgent.GECKO&&!goog.userAgent.isVersion("1.9")){var c=parseFloat(goog.style.getComputedStyle(a,"borderLeftWidth"));if(goog.style.isRightToLeft(a)){var b=a.offsetWidth-a.clientWidth-c-parseFloat(goog.style.getComputedStyle(a,"borderRightWidth"));c+=b}return new goog.math.Coordinate(c,parseFloat(goog.style.getComputedStyle(a,"borderTopWidth")))}return new goog.math.Coordinate(a.clientLeft,a.clientTop)};goog.style.getPageOffset=function(c){var e,i=goog.dom.getOwnerDocument(c);var b=goog.style.getStyle_(c,"position");var d=goog.userAgent.GECKO&&i.getBoxObjectFor&&!c.getBoundingClientRect&&b=="absolute"&&(e=i.getBoxObjectFor(c))&&(e.screenX<0||e.screenY<0);var g=new goog.math.Coordinate(0,0);var f=goog.style.getClientViewportElement(i);if(c==f){return g}if(c.getBoundingClientRect){e=goog.style.getBoundingClientRect_(c);var j=goog.dom.getDomHelper(i).getDocumentScroll();g.x=e.left+j.x;g.y=e.top+j.y}else{if(i.getBoxObjectFor&&!d){e=i.getBoxObjectFor(c);var a=i.getBoxObjectFor(f);g.x=e.screenX-a.screenX;g.y=e.screenY-a.screenY}else{var h=c;do{g.x+=h.offsetLeft;g.y+=h.offsetTop;if(h!=c){g.x+=h.clientLeft||0;g.y+=h.clientTop||0}if(goog.userAgent.WEBKIT&&goog.style.getComputedPosition(h)=="fixed"){g.x+=i.body.scrollLeft;g.y+=i.body.scrollTop;break}h=h.offsetParent}while(h&&h!=c);if(goog.userAgent.OPERA||(goog.userAgent.WEBKIT&&b=="absolute")){g.y-=i.body.offsetTop}for(h=c;(h=goog.style.getOffsetParent(h))&&h!=i.body&&h!=f;){g.x-=h.scrollLeft;if(!goog.userAgent.OPERA||h.tagName!="TR"){g.y-=h.scrollTop}}}}return g};goog.style.getPageOffsetLeft=function(a){return goog.style.getPageOffset(a).x};goog.style.getPageOffsetTop=function(a){return goog.style.getPageOffset(a).y};goog.style.getFramedPageOffset=function(c,e){var a=new goog.math.Coordinate(0,0);var b=goog.dom.getWindow(goog.dom.getOwnerDocument(c));var d=c;do{var f=b==e?goog.style.getPageOffset(d):goog.style.getClientPosition(d);a.x+=f.x;a.y+=f.y}while(b&&b!=e&&(d=b.frameElement)&&(b=b.parent));return a};goog.style.translateRectForAnotherFrame=function(c,d,b){if(d.getDocument()!=b.getDocument()){var a=d.getDocument().body;var e=goog.style.getFramedPageOffset(a,b.getWindow());e=goog.math.Coordinate.difference(e,goog.style.getPageOffset(a));if(goog.userAgent.IE&&!d.isCss1CompatMode()){e=goog.math.Coordinate.difference(e,d.getDocumentScroll())}c.left+=e.x;c.top+=e.y}};goog.style.getRelativePosition=function(d,c){var e=goog.style.getClientPosition(d);var f=goog.style.getClientPosition(c);return new goog.math.Coordinate(e.x-f.x,e.y-f.y)};goog.style.getClientPosition=function(c){var g=new goog.math.Coordinate;if(c.nodeType==goog.dom.NodeType.ELEMENT){if(c.getBoundingClientRect){var d=goog.style.getBoundingClientRect_((c));g.x=d.left;g.y=d.top}else{var f=goog.dom.getDomHelper((c)).getDocumentScroll();var e=goog.style.getPageOffset((c));g.x=e.x-f.x;g.y=e.y-f.y}}else{var a=goog.isFunction(c.getBrowserEvent);var b=c;if(c.targetTouches){b=c.targetTouches[0]}else{if(a&&c.getBrowserEvent().targetTouches){b=c.getBrowserEvent().targetTouches[0]}}g.x=b.clientX;g.y=b.clientY}return g};goog.style.setPageOffset=function(e,b,a){var f=goog.style.getPageOffset(e);if(b instanceof goog.math.Coordinate){a=b.y;b=b.x}var d=b-f.x;var c=a-f.y;goog.style.setPosition(e,e.offsetLeft+d,e.offsetTop+c)};goog.style.setSize=function(b,a,d){var c;if(a instanceof goog.math.Size){c=a.height;a=a.width}else{if(d==undefined){throw Error("missing height argument")}c=d}goog.style.setWidth(b,(a));goog.style.setHeight(b,(c))};goog.style.getPixelStyleValue_=function(b,a){if(typeof b=="number"){b=(a?Math.round(b):b)+"px"}return b};goog.style.setHeight=function(b,a){b.style.height=goog.style.getPixelStyleValue_(a,true)};goog.style.setWidth=function(a,b){a.style.width=goog.style.getPixelStyleValue_(b,true)};goog.style.getSize=function(c){if(goog.style.getStyle_(c,"display")!="none"){return goog.style.getSizeWithDisplay_(c)}var e=c.style;var b=e.display;var f=e.visibility;var d=e.position;e.visibility="hidden";e.position="absolute";e.display="inline";var a=goog.style.getSizeWithDisplay_(c);e.display=b;e.position=d;e.visibility=f;return a};goog.style.getSizeWithDisplay_=function(b){var d=b.offsetWidth;var a=b.offsetHeight;var c=goog.userAgent.WEBKIT&&!d&&!a;if((!goog.isDef(d)||c)&&b.getBoundingClientRect){var e=goog.style.getBoundingClientRect_(b);return new goog.math.Size(e.right-e.left,e.bottom-e.top)}return new goog.math.Size(d,a)};goog.style.getBounds=function(a){var c=goog.style.getPageOffset(a);var b=goog.style.getSize(a);return new goog.math.Rect(c.x,c.y,b.width,b.height)};goog.style.toCamelCase=function(a){return goog.string.toCamelCase(String(a))};goog.style.toSelectorCase=function(a){return goog.string.toSelectorCase(a)};goog.style.getOpacity=function(d){var c=d.style;var a="";if("opacity" in c){a=c.opacity}else{if("MozOpacity" in c){a=c.MozOpacity}else{if("filter" in c){var b=c.filter.match(/alpha\(opacity=([\d.]+)\)/);if(b){a=String(b[1]/100)}}}}return a==""?a:Number(a)};goog.style.setOpacity=function(b,c){var a=b.style;if("opacity" in a){a.opacity=c}else{if("MozOpacity" in a){a.MozOpacity=c}else{if("filter" in a){if(c===""){a.filter=""}else{a.filter="alpha(opacity="+c*100+")"}}}}};goog.style.setTransparentBackgroundImage=function(b,c){var a=b.style;if(goog.userAgent.IE&&!goog.userAgent.isVersion("8")){a.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+c+'", sizingMethod="crop")'}else{a.backgroundImage="url("+c+")";a.backgroundPosition="top left";a.backgroundRepeat="no-repeat"}};goog.style.clearTransparentBackgroundImage=function(b){var a=b.style;if("filter" in a){a.filter=""}else{a.backgroundImage="none"}};goog.style.showElement=function(a,b){a.style.display=b?"":"none"};goog.style.isElementShown=function(a){return a.style.display!="none"};goog.style.installStyles=function(d,f){var c=goog.dom.getDomHelper(f);var e=null;if(goog.userAgent.IE){e=c.getDocument().createStyleSheet();goog.style.setStyles(e,d)}else{var b=c.getElementsByTagNameAndClass("head")[0];if(!b){var a=c.getElementsByTagNameAndClass("body")[0];b=c.createDom("head");a.parentNode.insertBefore(b,a)}e=c.createDom("style");goog.style.setStyles(e,d);c.appendChild(b,e)}return e};goog.style.uninstallStyles=function(b){var a=b.ownerNode||b.owningElement||(b);goog.dom.removeNode(a)};goog.style.setStyles=function(a,b){if(goog.userAgent.IE){a.cssText=b}else{var c=goog.userAgent.WEBKIT?"innerText":"innerHTML";a[c]=b}};goog.style.setPreWrap=function(b){var a=b.style;if(goog.userAgent.IE&&!goog.userAgent.isVersion("8")){a.whiteSpace="pre";a.wordWrap="break-word"}else{if(goog.userAgent.GECKO){a.whiteSpace="-moz-pre-wrap"}else{a.whiteSpace="pre-wrap"}}};goog.style.setInlineBlock=function(b){var a=b.style;a.position="relative";if(goog.userAgent.IE&&!goog.userAgent.isVersion("8")){a.zoom="1";a.display="inline"}else{if(goog.userAgent.GECKO){a.display=goog.userAgent.isVersion("1.9a")?"inline-block":"-moz-inline-box"}else{a.display="inline-block"}}};goog.style.isRightToLeft=function(a){return"rtl"==goog.style.getStyle_(a,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT?"WebkitUserSelect":null;goog.style.isUnselectable=function(a){if(goog.style.unselectableStyle_){return a.style[goog.style.unselectableStyle_].toLowerCase()=="none"}else{if(goog.userAgent.IE||goog.userAgent.OPERA){return a.getAttribute("unselectable")=="on"}}return false};goog.style.setUnselectable=function(e,c,g){var h=!g?e.getElementsByTagName("*"):null;var a=goog.style.unselectableStyle_;if(a){var f=c?"none":"";e.style[a]=f;if(h){for(var b=0,d;d=h[b];b++){d.style[a]=f}}}else{if(goog.userAgent.IE||goog.userAgent.OPERA){var f=c?"on":"";e.setAttribute("unselectable",f);if(h){for(var b=0,d;d=h[b];b++){d.setAttribute("unselectable",f)}}}}};goog.style.getBorderBoxSize=function(a){return new goog.math.Size(a.offsetWidth,a.offsetHeight)};goog.style.setBorderBoxSize=function(c,b){var f=goog.dom.getOwnerDocument(c);var g=goog.dom.getDomHelper(f).isCss1CompatMode();if(goog.userAgent.IE&&(!g||!goog.userAgent.isVersion("8"))){var d=c.style;if(g){var a=goog.style.getPaddingBox(c);var e=goog.style.getBorderBox(c);d.pixelWidth=b.width-e.left-a.left-a.right-e.right;d.pixelHeight=b.height-e.top-a.top-a.bottom-e.bottom}else{d.pixelWidth=b.width;d.pixelHeight=b.height}}else{goog.style.setBoxSizingSize_(c,b,"border-box")}};goog.style.getContentBoxSize=function(c){var g=goog.dom.getOwnerDocument(c);var e=goog.userAgent.IE&&c.currentStyle;if(e&&goog.dom.getDomHelper(g).isCss1CompatMode()&&e.width!="auto"&&e.height!="auto"&&!e.boxSizing){var d=goog.style.getIePixelValue_(c,e.width,"width","pixelWidth");var a=goog.style.getIePixelValue_(c,e.height,"height","pixelHeight");return new goog.math.Size(d,a)}else{var h=goog.style.getBorderBoxSize(c);var b=goog.style.getPaddingBox(c);var f=goog.style.getBorderBox(c);return new goog.math.Size(h.width-f.left-b.left-b.right-f.right,h.height-f.top-b.top-b.bottom-f.bottom)}};goog.style.setContentBoxSize=function(c,b){var f=goog.dom.getOwnerDocument(c);var g=goog.dom.getDomHelper(f).isCss1CompatMode();if(goog.userAgent.IE&&(!g||!goog.userAgent.isVersion("8"))){var d=c.style;if(g){d.pixelWidth=b.width;d.pixelHeight=b.height}else{var a=goog.style.getPaddingBox(c);var e=goog.style.getBorderBox(c);d.pixelWidth=b.width+e.left+a.left+a.right+e.right;d.pixelHeight=b.height+e.top+a.top+a.bottom+e.bottom}}else{goog.style.setBoxSizingSize_(c,b,"content-box")}};goog.style.setBoxSizingSize_=function(b,a,d){var c=b.style;if(goog.userAgent.GECKO){c.MozBoxSizing=d}else{if(goog.userAgent.WEBKIT){c.WebkitBoxSizing=d}else{c.boxSizing=d}}c.width=Math.max(a.width,0)+"px";c.height=Math.max(a.height,0)+"px"};goog.style.getIePixelValue_=function(e,f,d,b){if(/^\d+px?$/.test(f)){return parseInt(f,10)}else{var c=e.style[d];var g=e.runtimeStyle[d];e.runtimeStyle[d]=e.currentStyle[d];e.style[d]=f;var a=e.style[b];e.style[d]=c;e.runtimeStyle[d]=g;return a}};goog.style.getIePixelDistance_=function(a,b){return goog.style.getIePixelValue_(a,goog.style.getCascadedStyle(a,b),"left","pixelLeft")};goog.style.getBox_=function(c,d){if(goog.userAgent.IE){var f=goog.style.getIePixelDistance_(c,d+"Left");var b=goog.style.getIePixelDistance_(c,d+"Right");var e=goog.style.getIePixelDistance_(c,d+"Top");var a=goog.style.getIePixelDistance_(c,d+"Bottom");return new goog.math.Box(e,b,a,f)}else{var f=(goog.style.getComputedStyle(c,d+"Left"));var b=(goog.style.getComputedStyle(c,d+"Right"));var e=(goog.style.getComputedStyle(c,d+"Top"));var a=(goog.style.getComputedStyle(c,d+"Bottom"));return new goog.math.Box(parseFloat(e),parseFloat(b),parseFloat(a),parseFloat(f))}};goog.style.getPaddingBox=function(a){return goog.style.getBox_(a,"padding")};goog.style.getMarginBox=function(a){return goog.style.getBox_(a,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};goog.style.getIePixelBorder_=function(a,c){if(goog.style.getCascadedStyle(a,c+"Style")=="none"){return 0}var b=goog.style.getCascadedStyle(a,c+"Width");if(b in goog.style.ieBorderWidthKeywords_){return goog.style.ieBorderWidthKeywords_[b]}return goog.style.getIePixelValue_(a,b,"left","pixelLeft")};goog.style.getBorderBox=function(c){if(goog.userAgent.IE){var e=goog.style.getIePixelBorder_(c,"borderLeft");var b=goog.style.getIePixelBorder_(c,"borderRight");var d=goog.style.getIePixelBorder_(c,"borderTop");var a=goog.style.getIePixelBorder_(c,"borderBottom");return new goog.math.Box(d,b,a,e)}else{var e=(goog.style.getComputedStyle(c,"borderLeftWidth"));var b=(goog.style.getComputedStyle(c,"borderRightWidth"));var d=(goog.style.getComputedStyle(c,"borderTopWidth"));var a=(goog.style.getComputedStyle(c,"borderBottomWidth"));return new goog.math.Box(parseFloat(d),parseFloat(b),parseFloat(a),parseFloat(e))}};goog.style.getFontFamily=function(d){var g=goog.dom.getOwnerDocument(d);var c="";if(g.body.createTextRange){var b=g.body.createTextRange();b.moveToElementText(d);try{c=b.queryCommandValue("FontName")}catch(f){c=""}}if(!c){c=goog.style.getStyle_(d,"fontFamily")}var a=c.split(",");if(a.length>1){c=a[0]}return goog.string.stripQuotes(c,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;goog.style.getLengthUnits=function(b){var a=b.match(goog.style.lengthUnitRegex_);return a&&a[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,"in":1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};goog.style.getFontSize=function(c){var e=goog.style.getStyle_(c,"fontSize");var b=goog.style.getLengthUnits(e);if(e&&"px"==b){return parseInt(e,10)}if(goog.userAgent.IE){if(b in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_){return goog.style.getIePixelValue_(c,e,"left","pixelLeft")}else{if(c.parentNode&&c.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&b in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){var a=(c.parentNode);var f=goog.style.getStyle_(a,"fontSize");return goog.style.getIePixelValue_(a,e==f?"1em":e,"left","pixelLeft")}}}var d=goog.dom.createDom("span",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(c,d);e=d.offsetHeight;goog.dom.removeNode(d);return e};goog.style.parseStyleAttribute=function(b){var a={};goog.array.forEach(b.split(/\s*;\s*/),function(d){var c=d.split(/\s*:\s*/);if(c.length==2){a[goog.string.toCamelCase(c[0].toLowerCase())]=c[1]}});return a};goog.style.toStyleAttribute=function(b){var a=[];goog.object.forEach(b,function(d,c){a.push(goog.string.toSelectorCase(c),":",d,";")});return a.join("")};goog.style.setFloat=function(a,b){a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=b};goog.style.getFloat=function(a){return a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};goog.style.getScrollbarWidth=function(c){var d=goog.dom.createElement("div");if(c){d.className=c}d.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";var b=goog.dom.createElement("div");goog.style.setSize(b,"200px","200px");d.appendChild(b);goog.dom.appendChild(goog.dom.getDocument().body,d);var a=d.offsetWidth-d.clientWidth;goog.dom.removeNode(d);return a};goog.provide("goog.events.EventType");goog.require("goog.userAgent");goog.events.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",CONTEXTMENU:"contextmenu",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",TRANSITIONEND:goog.userAgent.WEBKIT?"webkitTransitionEnd":(goog.userAgent.OPERA?"oTransitionEnd":"transitionend")};goog.provide("goog.editor.defines");goog.editor.defines.USE_CONTENTEDITABLE_IN_FIREFOX_3=true;goog.provide("goog.userAgent.product");goog.require("goog.userAgent");goog.userAgent.product.ASSUME_FIREFOX=false;goog.userAgent.product.ASSUME_CAMINO=false;goog.userAgent.product.ASSUME_IPHONE=false;goog.userAgent.product.ASSUME_IPAD=false;goog.userAgent.product.ASSUME_ANDROID=false;goog.userAgent.product.ASSUME_CHROME=false;goog.userAgent.product.ASSUME_SAFARI=false;goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_CAMINO||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI;goog.userAgent.product.init_=function(){goog.userAgent.product.detectedFirefox_=false;goog.userAgent.product.detectedCamino_=false;goog.userAgent.product.detectedIphone_=false;goog.userAgent.product.detectedIpad_=false;goog.userAgent.product.detectedAndroid_=false;goog.userAgent.product.detectedChrome_=false;goog.userAgent.product.detectedSafari_=false;var a=goog.userAgent.getUserAgentString();if(!a){return}if(a.indexOf("Firefox")!=-1){goog.userAgent.product.detectedFirefox_=true}else{if(a.indexOf("Camino")!=-1){goog.userAgent.product.detectedCamino_=true}else{if(a.indexOf("iPhone")!=-1||a.indexOf("iPod")!=-1){goog.userAgent.product.detectedIphone_=true}else{if(a.indexOf("iPad")!=-1){goog.userAgent.product.detectedIpad_=true}else{if(a.indexOf("Android")!=-1){goog.userAgent.product.detectedAndroid_=true}else{if(a.indexOf("Chrome")!=-1){goog.userAgent.product.detectedChrome_=true}else{if(a.indexOf("Safari")!=-1){goog.userAgent.product.detectedSafari_=true}}}}}}}};if(!goog.userAgent.product.PRODUCT_KNOWN_){goog.userAgent.product.init_()}goog.userAgent.product.OPERA=goog.userAgent.OPERA;goog.userAgent.product.IE=goog.userAgent.IE;goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.userAgent.product.detectedFirefox_;goog.userAgent.product.CAMINO=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CAMINO:goog.userAgent.product.detectedCamino_;goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.detectedIphone_;goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.userAgent.product.detectedIpad_;goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.userAgent.product.detectedAndroid_;goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.userAgent.product.detectedChrome_;goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.detectedSafari_;goog.provide("goog.userAgent.product.isVersion");goog.require("goog.userAgent.product");goog.userAgent.product.determineVersion_=function(){if(goog.userAgent.product.FIREFOX){return goog.userAgent.product.getFirstRegExpGroup_(/Firefox\/([0-9.]+)/)}if(goog.userAgent.product.IE||goog.userAgent.product.OPERA){return goog.userAgent.VERSION}if(goog.userAgent.product.CHROME){return goog.userAgent.product.getFirstRegExpGroup_(/Chrome\/([0-9.]+)/)}if(goog.userAgent.product.SAFARI){return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/)}if(goog.userAgent.product.IPHONE||goog.userAgent.product.IPAD){var a=goog.userAgent.product.execRegExp_(/Version\/(\S+).*Mobile\/(\S+)/);if(a){return a[1]+"."+a[2]}}else{if(goog.userAgent.product.ANDROID){var b=goog.userAgent.product.getFirstRegExpGroup_(/Android\s+([0-9.]+)/);if(b){return b}return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/)}else{if(goog.userAgent.product.CAMINO){return goog.userAgent.product.getFirstRegExpGroup_(/Camino\/([0-9.]+)/)}}}return""};goog.userAgent.product.getFirstRegExpGroup_=function(b){var a=goog.userAgent.product.execRegExp_(b);return a?a[1]:""};goog.userAgent.product.execRegExp_=function(a){return a.exec(goog.userAgent.getUserAgentString())};goog.userAgent.product.VERSION=goog.userAgent.product.determineVersion_();goog.userAgent.product.isVersion=function(a){return goog.string.compareVersions(goog.userAgent.product.VERSION,a)>=0};goog.provide("goog.editor.BrowserFeature");goog.require("goog.editor.defines");goog.require("goog.userAgent");goog.require("goog.userAgent.product");goog.require("goog.userAgent.product.isVersion");goog.editor.BrowserFeature={HAS_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9),HAS_W3C_RANGES:goog.userAgent.GECKO||goog.userAgent.WEBKIT||goog.userAgent.OPERA||(goog.userAgent.IE&&goog.userAgent.isDocumentMode(9)),HAS_CONTENT_EDITABLE:goog.userAgent.IE||goog.userAgent.WEBKIT||goog.userAgent.OPERA||(goog.editor.defines.USE_CONTENTEDITABLE_IN_FIREFOX_3&&goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9")),USE_MUTATION_EVENTS:goog.userAgent.GECKO,HAS_DOM_SUBTREE_MODIFIED_EVENT:goog.userAgent.WEBKIT||(goog.editor.defines.USE_CONTENTEDITABLE_IN_FIREFOX_3&&goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9")),HAS_DOCUMENT_INDEPENDENT_NODES:goog.userAgent.GECKO,PUTS_CURSOR_BEFORE_FIRST_BLOCK_ELEMENT_ON_FOCUS:goog.userAgent.GECKO,CLEARS_SELECTION_WHEN_FOCUS_LEAVES:goog.userAgent.IE||goog.userAgent.WEBKIT||goog.userAgent.OPERA,HAS_UNSELECTABLE_STYLE:goog.userAgent.GECKO||goog.userAgent.WEBKIT,FORMAT_BLOCK_WORKS_FOR_BLOCKQUOTES:goog.userAgent.GECKO||goog.userAgent.WEBKIT||goog.userAgent.OPERA,CREATES_MULTIPLE_BLOCKQUOTES:(goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("534.16"))||goog.userAgent.OPERA,WRAPS_BLOCKQUOTE_IN_DIVS:goog.userAgent.OPERA,PREFERS_READY_STATE_CHANGE_EVENT:goog.userAgent.IE,TAB_FIRES_KEYPRESS:!goog.userAgent.IE,NEEDS_99_WIDTH_IN_STANDARDS_MODE:goog.userAgent.IE,USE_DOCUMENT_FOR_KEY_EVENTS:goog.userAgent.GECKO&&!goog.editor.defines.USE_CONTENTEDITABLE_IN_FIREFOX_3,SHOWS_CUSTOM_ATTRS_IN_INNER_HTML:goog.userAgent.IE,COLLAPSES_EMPTY_NODES:goog.userAgent.GECKO||goog.userAgent.WEBKIT||goog.userAgent.OPERA,CONVERT_TO_B_AND_I_TAGS:goog.userAgent.GECKO||goog.userAgent.OPERA,TABS_THROUGH_IMAGES:goog.userAgent.IE,UNESCAPES_URLS_WITHOUT_ASKING:goog.userAgent.IE&&!goog.userAgent.isVersion("7.0"),HAS_STYLE_WITH_CSS:goog.userAgent.GECKO&&goog.userAgent.isVersion("1.8")||goog.userAgent.WEBKIT||goog.userAgent.OPERA,FOLLOWS_EDITABLE_LINKS:goog.userAgent.WEBKIT,HAS_ACTIVE_ELEMENT:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9"),HAS_SET_CAPTURE:goog.userAgent.IE,EATS_EMPTY_BACKGROUND_COLOR:goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("527"),SUPPORTS_FOCUSIN:goog.userAgent.IE||goog.userAgent.OPERA,SELECTS_IMAGES_ON_CLICK:goog.userAgent.IE||goog.userAgent.OPERA,MOVES_STYLE_TO_HEAD:goog.userAgent.WEBKIT,COLLAPSES_SELECTION_ONMOUSEDOWN:false,CARET_INSIDE_SELECTION:goog.userAgent.OPERA,FOCUSES_EDITABLE_BODY_ON_HTML_CLICK:true,USES_KEYDOWN:goog.userAgent.IE||goog.userAgent.WEBKIT&&goog.userAgent.isVersion("525"),ADDS_NBSPS_IN_REMOVE_FORMAT:goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("531"),GETS_STUCK_IN_LINKS:goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("528"),NORMALIZE_CORRUPTS_EMPTY_TEXT_NODES:goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9")||goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT&&goog.userAgent.isVersion("531"),NORMALIZE_CORRUPTS_ALL_TEXT_NODES:goog.userAgent.IE,NESTS_SUBSCRIPT_SUPERSCRIPT:goog.userAgent.IE||goog.userAgent.GECKO||goog.userAgent.OPERA,CAN_SELECT_EMPTY_ELEMENT:!goog.userAgent.IE&&!goog.userAgent.WEBKIT,FORGETS_FORMATTING_WHEN_LISTIFYING:goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("526"),LEAVES_P_WHEN_REMOVING_LISTS:goog.userAgent.IE||goog.userAgent.OPERA,CAN_LISTIFY_BR:!goog.userAgent.IE&&!goog.userAgent.OPERA,DOESNT_OVERRIDE_FONT_SIZE_IN_STYLE_ATTR:!goog.userAgent.WEBKIT,SUPPORTS_HTML5_FILE_DRAGGING:(goog.userAgent.product.CHROME&&goog.userAgent.product.isVersion("4"))||(goog.userAgent.product.SAFARI&&goog.userAgent.isVersion("533"))||(goog.userAgent.GECKO&&goog.userAgent.isVersion("2.0")),SUPPORTS_OPERA_DEFAULTBLOCK_COMMAND:goog.userAgent.OPERA&&goog.userAgent.isVersion("11.10"),SUPPORTS_FILE_PASTING:goog.userAgent.product.CHROME&&goog.userAgent.product.isVersion("12")};goog.provide("goog.editor.style");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.editor.BrowserFeature");goog.require("goog.events.EventType");goog.require("goog.object");goog.require("goog.style");goog.require("goog.userAgent");goog.editor.style.getComputedOrCascadedStyle_=function(b,a){if(b.nodeType!=goog.dom.NodeType.ELEMENT){return null}return goog.userAgent.IE?goog.style.getCascadedStyle((b),a):goog.style.getComputedStyle((b),a)};goog.editor.style.isDisplayBlock=function(a){return goog.editor.style.getComputedOrCascadedStyle_(a,"display")=="block"};goog.editor.style.isContainer=function(a){var b=a&&a.nodeName.toLowerCase();return !!(a&&(goog.editor.style.isDisplayBlock(a)||b=="td"||b=="table"||b=="li"))};goog.editor.style.getContainer=function(a){return(goog.dom.getAncestor(a,goog.editor.style.isContainer,true))};goog.editor.style.SELECTABLE_INPUT_TYPES_=goog.object.createSet("text","file","url");goog.editor.style.cancelMouseDownHelper_=function(b){var a=b.target.tagName;if(a!=goog.dom.TagName.TEXTAREA&&a!=goog.dom.TagName.INPUT){b.preventDefault()}};goog.editor.style.makeUnselectable=function(f,e){if(goog.editor.BrowserFeature.HAS_UNSELECTABLE_STYLE){e.listen(f,goog.events.EventType.MOUSEDOWN,goog.editor.style.cancelMouseDownHelper_,true)}goog.style.setUnselectable(f,true);var b=f.getElementsByTagName(goog.dom.TagName.INPUT);for(var d=0,a=b.length;d<a;d++){var c=b[d];if(c.type in goog.editor.style.SELECTABLE_INPUT_TYPES_){goog.editor.style.makeSelectable(c)}}goog.array.forEach(f.getElementsByTagName(goog.dom.TagName.TEXTAREA),goog.editor.style.makeSelectable)};goog.editor.style.makeSelectable=function(c){goog.style.setUnselectable(c,false);if(goog.editor.BrowserFeature.HAS_UNSELECTABLE_STYLE){var f=c;var e=(c.parentNode);while(e&&e.tagName!=goog.dom.TagName.HTML){if(goog.style.isUnselectable(e)){goog.style.setUnselectable(e,false,true);for(var b=0,a=e.childNodes.length;b<a;b++){var d=e.childNodes[b];if(d!=f&&d.nodeType==goog.dom.NodeType.ELEMENT){goog.style.setUnselectable(e.childNodes[b],true)}}}f=e;e=(e.parentNode)}}};goog.provide("goog.iter");goog.provide("goog.iter.Iterator");goog.provide("goog.iter.StopIteration");goog.require("goog.array");goog.require("goog.asserts");goog.iter.Iterable;if("StopIteration" in goog.global){goog.iter.StopIteration=goog.global.StopIteration}else{goog.iter.StopIteration=Error("StopIteration")}goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration};goog.iter.Iterator.prototype.__iterator__=function(a){return this};goog.iter.toIterator=function(b){if(b instanceof goog.iter.Iterator){return b}if(typeof b.__iterator__=="function"){return b.__iterator__(false)}if(goog.isArrayLike(b)){var a=0;var c=new goog.iter.Iterator;c.next=function(){while(true){if(a>=b.length){throw goog.iter.StopIteration}if(!(a in b)){a++;continue}return b[a++]}};return c}throw Error("Not implemented")};goog.iter.forEach=function(d,c,b){if(goog.isArrayLike(d)){try{goog.array.forEach((d),c,b)}catch(a){if(a!==goog.iter.StopIteration){throw a}}}else{d=goog.iter.toIterator(d);try{while(true){c.call(b,d.next(),undefined,d)}}catch(a){if(a!==goog.iter.StopIteration){throw a}}}};goog.iter.filter=function(c,b,a){c=goog.iter.toIterator(c);var d=new goog.iter.Iterator;d.next=function(){while(true){var e=c.next();if(b.call(a,e,undefined,c)){return e}}};return d};goog.iter.range=function(c,d,g){var f=0;var a=c;var b=g||1;if(arguments.length>1){f=c;a=d}if(b==0){throw Error("Range step argument must not be zero")}var e=new goog.iter.Iterator;e.next=function(){if(b>0&&f>=a||b<0&&f<=a){throw goog.iter.StopIteration}var h=f;f+=b;return h};return e};goog.iter.join=function(b,a){return goog.iter.toArray(b).join(a)};goog.iter.map=function(c,b,a){c=goog.iter.toIterator(c);var d=new goog.iter.Iterator;d.next=function(){while(true){var e=c.next();return b.call(a,e,undefined,c)}};return d};goog.iter.reduce=function(c,b,e,a){var d=e;goog.iter.forEach(c,function(f){d=b.call(a,d,f)});return d};goog.iter.some=function(d,c,b){d=goog.iter.toIterator(d);try{while(true){if(c.call(b,d.next(),undefined,d)){return true}}}catch(a){if(a!==goog.iter.StopIteration){throw a}}return false};goog.iter.every=function(d,c,b){d=goog.iter.toIterator(d);try{while(true){if(!c.call(b,d.next(),undefined,d)){return false}}}catch(a){if(a!==goog.iter.StopIteration){throw a}}return true};goog.iter.chain=function(d){var a=arguments;var c=a.length;var b=0;var e=new goog.iter.Iterator;e.next=function(){try{if(b>=c){throw goog.iter.StopIteration}var g=goog.iter.toIterator(a[b]);return g.next()}catch(f){if(f!==goog.iter.StopIteration||b>=c){throw f}else{b++;return this.next()}}};return e};goog.iter.dropWhile=function(c,b,a){c=goog.iter.toIterator(c);var e=new goog.iter.Iterator;var d=true;e.next=function(){while(true){var f=c.next();if(d&&b.call(a,f,undefined,c)){continue}else{d=false}return f}};return e};goog.iter.takeWhile=function(c,b,a){c=goog.iter.toIterator(c);var e=new goog.iter.Iterator;var d=true;e.next=function(){while(true){if(d){var f=c.next();if(b.call(a,f,undefined,c)){return f}else{d=false}}else{throw goog.iter.StopIteration}}};return e};goog.iter.toArray=function(a){if(goog.isArrayLike(a)){return goog.array.toArray((a))}a=goog.iter.toIterator(a);var b=[];goog.iter.forEach(a,function(c){b.push(c)});return b};goog.iter.equals=function(b,a){b=goog.iter.toIterator(b);a=goog.iter.toIterator(a);var d,c;try{while(true){d=c=false;var h=b.next();d=true;var g=a.next();c=true;if(h!=g){return false}}}catch(e){if(e!==goog.iter.StopIteration){throw e}else{if(d&&!c){return false}if(!c){try{g=a.next();return false}catch(f){if(f!==goog.iter.StopIteration){throw f}return true}}}}return false};goog.iter.nextOrValue=function(b,a){try{return goog.iter.toIterator(b).next()}catch(c){if(c!=goog.iter.StopIteration){throw c}return a}};goog.iter.product=function(e){var b=goog.array.some(arguments,function(f){return !f.length});if(b||!arguments.length){return new goog.iter.Iterator()}var a=new goog.iter.Iterator();var c=arguments;var d=goog.array.repeat(0,c.length);a.next=function(){if(d){var g=goog.array.map(d,function(i,h){return c[h][i]});for(var f=d.length-1;f>=0;f--){goog.asserts.assert(d);if(d[f]<c[f].length-1){d[f]++;break}if(f==0){d=null;break}d[f]=0}return g}throw goog.iter.StopIteration};return a};goog.iter.cycle=function(e){var f=goog.iter.toIterator(e);var c=[];var d=0;var a=new goog.iter.Iterator();var b=false;a.next=function(){var g=null;if(!b){try{g=f.next();c.push(g);return g}catch(h){if(h!=goog.iter.StopIteration||goog.array.isEmpty(c)){throw h}b=true}}g=c[d];d=(d+1)%c.length;return g};return a};goog.provide("goog.dom.iter.AncestorIterator");goog.provide("goog.dom.iter.ChildIterator");goog.provide("goog.dom.iter.SiblingIterator");goog.require("goog.iter.Iterator");goog.require("goog.iter.StopIteration");goog.dom.iter.SiblingIterator=function(b,a,c){this.node_=b;this.reverse_=!!c;if(b&&!a){this.next()}};goog.inherits(goog.dom.iter.SiblingIterator,goog.iter.Iterator);goog.dom.iter.SiblingIterator.prototype.next=function(){var a=this.node_;if(!a){throw goog.iter.StopIteration}this.node_=this.reverse_?a.previousSibling:a.nextSibling;return a};goog.dom.iter.ChildIterator=function(a,b,c){if(!goog.isDef(c)){c=b&&a.childNodes.length?a.childNodes.length-1:0}goog.dom.iter.SiblingIterator.call(this,a.childNodes[c],true,b)};goog.inherits(goog.dom.iter.ChildIterator,goog.dom.iter.SiblingIterator);goog.dom.iter.AncestorIterator=function(b,a){this.node_=b;if(b&&!a){this.next()}};goog.inherits(goog.dom.iter.AncestorIterator,goog.iter.Iterator);goog.dom.iter.AncestorIterator.prototype.next=function(){var a=this.node_;if(!a){throw goog.iter.StopIteration}this.node_=a.parentNode;return a};goog.provide("goog.editor.node");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.iter.ChildIterator");goog.require("goog.dom.iter.SiblingIterator");goog.require("goog.iter");goog.require("goog.object");goog.require("goog.string");goog.require("goog.string.Unicode");goog.editor.node.BLOCK_TAG_NAMES_=goog.object.createSet("ADDRESS","BLOCKQUOTE","BODY","CAPTION","CENTER","COL","COLGROUP","DIR","DIV","DL","DD","DT","FIELDSET","FORM","H1","H2","H3","H4","H5","H6","HR","ISINDEX","OL","LI","MAP","MENU","OPTGROUP","OPTION","P","PRE","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","TL","UL");goog.editor.node.NON_EMPTY_TAGS_=goog.object.createSet(goog.dom.TagName.IMG,goog.dom.TagName.IFRAME,"EMBED");goog.editor.node.isStandardsMode=function(a){return goog.dom.getDomHelper(a).isCss1CompatMode()};goog.editor.node.getRightMostLeaf=function(b){var a;while(a=goog.editor.node.getLastChild(b)){b=a}return b};goog.editor.node.getLeftMostLeaf=function(b){var a;while(a=goog.editor.node.getFirstChild(b)){b=a}return b};goog.editor.node.getFirstChild=function(a){return goog.editor.node.getChildHelper_(a,false)};goog.editor.node.getLastChild=function(a){return goog.editor.node.getChildHelper_(a,true)};goog.editor.node.getPreviousSibling=function(a){return(goog.editor.node.getFirstValue_(goog.iter.filter(new goog.dom.iter.SiblingIterator(a,false,true),goog.editor.node.isImportant)))};goog.editor.node.getNextSibling=function(a){return(goog.editor.node.getFirstValue_(goog.iter.filter(new goog.dom.iter.SiblingIterator(a),goog.editor.node.isImportant)))};goog.editor.node.getChildHelper_=function(a,b){return(!a||a.nodeType!=goog.dom.NodeType.ELEMENT)?null:(goog.editor.node.getFirstValue_(goog.iter.filter(new goog.dom.iter.ChildIterator((a),b),goog.editor.node.isImportant)))};goog.editor.node.getFirstValue_=function(a){try{return a.next()}catch(b){return null}};goog.editor.node.isImportant=function(a){return a.nodeType==goog.dom.NodeType.ELEMENT||a.nodeType==goog.dom.NodeType.TEXT&&!goog.editor.node.isAllNonNbspWhiteSpace(a)};goog.editor.node.isAllNonNbspWhiteSpace=function(a){return goog.string.isBreakingWhitespace(a.nodeValue)};goog.editor.node.isEmpty=function(c,d){var b=goog.dom.getRawTextContent(c);if(c.getElementsByTagName){for(var a in goog.editor.node.NON_EMPTY_TAGS_){if(c.tagName==a||c.getElementsByTagName(a).length>0){return false}}}return(!d&&b==goog.string.Unicode.NBSP)||goog.string.isBreakingWhitespace(b)};goog.editor.node.getLength=function(a){return a.length||a.childNodes.length};goog.editor.node.findInChildren=function(d,b){for(var c=0,a=d.childNodes.length;c<a;c++){if(b(d.childNodes[c])){return c}}return null};goog.editor.node.findHighestMatchingAncestor=function(d,a){var c=d.parentNode;var b=null;while(c&&a(c)){b=c;c=c.parentNode}return b};goog.editor.node.isBlockTag=function(a){return !!goog.editor.node.BLOCK_TAG_NAMES_[a.tagName]};goog.editor.node.skipEmptyTextNodes=function(a){while(a&&a.nodeType==goog.dom.NodeType.TEXT&&!a.nodeValue){a=a.nextSibling}return a};goog.editor.node.isEditableContainer=function(a){return a.getAttribute&&a.getAttribute("g_editable")=="true"};goog.editor.node.isEditable=function(a){return !!goog.dom.getAncestor(a,goog.editor.node.isEditableContainer)};goog.editor.node.findTopMostEditableAncestor=function(a,c){var b=null;while(a&&!goog.editor.node.isEditableContainer(a)){if(c(a)){b=a}a=a.parentNode}return b};goog.editor.node.splitDomTreeAt=function(a,d,c){var b;while(a!=c&&(b=a.parentNode)){d=goog.editor.node.getSecondHalfOfNode_(b,a,d);a=b}return(d)};goog.editor.node.getSecondHalfOfNode_=function(c,a,d){var b=(c.cloneNode(false));while(a.nextSibling){goog.dom.appendChild(b,a.nextSibling)}if(d){b.insertBefore(d,b.firstChild)}return b};goog.editor.node.transferChildren=function(a,b){goog.dom.append(a,b.childNodes)};goog.provide("goog.dom.RangeEndpoint");goog.dom.RangeEndpoint={START:1,END:0};goog.provide("goog.structs.Collection");goog.structs.Collection=function(){};goog.structs.Collection.prototype.add;goog.structs.Collection.prototype.remove;goog.structs.Collection.prototype.contains;goog.structs.Collection.prototype.getCount;goog.provide("goog.structs");goog.require("goog.array");goog.require("goog.object");goog.structs.getCount=function(a){if(typeof a.getCount=="function"){return a.getCount()}if(goog.isArrayLike(a)||goog.isString(a)){return a.length}return goog.object.getCount(a)};goog.structs.getValues=function(b){if(typeof b.getValues=="function"){return b.getValues()}if(goog.isString(b)){return b.split("")}if(goog.isArrayLike(b)){var d=[];var a=b.length;for(var c=0;c<a;c++){d.push(b[c])}return d}return goog.object.getValues(b)};goog.structs.getKeys=function(b){if(typeof b.getKeys=="function"){return b.getKeys()}if(typeof b.getValues=="function"){return undefined}if(goog.isArrayLike(b)||goog.isString(b)){var d=[];var a=b.length;for(var c=0;c<a;c++){d.push(c)}return d}return goog.object.getKeys(b)};goog.structs.contains=function(a,b){if(typeof a.contains=="function"){return a.contains(b)}if(typeof a.containsValue=="function"){return a.containsValue(b)}if(goog.isArrayLike(a)||goog.isString(a)){return goog.array.contains((a),b)}return goog.object.containsValue(a,b)};goog.structs.isEmpty=function(a){if(typeof a.isEmpty=="function"){return a.isEmpty()}if(goog.isArrayLike(a)||goog.isString(a)){return goog.array.isEmpty((a))}return goog.object.isEmpty(a)};goog.structs.clear=function(a){if(typeof a.clear=="function"){a.clear()}else{if(goog.isArrayLike(a)){goog.array.clear((a))}else{goog.object.clear(a)}}};goog.structs.forEach=function(c,h,g){if(typeof c.forEach=="function"){c.forEach(h,g)}else{if(goog.isArrayLike(c)||goog.isString(c)){goog.array.forEach((c),h,g)}else{var e=goog.structs.getKeys(c);var b=goog.structs.getValues(c);var a=b.length;for(var d=0;d<a;d++){h.call(g,b[d],e&&e[d],c)}}}};goog.structs.filter=function(c,h,g){if(typeof c.filter=="function"){return c.filter(h,g)}if(goog.isArrayLike(c)||goog.isString(c)){return goog.array.filter((c),h,g)}var j;var e=goog.structs.getKeys(c);var b=goog.structs.getValues(c);var a=b.length;if(e){j={};for(var d=0;d<a;d++){if(h.call(g,b[d],e[d],c)){j[e[d]]=b[d]}}}else{j=[];for(var d=0;d<a;d++){if(h.call(g,b[d],undefined,c)){j.push(b[d])}}}return j};goog.structs.map=function(c,h,g){if(typeof c.map=="function"){return c.map(h,g)}if(goog.isArrayLike(c)||goog.isString(c)){return goog.array.map((c),h,g)}var j;var e=goog.structs.getKeys(c);var b=goog.structs.getValues(c);var a=b.length;if(e){j={};for(var d=0;d<a;d++){j[e[d]]=h.call(g,b[d],e[d],c)}}else{j=[];for(var d=0;d<a;d++){j[d]=h.call(g,b[d],undefined,c)}}return j};goog.structs.some=function(c,h,g){if(typeof c.some=="function"){return c.some(h,g)}if(goog.isArrayLike(c)||goog.isString(c)){return goog.array.some((c),h,g)}var e=goog.structs.getKeys(c);var b=goog.structs.getValues(c);var a=b.length;for(var d=0;d<a;d++){if(h.call(g,b[d],e&&e[d],c)){return true}}return false};goog.structs.every=function(c,h,g){if(typeof c.every=="function"){return c.every(h,g)}if(goog.isArrayLike(c)||goog.isString(c)){return goog.array.every((c),h,g)}var e=goog.structs.getKeys(c);var b=goog.structs.getValues(c);var a=b.length;for(var d=0;d<a;d++){if(!h.call(g,b[d],e&&e[d],c)){return false}}return true};goog.provide("goog.structs.Map");goog.require("goog.iter.Iterator");goog.require("goog.iter.StopIteration");goog.require("goog.object");goog.require("goog.structs");goog.structs.Map=function(b,c){this.map_={};this.keys_=[];var d=arguments.length;if(d>1){if(d%2){throw Error("Uneven number of arguments")}for(var a=0;a<d;a+=2){this.set(arguments[a],arguments[a+1])}}else{if(b){this.addAll((b))}}};goog.structs.Map.prototype.count_=0;goog.structs.Map.prototype.version_=0;goog.structs.Map.prototype.getCount=function(){return this.count_};goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();var c=[];for(var b=0;b<this.keys_.length;b++){var a=this.keys_[b];c.push(this.map_[a])}return c};goog.structs.Map.prototype.getKeys=function(){this.cleanupKeysArray_();return(this.keys_.concat())};goog.structs.Map.prototype.containsKey=function(a){return goog.structs.Map.hasKey_(this.map_,a)};goog.structs.Map.prototype.containsValue=function(c){for(var b=0;b<this.keys_.length;b++){var a=this.keys_[b];if(goog.structs.Map.hasKey_(this.map_,a)&&this.map_[a]==c){return true}}return false};goog.structs.Map.prototype.equals=function(c,a){if(this===c){return true}if(this.count_!=c.getCount()){return false}var b=a||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var e,d=0;e=this.keys_[d];d++){if(!b(this.get(e),c.get(e))){return false}}return true};goog.structs.Map.defaultEquals=function(d,c){return d===c};goog.structs.Map.prototype.isEmpty=function(){return this.count_==0};goog.structs.Map.prototype.clear=function(){this.map_={};this.keys_.length=0;this.count_=0;this.version_=0};goog.structs.Map.prototype.remove=function(a){if(goog.structs.Map.hasKey_(this.map_,a)){delete this.map_[a];this.count_--;this.version_++;if(this.keys_.length>2*this.count_){this.cleanupKeysArray_()}return true}return false};goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){var c=0;var b=0;while(c<this.keys_.length){var d=this.keys_[c];if(goog.structs.Map.hasKey_(this.map_,d)){this.keys_[b++]=d}c++}this.keys_.length=b}if(this.count_!=this.keys_.length){var a={};var c=0;var b=0;while(c<this.keys_.length){var d=this.keys_[c];if(!(goog.structs.Map.hasKey_(a,d))){this.keys_[b++]=d;a[d]=1}c++}this.keys_.length=b}};goog.structs.Map.prototype.get=function(a,b){if(goog.structs.Map.hasKey_(this.map_,a)){return this.map_[a]}return b};goog.structs.Map.prototype.set=function(a,b){if(!(goog.structs.Map.hasKey_(this.map_,a))){this.count_++;this.keys_.push(a);this.version_++}this.map_[a]=b};goog.structs.Map.prototype.addAll=function(d){var c,a;if(d instanceof goog.structs.Map){c=d.getKeys();a=d.getValues()}else{c=goog.object.getKeys(d);a=goog.object.getValues(d)}for(var b=0;b<c.length;b++){this.set(c[b],a[b])}};goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)};goog.structs.Map.prototype.transpose=function(){var c=new goog.structs.Map();for(var b=0;b<this.keys_.length;b++){var a=this.keys_[b];var d=this.map_[a];c.set(d,a)}return c};goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();var c={};for(var b=0;b<this.keys_.length;b++){var a=this.keys_[b];c[a]=this.map_[a]}return c};goog.structs.Map.prototype.getKeyIterator=function(){return this.__iterator__(true)};goog.structs.Map.prototype.getValueIterator=function(){return this.__iterator__(false)};goog.structs.Map.prototype.__iterator__=function(g){this.cleanupKeysArray_();var b=0;var c=this.keys_;var d=this.map_;var a=this.version_;var f=this;var e=new goog.iter.Iterator;e.next=function(){while(true){if(a!=f.version_){throw Error("The map has changed since the iterator was created")}if(b>=c.length){throw goog.iter.StopIteration}var h=c[b++];return g?h:d[h]}};return e};goog.structs.Map.hasKey_=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};goog.provide("goog.structs.Set");goog.require("goog.structs");goog.require("goog.structs.Collection");goog.require("goog.structs.Map");goog.structs.Set=function(a){this.map_=new goog.structs.Map;if(a){this.addAll(a)}};goog.structs.Set.getKey_=function(b){var a=typeof b;if(a=="object"&&b||a=="function"){return"o"+goog.getUid((b))}else{return a.substr(0,1)+b}};goog.structs.Set.prototype.getCount=function(){return this.map_.getCount()};goog.structs.Set.prototype.add=function(a){this.map_.set(goog.structs.Set.getKey_(a),a)};goog.structs.Set.prototype.addAll=function(c){var b=goog.structs.getValues(c);var a=b.length;for(var d=0;d<a;d++){this.add(b[d])}};goog.structs.Set.prototype.removeAll=function(c){var b=goog.structs.getValues(c);var a=b.length;for(var d=0;d<a;d++){this.remove(b[d])}};goog.structs.Set.prototype.remove=function(a){return this.map_.remove(goog.structs.Set.getKey_(a))};goog.structs.Set.prototype.clear=function(){this.map_.clear()};goog.structs.Set.prototype.isEmpty=function(){return this.map_.isEmpty()};goog.structs.Set.prototype.contains=function(a){return this.map_.containsKey(goog.structs.Set.getKey_(a))};goog.structs.Set.prototype.containsAll=function(a){return goog.structs.every(a,this.contains,this)};goog.structs.Set.prototype.intersection=function(c){var a=new goog.structs.Set();var b=goog.structs.getValues(c);for(var d=0;d<b.length;d++){var e=b[d];if(this.contains(e)){a.add(e)}}return a};goog.structs.Set.prototype.difference=function(b){var a=this.clone();a.removeAll(b);return a};goog.structs.Set.prototype.getValues=function(){return this.map_.getValues()};goog.structs.Set.prototype.clone=function(){return new goog.structs.Set(this)};goog.structs.Set.prototype.equals=function(a){return this.getCount()==goog.structs.getCount(a)&&this.isSubsetOf(a)};goog.structs.Set.prototype.isSubsetOf=function(a){var b=goog.structs.getCount(a);if(this.getCount()>b){return false}if(!(a instanceof goog.structs.Set)&&b>5){a=new goog.structs.Set(a)}return goog.structs.every(this,function(c){return goog.structs.contains(a,c)})};goog.structs.Set.prototype.__iterator__=function(a){return this.map_.__iterator__(false)};goog.provide("goog.debug");goog.require("goog.array");goog.require("goog.string");goog.require("goog.structs.Set");goog.require("goog.userAgent");goog.debug.catchErrors=function(b,a,d){var f=d||goog.global;var c=f.onerror;var e=!!a;if(goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("535.3")){e=!e}f.onerror=function(i,h,g){if(c){c(i,h,g)}b({message:i,fileName:h,line:g});return e}};goog.debug.expose=function(f,b){if(typeof f=="undefined"){return"undefined"}if(f==null){return"NULL"}var g=[];for(var a in f){if(!b&&goog.isFunction(f[a])){continue}var c=a+" = ";try{c+=f[a]}catch(d){c+="*** "+d+" ***"}g.push(c)}return g.join("\n")};goog.debug.deepExpose=function(d,a){var c=new goog.structs.Set();var e=[];var b=function(k,h){var g=h+"  ";var j=function(l){return l.replace(/\n/g,"\n"+h)};try{if(!goog.isDef(k)){e.push("undefined")}else{if(goog.isNull(k)){e.push("NULL")}else{if(goog.isString(k)){e.push('"'+j(k)+'"')}else{if(goog.isFunction(k)){e.push(j(String(k)))}else{if(goog.isObject(k)){if(c.contains(k)){e.push("*** reference loop detected ***")}else{c.add(k);e.push("{");for(var f in k){if(!a&&goog.isFunction(k[f])){continue}e.push("\n");e.push(g);e.push(f+" = ");b(k[f],g)}e.push("\n"+h+"}")}}else{e.push(k)}}}}}}catch(i){e.push("*** "+i+" ***")}};b(d,"");return e.join("")};goog.debug.exposeArray=function(a){var c=[];for(var b=0;b<a.length;b++){if(goog.isArray(a[b])){c.push(goog.debug.exposeArray(a[b]))}else{c.push(a[b])}}return"[ "+c.join(", ")+" ]"};goog.debug.exposeException=function(c,b){try{var f=goog.debug.normalizeErrorObject(c);var a="Message: "+goog.string.htmlEscape(f.message)+'\nUrl: <a href="view-source:'+f.fileName+'" target="_new">'+f.fileName+"</a>\nLine: "+f.lineNumber+"\n\nBrowser stack:\n"+goog.string.htmlEscape(f.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+goog.string.htmlEscape(goog.debug.getStacktrace(b)+"-> ");return a}catch(d){return"Exception trying to expose exception! You win, we lose. "+d}};goog.debug.normalizeErrorObject=function(d){var b=goog.getObjectByName("window.location.href");if(goog.isString(d)){return{message:d,name:"Unknown error",lineNumber:"Not available",fileName:b,stack:"Not available"}}var a,g;var c=false;try{a=d.lineNumber||d.line||"Not available"}catch(f){a="Not available";c=true}try{g=d.fileName||d.filename||d.sourceURL||b}catch(f){g="Not available";c=true}if(c||!d.lineNumber||!d.fileName||!d.stack){return{message:d.message,name:d.name,lineNumber:a,fileName:g,stack:d.stack||"Not available"}}return d};goog.debug.enhanceError=function(c,d){var b=typeof c=="string"?Error(c):c;if(!b.stack){b.stack=goog.debug.getStacktrace(arguments.callee.caller)}if(d){var a=0;while(b["message"+a]){++a}b["message"+a]=String(d)}return b};goog.debug.getStacktraceSimple=function(a){var f=[];var b=arguments.callee.caller;var d=0;while(b&&(!a||d<a)){f.push(goog.debug.getFunctionName(b));f.push("()\n");try{b=b.caller}catch(c){f.push("[exception trying to get caller]\n");break}d++;if(d>=goog.debug.MAX_STACK_DEPTH){f.push("[...long stack...]");break}}if(a&&d>=a){f.push("[...reached max depth limit...]")}else{f.push("[end]")}return f.join("")};goog.debug.MAX_STACK_DEPTH=50;goog.debug.getStacktrace=function(a){return goog.debug.getStacktraceHelper_(a||arguments.callee.caller,[])};goog.debug.getStacktraceHelper_=function(g,b){var j=[];if(goog.array.contains(b,g)){j.push("[...circular reference...]")}else{if(g&&b.length<goog.debug.MAX_STACK_DEPTH){j.push(goog.debug.getFunctionName(g)+"(");var c=g.arguments;for(var d=0;d<c.length;d++){if(d>0){j.push(", ")}var f;var a=c[d];switch(typeof a){case"object":f=a?"object":"null";break;case"string":f=a;break;case"number":f=String(a);break;case"boolean":f=a?"true":"false";break;case"function":f=goog.debug.getFunctionName(a);f=f?f:"[fn]";break;case"undefined":default:f=typeof a;break}if(f.length>40){f=f.substr(0,40)+"..."}j.push(f)}b.push(g);j.push(")\n");try{j.push(goog.debug.getStacktraceHelper_(g.caller,b))}catch(h){j.push("[exception trying to get caller]\n")}}else{if(g){j.push("[...long stack...]")}else{j.push("[end]")}}}return j.join("")};goog.debug.setFunctionResolver=function(a){goog.debug.fnNameResolver_=a};goog.debug.getFunctionName=function(c){if(goog.debug.fnNameCache_[c]){return goog.debug.fnNameCache_[c]}if(goog.debug.fnNameResolver_){var a=goog.debug.fnNameResolver_(c);if(a){goog.debug.fnNameCache_[c]=a;return a}}var b=String(c);if(!goog.debug.fnNameCache_[b]){var d=/function ([^\(]+)/.exec(b);if(d){var e=d[1];goog.debug.fnNameCache_[b]=e}else{goog.debug.fnNameCache_[b]="[Anonymous]"}}return goog.debug.fnNameCache_[b]};goog.debug.makeWhitespaceVisible=function(a){return a.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.fnNameCache_={};goog.debug.fnNameResolver_;goog.provide("goog.debug.LogRecord");goog.debug.LogRecord=function(e,d,b,a,c){this.reset(e,d,b,a,c)};goog.debug.LogRecord.prototype.time_;goog.debug.LogRecord.prototype.level_;goog.debug.LogRecord.prototype.msg_;goog.debug.LogRecord.prototype.loggerName_;goog.debug.LogRecord.prototype.sequenceNumber_=0;goog.debug.LogRecord.prototype.exception_=null;goog.debug.LogRecord.prototype.exceptionText_=null;goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS=true;goog.debug.LogRecord.nextSequenceNumber_=0;goog.debug.LogRecord.prototype.reset=function(e,d,b,a,c){if(goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS){this.sequenceNumber_=typeof c=="number"?c:goog.debug.LogRecord.nextSequenceNumber_++}this.time_=a||goog.now();this.level_=e;this.msg_=d;this.loggerName_=b;delete this.exception_;delete this.exceptionText_};goog.debug.LogRecord.prototype.getLoggerName=function(){return this.loggerName_};goog.debug.LogRecord.prototype.getException=function(){return this.exception_};goog.debug.LogRecord.prototype.setException=function(a){this.exception_=a};goog.debug.LogRecord.prototype.getExceptionText=function(){return this.exceptionText_};goog.debug.LogRecord.prototype.setExceptionText=function(a){this.exceptionText_=a};goog.debug.LogRecord.prototype.setLoggerName=function(a){this.loggerName_=a};goog.debug.LogRecord.prototype.getLevel=function(){return this.level_};goog.debug.LogRecord.prototype.setLevel=function(a){this.level_=a};goog.debug.LogRecord.prototype.getMessage=function(){return this.msg_};goog.debug.LogRecord.prototype.setMessage=function(a){this.msg_=a};goog.debug.LogRecord.prototype.getMillis=function(){return this.time_};goog.debug.LogRecord.prototype.setMillis=function(a){this.time_=a};goog.debug.LogRecord.prototype.getSequenceNumber=function(){return this.sequenceNumber_};goog.provide("goog.debug.LogBuffer");goog.require("goog.asserts");goog.require("goog.debug.LogRecord");goog.debug.LogBuffer=function(){goog.asserts.assert(goog.debug.LogBuffer.isBufferingEnabled(),"Cannot use goog.debug.LogBuffer without defining goog.debug.LogBuffer.CAPACITY.");this.clear()};goog.debug.LogBuffer.getInstance=function(){if(!goog.debug.LogBuffer.instance_){goog.debug.LogBuffer.instance_=new goog.debug.LogBuffer()}return goog.debug.LogBuffer.instance_};goog.debug.LogBuffer.CAPACITY=0;goog.debug.LogBuffer.prototype.buffer_;goog.debug.LogBuffer.prototype.curIndex_;goog.debug.LogBuffer.prototype.isFull_;goog.debug.LogBuffer.prototype.addRecord=function(e,d,b){var c=(this.curIndex_+1)%goog.debug.LogBuffer.CAPACITY;this.curIndex_=c;if(this.isFull_){var a=this.buffer_[c];a.reset(e,d,b);return a}this.isFull_=c==goog.debug.LogBuffer.CAPACITY-1;return this.buffer_[c]=new goog.debug.LogRecord(e,d,b)};goog.debug.LogBuffer.isBufferingEnabled=function(){return goog.debug.LogBuffer.CAPACITY>0};goog.debug.LogBuffer.prototype.clear=function(){this.buffer_=new Array(goog.debug.LogBuffer.CAPACITY);this.curIndex_=-1;this.isFull_=false};goog.debug.LogBuffer.prototype.forEachRecord=function(d){var a=this.buffer_;if(!a[0]){return}var c=this.curIndex_;var b=this.isFull_?c:-1;do{b=(b+1)%goog.debug.LogBuffer.CAPACITY;d((a[b]))}while(b!=c)};goog.provide("goog.debug.LogManager");goog.provide("goog.debug.Logger");goog.provide("goog.debug.Logger.Level");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.debug");goog.require("goog.debug.LogBuffer");goog.require("goog.debug.LogRecord");goog.debug.Logger=function(a){this.name_=a};goog.debug.Logger.prototype.parent_=null;goog.debug.Logger.prototype.level_=null;goog.debug.Logger.prototype.children_=null;goog.debug.Logger.prototype.handlers_=null;goog.debug.Logger.ENABLE_HIERARCHY=true;if(!goog.debug.Logger.ENABLE_HIERARCHY){goog.debug.Logger.rootHandlers_=[];goog.debug.Logger.rootLevel_}goog.debug.Logger.Level=function(a,b){this.name=a;this.value=b};goog.debug.Logger.Level.prototype.toString=function(){return this.name};goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",Infinity);goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200);goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1000);goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900);goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800);goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700);goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500);goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400);goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300);goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0);goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL];goog.debug.Logger.Level.predefinedLevelsCache_=null;goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var a=0,b;b=goog.debug.Logger.Level.PREDEFINED_LEVELS[a];a++){goog.debug.Logger.Level.predefinedLevelsCache_[b.value]=b;goog.debug.Logger.Level.predefinedLevelsCache_[b.name]=b}};goog.debug.Logger.Level.getPredefinedLevel=function(a){if(!goog.debug.Logger.Level.predefinedLevelsCache_){goog.debug.Logger.Level.createPredefinedLevelsCache_()}return goog.debug.Logger.Level.predefinedLevelsCache_[a]||null};goog.debug.Logger.Level.getPredefinedLevelByValue=function(b){if(!goog.debug.Logger.Level.predefinedLevelsCache_){goog.debug.Logger.Level.createPredefinedLevelsCache_()}if(b in goog.debug.Logger.Level.predefinedLevelsCache_){return goog.debug.Logger.Level.predefinedLevelsCache_[b]}for(var a=0;a<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++a){var c=goog.debug.Logger.Level.PREDEFINED_LEVELS[a];if(c.value<=b){return c}}return null};goog.debug.Logger.getLogger=function(a){return goog.debug.LogManager.getLogger(a)};goog.debug.Logger.logToProfilers=function(a){if(goog.global.console){if(goog.global.console["timeStamp"]){goog.global.console["timeStamp"](a)}else{if(goog.global.console["markTimeline"]){goog.global.console["markTimeline"](a)}}}if(goog.global.msWriteProfilerMark){goog.global.msWriteProfilerMark(a)}};goog.debug.Logger.prototype.getName=function(){return this.name_};goog.debug.Logger.prototype.addHandler=function(a){if(goog.debug.Logger.ENABLE_HIERARCHY){if(!this.handlers_){this.handlers_=[]}this.handlers_.push(a)}else{goog.asserts.assert(!this.name_,"Cannot call addHandler on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false.");goog.debug.Logger.rootHandlers_.push(a)}};goog.debug.Logger.prototype.removeHandler=function(b){var a=goog.debug.Logger.ENABLE_HIERARCHY?this.handlers_:goog.debug.Logger.rootHandlers_;return !!a&&goog.array.remove(a,b)};goog.debug.Logger.prototype.getParent=function(){return this.parent_};goog.debug.Logger.prototype.getChildren=function(){if(!this.children_){this.children_={}}return this.children_};goog.debug.Logger.prototype.setLevel=function(a){if(goog.debug.Logger.ENABLE_HIERARCHY){this.level_=a}else{goog.asserts.assert(!this.name_,"Cannot call setLevel() on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false.");goog.debug.Logger.rootLevel_=a}};goog.debug.Logger.prototype.getLevel=function(){return this.level_};goog.debug.Logger.prototype.getEffectiveLevel=function(){if(!goog.debug.Logger.ENABLE_HIERARCHY){return goog.debug.Logger.rootLevel_}if(this.level_){return this.level_}if(this.parent_){return this.parent_.getEffectiveLevel()}goog.asserts.fail("Root logger has no level set.");return null};goog.debug.Logger.prototype.isLoggable=function(a){return a.value>=this.getEffectiveLevel().value};goog.debug.Logger.prototype.log=function(c,b,a){if(this.isLoggable(c)){this.doLogRecord_(this.getLogRecord(c,b,a))}};goog.debug.Logger.prototype.getLogRecord=function(d,c,a){if(goog.debug.LogBuffer.isBufferingEnabled()){var b=goog.debug.LogBuffer.getInstance().addRecord(d,c,this.name_)}else{b=new goog.debug.LogRecord(d,String(c),this.name_)}if(a){b.setException(a);b.setExceptionText(goog.debug.exposeException(a,arguments.callee.caller))}return b};goog.debug.Logger.prototype.shout=function(b,a){this.log(goog.debug.Logger.Level.SHOUT,b,a)};goog.debug.Logger.prototype.severe=function(b,a){this.log(goog.debug.Logger.Level.SEVERE,b,a)};goog.debug.Logger.prototype.warning=function(b,a){this.log(goog.debug.Logger.Level.WARNING,b,a)};goog.debug.Logger.prototype.info=function(b,a){this.log(goog.debug.Logger.Level.INFO,b,a)};goog.debug.Logger.prototype.config=function(b,a){this.log(goog.debug.Logger.Level.CONFIG,b,a)};goog.debug.Logger.prototype.fine=function(b,a){this.log(goog.debug.Logger.Level.FINE,b,a)};goog.debug.Logger.prototype.finer=function(b,a){this.log(goog.debug.Logger.Level.FINER,b,a)};goog.debug.Logger.prototype.finest=function(b,a){this.log(goog.debug.Logger.Level.FINEST,b,a)};goog.debug.Logger.prototype.logRecord=function(a){if(this.isLoggable(a.getLevel())){this.doLogRecord_(a)}};goog.debug.Logger.prototype.doLogRecord_=function(d){goog.debug.Logger.logToProfilers("log:"+d.getMessage());if(goog.debug.Logger.ENABLE_HIERARCHY){var c=this;while(c){c.callPublish_(d);c=c.getParent()}}else{for(var a=0,b;b=goog.debug.Logger.rootHandlers_[a++];){b(d)}}};goog.debug.Logger.prototype.callPublish_=function(c){if(this.handlers_){for(var a=0,b;b=this.handlers_[a];a++){b(c)}}};goog.debug.Logger.prototype.setParent_=function(a){this.parent_=a};goog.debug.Logger.prototype.addChild_=function(b,a){this.getChildren()[b]=a};goog.debug.LogManager={};goog.debug.LogManager.loggers_={};goog.debug.LogManager.rootLogger_=null;goog.debug.LogManager.initialize=function(){if(!goog.debug.LogManager.rootLogger_){goog.debug.LogManager.rootLogger_=new goog.debug.Logger("");goog.debug.LogManager.loggers_[""]=goog.debug.LogManager.rootLogger_;goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG)}};goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_};goog.debug.LogManager.getRoot=function(){goog.debug.LogManager.initialize();return(goog.debug.LogManager.rootLogger_)};goog.debug.LogManager.getLogger=function(b){goog.debug.LogManager.initialize();var a=goog.debug.LogManager.loggers_[b];return a||goog.debug.LogManager.createLogger_(b)};goog.debug.LogManager.createFunctionForCatchErrors=function(a){return function(c){var b=a||goog.debug.LogManager.getRoot();b.severe("Error: "+c.message+" ("+c.fileName+" @ Line: "+c.line+")")}};goog.debug.LogManager.createLogger_=function(c){var b=new goog.debug.Logger(c);if(goog.debug.Logger.ENABLE_HIERARCHY){var f=c.lastIndexOf(".");var e=c.substr(0,f);var a=c.substr(f+1);var d=goog.debug.LogManager.getLogger(e);d.addChild_(a,b);b.setParent_(d)}goog.debug.LogManager.loggers_[c]=b;return b};goog.provide("goog.disposable.IDisposable");goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose;goog.disposable.IDisposable.prototype.isDisposed;goog.provide("goog.Disposable");goog.provide("goog.dispose");goog.require("goog.disposable.IDisposable");goog.Disposable=function(){if(goog.Disposable.ENABLE_MONITORING){this.creationStack=new Error().stack;goog.Disposable.instances_[goog.getUid(this)]=this}};goog.Disposable.ENABLE_MONITORING=false;goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var a=[];for(var b in goog.Disposable.instances_){if(goog.Disposable.instances_.hasOwnProperty(b)){a.push(goog.Disposable.instances_[Number(b)])}}return a};goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=false;goog.Disposable.prototype.dependentDisposables_;goog.Disposable.prototype.onDisposeCallbacks_;goog.Disposable.prototype.creationStack;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;goog.Disposable.prototype.dispose=function(){if(!this.disposed_){this.disposed_=true;this.disposeInternal();if(goog.Disposable.ENABLE_MONITORING){var a=goog.getUid(this);if(!goog.Disposable.instances_.hasOwnProperty(a)){throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call")}delete goog.Disposable.instances_[a]}}};goog.Disposable.prototype.registerDisposable=function(a){if(!this.dependentDisposables_){this.dependentDisposables_=[]}this.dependentDisposables_.push(a)};goog.Disposable.prototype.addOnDisposeCallback=function(b,a){if(!this.onDisposeCallbacks_){this.onDisposeCallbacks_=[]}this.onDisposeCallbacks_.push(goog.bind(b,a))};goog.Disposable.prototype.disposeInternal=function(){if(this.dependentDisposables_){goog.disposeAll.apply(null,this.dependentDisposables_)}if(this.onDisposeCallbacks_){while(this.onDisposeCallbacks_.length){this.onDisposeCallbacks_.shift()()}}};goog.dispose=function(a){if(a&&typeof a.dispose=="function"){a.dispose()}};goog.disposeAll=function(d){for(var b=0,a=arguments.length;b<a;++b){var c=arguments[b];if(goog.isArrayLike(c)){goog.disposeAll.apply(null,c)}else{goog.dispose(c)}}};goog.provide("goog.dom.SavedRange");goog.require("goog.Disposable");goog.require("goog.debug.Logger");goog.dom.SavedRange=function(){goog.Disposable.call(this)};goog.inherits(goog.dom.SavedRange,goog.Disposable);goog.dom.SavedRange.logger_=goog.debug.Logger.getLogger("goog.dom.SavedRange");goog.dom.SavedRange.prototype.restore=function(b){if(this.isDisposed()){goog.dom.SavedRange.logger_.severe("Disposed SavedRange objects cannot be restored.")}var a=this.restoreInternal();if(!b){this.dispose()}return a};goog.dom.SavedRange.prototype.restoreInternal=goog.abstractMethod;goog.provide("goog.dom.SavedCaretRange");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.SavedRange");goog.require("goog.dom.TagName");goog.require("goog.string");goog.dom.SavedCaretRange=function(a){goog.dom.SavedRange.call(this);this.startCaretId_=goog.string.createUniqueString();this.endCaretId_=goog.string.createUniqueString();this.dom_=goog.dom.getDomHelper(a.getDocument());a.surroundWithNodes(this.createCaret_(true),this.createCaret_(false))};goog.inherits(goog.dom.SavedCaretRange,goog.dom.SavedRange);goog.dom.SavedCaretRange.prototype.toAbstractRange=function(){var b=null;var c=this.getCaret(true);var a=this.getCaret(false);if(c&&a){b=goog.dom.Range.createFromNodes(c,0,a,0)}return b};goog.dom.SavedCaretRange.prototype.getCaret=function(a){return this.dom_.getElement(a?this.startCaretId_:this.endCaretId_)};goog.dom.SavedCaretRange.prototype.removeCarets=function(a){goog.dom.removeNode(this.getCaret(true));goog.dom.removeNode(this.getCaret(false));return a};goog.dom.SavedCaretRange.prototype.setRestorationDocument=function(a){this.dom_.setDocument(a)};goog.dom.SavedCaretRange.prototype.restoreInternal=function(){var d=null;var g=this.getCaret(true);var c=this.getCaret(false);if(g&&c){var f=g.parentNode;var b=goog.array.indexOf(f.childNodes,g);var a=c.parentNode;var e=goog.array.indexOf(a.childNodes,c);if(a==f){e-=1}d=goog.dom.Range.createFromNodes(f,b,a,e);d=this.removeCarets(d);d.select()}else{this.removeCarets()}return d};goog.dom.SavedCaretRange.prototype.disposeInternal=function(){this.removeCarets();this.dom_=null};goog.dom.SavedCaretRange.prototype.createCaret_=function(a){return this.dom_.createDom(goog.dom.TagName.SPAN,{id:a?this.startCaretId_:this.endCaretId_})};goog.dom.SavedCaretRange.CARET_REGEX=/<span\s+id="?goog_\d+"?><\/span>/ig;goog.dom.SavedCaretRange.htmlEqual=function(b,a){return b==a||b.replace(goog.dom.SavedCaretRange.CARET_REGEX,"")==a.replace(goog.dom.SavedCaretRange.CARET_REGEX,"")};goog.provide("goog.dom.TagIterator");goog.provide("goog.dom.TagWalkType");goog.require("goog.dom.NodeType");goog.require("goog.iter.Iterator");goog.require("goog.iter.StopIteration");goog.dom.TagWalkType={START_TAG:1,OTHER:0,END_TAG:-1};goog.dom.TagIterator=function(e,a,c,d,b){this.reversed=!!a;if(e){this.setPosition(e,d)}this.depth=b!=undefined?b:this.tagType||0;if(this.reversed){this.depth*=-1}this.constrained=!c};goog.inherits(goog.dom.TagIterator,goog.iter.Iterator);goog.dom.TagIterator.prototype.node=null;goog.dom.TagIterator.prototype.tagType=goog.dom.TagWalkType.OTHER;goog.dom.TagIterator.prototype.depth;goog.dom.TagIterator.prototype.reversed;goog.dom.TagIterator.prototype.constrained;goog.dom.TagIterator.prototype.started_=false;goog.dom.TagIterator.prototype.setPosition=function(b,c,a){this.node=b;if(b){if(goog.isNumber(c)){this.tagType=c}else{this.tagType=this.node.nodeType!=goog.dom.NodeType.ELEMENT?goog.dom.TagWalkType.OTHER:this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG}}if(goog.isNumber(a)){this.depth=a}};goog.dom.TagIterator.prototype.copyFrom=function(a){this.node=a.node;this.tagType=a.tagType;this.depth=a.depth;this.reversed=a.reversed;this.constrained=a.constrained};goog.dom.TagIterator.prototype.clone=function(){return new goog.dom.TagIterator(this.node,this.reversed,!this.constrained,this.tagType,this.depth)};goog.dom.TagIterator.prototype.skipTag=function(){var a=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==a){this.tagType=(a*-1);this.depth+=this.tagType*(this.reversed?-1:1)}};goog.dom.TagIterator.prototype.restartTag=function(){var a=this.reversed?goog.dom.TagWalkType.START_TAG:goog.dom.TagWalkType.END_TAG;if(this.tagType==a){this.tagType=(a*-1);this.depth+=this.tagType*(this.reversed?-1:1)}};goog.dom.TagIterator.prototype.next=function(){var c;if(this.started_){if(!this.node||this.constrained&&this.depth==0){throw goog.iter.StopIteration}c=this.node;var a=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==a){var d=this.reversed?c.lastChild:c.firstChild;if(d){this.setPosition(d)}else{this.setPosition(c,(a*-1))}}else{var b=this.reversed?c.previousSibling:c.nextSibling;if(b){this.setPosition(b)}else{this.setPosition(c.parentNode,(a*-1))}}this.depth+=this.tagType*(this.reversed?-1:1)}else{this.started_=true}c=this.node;if(!this.node){throw goog.iter.StopIteration}return c};goog.dom.TagIterator.prototype.isStarted=function(){return this.started_};goog.dom.TagIterator.prototype.isStartTag=function(){return this.tagType==goog.dom.TagWalkType.START_TAG};goog.dom.TagIterator.prototype.isEndTag=function(){return this.tagType==goog.dom.TagWalkType.END_TAG};goog.dom.TagIterator.prototype.isNonElement=function(){return this.tagType==goog.dom.TagWalkType.OTHER};goog.dom.TagIterator.prototype.equals=function(a){return a.node==this.node&&(!this.node||a.tagType==this.tagType)};goog.dom.TagIterator.prototype.splice=function(d){var c=this.node;this.restartTag();this.reversed=!this.reversed;goog.dom.TagIterator.prototype.next.call(this);this.reversed=!this.reversed;var a=goog.isArrayLike(arguments[0])?arguments[0]:arguments;for(var b=a.length-1;b>=0;b--){goog.dom.insertSiblingAfter(a[b],c)}goog.dom.removeNode(c)};goog.provide("goog.dom.AbstractRange");goog.provide("goog.dom.RangeIterator");goog.provide("goog.dom.RangeType");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.SavedCaretRange");goog.require("goog.dom.TagIterator");goog.require("goog.userAgent");goog.dom.RangeType={TEXT:"text",CONTROL:"control",MULTI:"mutli"};goog.dom.AbstractRange=function(){};goog.dom.AbstractRange.getBrowserSelectionForWindow=function(f){if(f.getSelection){return f.getSelection()}else{var d=f.document;var b=d.selection;if(b){try{var a=b.createRange();if(a.parentElement){if(a.parentElement().document!=d){return null}}else{if(!a.length||a.item(0).document!=d){return null}}}catch(c){return null}return b}return null}};goog.dom.AbstractRange.isNativeControlRange=function(a){return !!a&&!!a.addElement};goog.dom.AbstractRange.prototype.clone=goog.abstractMethod;goog.dom.AbstractRange.prototype.getType=goog.abstractMethod;goog.dom.AbstractRange.prototype.getBrowserRangeObject=goog.abstractMethod;goog.dom.AbstractRange.prototype.setBrowserRangeObject=function(a){return false};goog.dom.AbstractRange.prototype.getTextRangeCount=goog.abstractMethod;goog.dom.AbstractRange.prototype.getTextRange=goog.abstractMethod;goog.dom.AbstractRange.prototype.getTextRanges=function(){var b=[];for(var c=0,a=this.getTextRangeCount();c<a;c++){b.push(this.getTextRange(c))}return b};goog.dom.AbstractRange.prototype.getContainer=goog.abstractMethod;goog.dom.AbstractRange.prototype.getContainerElement=function(){var a=this.getContainer();return(a.nodeType==goog.dom.NodeType.ELEMENT?a:a.parentNode)};goog.dom.AbstractRange.prototype.getStartNode=goog.abstractMethod;goog.dom.AbstractRange.prototype.getStartOffset=goog.abstractMethod;goog.dom.AbstractRange.prototype.getEndNode=goog.abstractMethod;goog.dom.AbstractRange.prototype.getEndOffset=goog.abstractMethod;goog.dom.AbstractRange.prototype.getAnchorNode=function(){return this.isReversed()?this.getEndNode():this.getStartNode()};goog.dom.AbstractRange.prototype.getAnchorOffset=function(){return this.isReversed()?this.getEndOffset():this.getStartOffset()};goog.dom.AbstractRange.prototype.getFocusNode=function(){return this.isReversed()?this.getStartNode():this.getEndNode()};goog.dom.AbstractRange.prototype.getFocusOffset=function(){return this.isReversed()?this.getStartOffset():this.getEndOffset()};goog.dom.AbstractRange.prototype.isReversed=function(){return false};goog.dom.AbstractRange.prototype.getDocument=function(){return goog.dom.getOwnerDocument(goog.userAgent.IE?this.getContainer():this.getStartNode())};goog.dom.AbstractRange.prototype.getWindow=function(){return goog.dom.getWindow(this.getDocument())};goog.dom.AbstractRange.prototype.containsRange=goog.abstractMethod;goog.dom.AbstractRange.prototype.containsNode=function(a,b){return this.containsRange(goog.dom.Range.createFromNodeContents(a),b)};goog.dom.AbstractRange.prototype.isRangeInDocument=goog.abstractMethod;goog.dom.AbstractRange.prototype.isCollapsed=goog.abstractMethod;goog.dom.AbstractRange.prototype.getText=goog.abstractMethod;goog.dom.AbstractRange.prototype.getHtmlFragment=goog.abstractMethod;goog.dom.AbstractRange.prototype.getValidHtml=goog.abstractMethod;goog.dom.AbstractRange.prototype.getPastableHtml=goog.abstractMethod;goog.dom.AbstractRange.prototype.__iterator__=goog.abstractMethod;goog.dom.AbstractRange.prototype.select=goog.abstractMethod;goog.dom.AbstractRange.prototype.removeContents=goog.abstractMethod;goog.dom.AbstractRange.prototype.insertNode=goog.abstractMethod;goog.dom.AbstractRange.prototype.replaceContentsWithNode=function(a){if(!this.isCollapsed()){this.removeContents()}return this.insertNode(a,true)};goog.dom.AbstractRange.prototype.surroundWithNodes=goog.abstractMethod;goog.dom.AbstractRange.prototype.saveUsingDom=goog.abstractMethod;goog.dom.AbstractRange.prototype.saveUsingCarets=function(){return(this.getStartNode()&&this.getEndNode())?new goog.dom.SavedCaretRange(this):null};goog.dom.AbstractRange.prototype.collapse=goog.abstractMethod;goog.dom.RangeIterator=function(a,b){goog.dom.TagIterator.call(this,a,b,true)};goog.inherits(goog.dom.RangeIterator,goog.dom.TagIterator);goog.dom.RangeIterator.prototype.getStartTextOffset=goog.abstractMethod;goog.dom.RangeIterator.prototype.getEndTextOffset=goog.abstractMethod;goog.dom.RangeIterator.prototype.getStartNode=goog.abstractMethod;goog.dom.RangeIterator.prototype.getEndNode=goog.abstractMethod;goog.dom.RangeIterator.prototype.isLast=goog.abstractMethod;goog.provide("goog.dom.AbstractMultiRange");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.AbstractRange");goog.dom.AbstractMultiRange=function(){};goog.inherits(goog.dom.AbstractMultiRange,goog.dom.AbstractRange);goog.dom.AbstractMultiRange.prototype.containsRange=function(e,d){var a=this.getTextRanges();var c=e.getTextRanges();var b=d?goog.array.some:goog.array.every;return b(c,function(f){return goog.array.some(a,function(g){return g.containsRange(f,d)})})};goog.dom.AbstractMultiRange.prototype.insertNode=function(a,b){if(b){goog.dom.insertSiblingBefore(a,this.getStartNode())}else{goog.dom.insertSiblingAfter(a,this.getEndNode())}return a};goog.dom.AbstractMultiRange.prototype.surroundWithNodes=function(b,a){this.insertNode(b,true);this.insertNode(a,false)};goog.provide("goog.dom.TextRangeIterator");goog.require("goog.array");goog.require("goog.dom.NodeType");goog.require("goog.dom.RangeIterator");goog.require("goog.dom.TagName");goog.require("goog.iter.StopIteration");goog.dom.TextRangeIterator=function(b,g,c,h,f){var i;if(b){this.startNode_=b;this.startOffset_=g;this.endNode_=c;this.endOffset_=h;if(b.nodeType==goog.dom.NodeType.ELEMENT&&b.tagName!=goog.dom.TagName.BR){var a=b.childNodes;var j=a[g];if(j){this.startNode_=j;this.startOffset_=0}else{if(a.length){this.startNode_=(goog.array.peek(a))}i=true}}if(c.nodeType==goog.dom.NodeType.ELEMENT){this.endNode_=c.childNodes[h];if(this.endNode_){this.endOffset_=0}else{this.endNode_=c}}}goog.dom.RangeIterator.call(this,f?this.endNode_:this.startNode_,f);if(i){try{this.next()}catch(d){if(d!=goog.iter.StopIteration){throw d}}}};goog.inherits(goog.dom.TextRangeIterator,goog.dom.RangeIterator);goog.dom.TextRangeIterator.prototype.startNode_=null;goog.dom.TextRangeIterator.prototype.endNode_=null;goog.dom.TextRangeIterator.prototype.startOffset_=0;goog.dom.TextRangeIterator.prototype.endOffset_=0;goog.dom.TextRangeIterator.prototype.getStartTextOffset=function(){return this.node.nodeType!=goog.dom.NodeType.TEXT?-1:this.node==this.startNode_?this.startOffset_:0};goog.dom.TextRangeIterator.prototype.getEndTextOffset=function(){return this.node.nodeType!=goog.dom.NodeType.TEXT?-1:this.node==this.endNode_?this.endOffset_:this.node.nodeValue.length};goog.dom.TextRangeIterator.prototype.getStartNode=function(){return this.startNode_};goog.dom.TextRangeIterator.prototype.setStartNode=function(a){if(!this.isStarted()){this.setPosition(a)}this.startNode_=a;this.startOffset_=0};goog.dom.TextRangeIterator.prototype.getEndNode=function(){return this.endNode_};goog.dom.TextRangeIterator.prototype.setEndNode=function(a){this.endNode_=a;this.endOffset_=0};goog.dom.TextRangeIterator.prototype.isLast=function(){return this.isStarted()&&this.node==this.endNode_&&(!this.endOffset_||!this.isStartTag())};goog.dom.TextRangeIterator.prototype.next=function(){if(this.isLast()){throw goog.iter.StopIteration}return goog.dom.TextRangeIterator.superClass_.next.call(this)};goog.dom.TextRangeIterator.prototype.skipTag=function(){goog.dom.TextRangeIterator.superClass_.skipTag.apply(this);if(goog.dom.contains(this.node,this.endNode_)){throw goog.iter.StopIteration}};goog.dom.TextRangeIterator.prototype.copyFrom=function(a){this.startNode_=a.startNode_;this.endNode_=a.endNode_;this.startOffset_=a.startOffset_;this.endOffset_=a.endOffset_;this.isReversed_=a.isReversed_;goog.dom.TextRangeIterator.superClass_.copyFrom.call(this,a)};goog.dom.TextRangeIterator.prototype.clone=function(){var a=new goog.dom.TextRangeIterator(this.startNode_,this.startOffset_,this.endNode_,this.endOffset_,this.isReversed_);a.copyFrom(this);return a};goog.provide("goog.string.StringBuffer");goog.string.StringBuffer=function(a,b){if(a!=null){this.append.apply(this,arguments)}};goog.string.StringBuffer.prototype.buffer_="";goog.string.StringBuffer.prototype.set=function(a){this.buffer_=""+a};goog.string.StringBuffer.prototype.append=function(b,a,d){this.buffer_+=b;if(a!=null){for(var c=1;c<arguments.length;c++){this.buffer_+=arguments[c]}}return this};goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""};goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length};goog.string.StringBuffer.prototype.toString=function(){return this.buffer_};goog.provide("goog.dom.browserrange.AbstractRange");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.RangeEndpoint");goog.require("goog.dom.TagName");goog.require("goog.dom.TextRangeIterator");goog.require("goog.iter");goog.require("goog.string");goog.require("goog.string.StringBuffer");goog.require("goog.userAgent");goog.dom.browserrange.AbstractRange=function(){};goog.dom.browserrange.AbstractRange.prototype.clone=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getBrowserRange=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getContainer=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getStartNode=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getStartOffset=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getEndNode=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getEndOffset=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.compareBrowserRangeEndpoints=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.containsRange=function(h,f){var c=f&&!h.isCollapsed();var b=h.getBrowserRange();var g=goog.dom.RangeEndpoint.START,a=goog.dom.RangeEndpoint.END;try{if(c){return this.compareBrowserRangeEndpoints(b,a,g)>=0&&this.compareBrowserRangeEndpoints(b,g,a)<=0}else{return this.compareBrowserRangeEndpoints(b,a,a)>=0&&this.compareBrowserRangeEndpoints(b,g,g)<=0}}catch(d){if(!goog.userAgent.IE){throw d}return false}};goog.dom.browserrange.AbstractRange.prototype.containsNode=function(a,b){return this.containsRange(goog.dom.browserrange.createRangeFromNodeContents(a),b)};goog.dom.browserrange.AbstractRange.prototype.isCollapsed=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getText=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.getHtmlFragment=function(){var a=new goog.string.StringBuffer();goog.iter.forEach(this,function(e,g,d){if(e.nodeType==goog.dom.NodeType.TEXT){a.append(goog.string.htmlEscape(e.nodeValue.substring(d.getStartTextOffset(),d.getEndTextOffset())))}else{if(e.nodeType==goog.dom.NodeType.ELEMENT){if(d.isEndTag()){if(goog.dom.canHaveChildren(e)){a.append("</"+e.tagName+">")}}else{var f=e.cloneNode(false);var c=goog.dom.getOuterHtml(f);if(goog.userAgent.IE&&e.tagName==goog.dom.TagName.LI){a.append(c)}else{var b=c.lastIndexOf("<");a.append(b?c.substr(0,b):c)}}}}},this);return a.toString()};goog.dom.browserrange.AbstractRange.prototype.getValidHtml=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.__iterator__=function(a){return new goog.dom.TextRangeIterator(this.getStartNode(),this.getStartOffset(),this.getEndNode(),this.getEndOffset())};goog.dom.browserrange.AbstractRange.prototype.select=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.removeContents=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.surroundContents=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.insertNode=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.surroundWithNodes=goog.abstractMethod;goog.dom.browserrange.AbstractRange.prototype.collapse=goog.abstractMethod;goog.provide("goog.dom.browserrange.W3cRange");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.RangeEndpoint");goog.require("goog.dom.browserrange.AbstractRange");goog.require("goog.string");goog.dom.browserrange.W3cRange=function(a){this.range_=a};goog.inherits(goog.dom.browserrange.W3cRange,goog.dom.browserrange.AbstractRange);goog.dom.browserrange.W3cRange.getBrowserRangeForNode=function(d){var f=goog.dom.getOwnerDocument(d).createRange();if(d.nodeType==goog.dom.NodeType.TEXT){f.setStart(d,0);f.setEnd(d,d.length)}else{if(!goog.dom.browserrange.canContainRangeEndpoint(d)){var c=d.parentNode;var b=goog.array.indexOf(c.childNodes,d);f.setStart(c,b);f.setEnd(c,b+1)}else{var e,a=d;while((e=a.firstChild)&&goog.dom.browserrange.canContainRangeEndpoint(e)){a=e}f.setStart(a,0);a=d;while((e=a.lastChild)&&goog.dom.browserrange.canContainRangeEndpoint(e)){a=e}f.setEnd(a,a.nodeType==goog.dom.NodeType.ELEMENT?a.childNodes.length:a.length)}}return f};goog.dom.browserrange.W3cRange.getBrowserRangeForNodes=function(d,b,a,c){var e=goog.dom.getOwnerDocument(d).createRange();e.setStart(d,b);e.setEnd(a,c);return e};goog.dom.browserrange.W3cRange.createFromNodeContents=function(a){return new goog.dom.browserrange.W3cRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNode(a))};goog.dom.browserrange.W3cRange.createFromNodes=function(d,b,a,c){return new goog.dom.browserrange.W3cRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNodes(d,b,a,c))};goog.dom.browserrange.W3cRange.prototype.clone=function(){return new this.constructor(this.range_.cloneRange())};goog.dom.browserrange.W3cRange.prototype.getBrowserRange=function(){return this.range_};goog.dom.browserrange.W3cRange.prototype.getContainer=function(){return this.range_.commonAncestorContainer};goog.dom.browserrange.W3cRange.prototype.getStartNode=function(){return this.range_.startContainer};goog.dom.browserrange.W3cRange.prototype.getStartOffset=function(){return this.range_.startOffset};goog.dom.browserrange.W3cRange.prototype.getEndNode=function(){return this.range_.endContainer};goog.dom.browserrange.W3cRange.prototype.getEndOffset=function(){return this.range_.endOffset};goog.dom.browserrange.W3cRange.prototype.compareBrowserRangeEndpoints=function(b,c,a){return this.range_.compareBoundaryPoints(a==goog.dom.RangeEndpoint.START?(c==goog.dom.RangeEndpoint.START?goog.global.Range.START_TO_START:goog.global.Range.START_TO_END):(c==goog.dom.RangeEndpoint.START?goog.global.Range.END_TO_START:goog.global.Range.END_TO_END),(b))};goog.dom.browserrange.W3cRange.prototype.isCollapsed=function(){return this.range_.collapsed};goog.dom.browserrange.W3cRange.prototype.getText=function(){return this.range_.toString()};goog.dom.browserrange.W3cRange.prototype.getValidHtml=function(){var d=goog.dom.getDomHelper(this.range_.startContainer).createDom("div");d.appendChild(this.range_.cloneContents());var a=d.innerHTML;if(goog.string.startsWith(a,"<")||!this.isCollapsed()&&!goog.string.contains(a,"<")){return a}var b=this.getContainer();b=b.nodeType==goog.dom.NodeType.ELEMENT?b:b.parentNode;var c=goog.dom.getOuterHtml((b.cloneNode(false)));return c.replace(">",">"+a)};goog.dom.browserrange.W3cRange.prototype.select=function(a){var b=goog.dom.getWindow(goog.dom.getOwnerDocument(this.getStartNode()));this.selectInternal(b.getSelection(),a)};goog.dom.browserrange.W3cRange.prototype.selectInternal=function(b,a){b.removeAllRanges();b.addRange(this.range_)};goog.dom.browserrange.W3cRange.prototype.removeContents=function(){var a=this.range_;a.extractContents();if(a.startContainer.hasChildNodes()){var c=a.startContainer.childNodes[a.startOffset];if(c){var b=c.previousSibling;if(goog.dom.getRawTextContent(c)==""){goog.dom.removeNode(c)}if(b&&goog.dom.getRawTextContent(b)==""){goog.dom.removeNode(b)}}}};goog.dom.browserrange.W3cRange.prototype.surroundContents=function(a){this.range_.surroundContents(a);return a};goog.dom.browserrange.W3cRange.prototype.insertNode=function(b,c){var a=this.range_.cloneRange();a.collapse(c);a.insertNode(b);a.detach();return b};goog.dom.browserrange.W3cRange.prototype.surroundWithNodes=function(b,d){var e=goog.dom.getWindow(goog.dom.getOwnerDocument(this.getStartNode()));var a=goog.dom.Range.createFromWindow(e);if(a){var f=a.getStartNode();var j=a.getEndNode();var k=a.getStartOffset();var c=a.getEndOffset()}var h=this.range_.cloneRange();var g=this.range_.cloneRange();h.collapse(false);g.collapse(true);h.insertNode(d);g.insertNode(b);h.detach();g.detach();if(a){var i=function(l){return l==b||l==d};if(f.nodeType==goog.dom.NodeType.TEXT){while(k>f.length){k-=f.length;do{f=f.nextSibling}while(i(f))}}if(j.nodeType==goog.dom.NodeType.TEXT){while(c>j.length){c-=j.length;do{j=j.nextSibling}while(i(j))}}goog.dom.Range.createFromNodes(f,(k),j,(c)).select()}};goog.dom.browserrange.W3cRange.prototype.collapse=function(a){this.range_.collapse(a)};goog.provide("goog.dom.browserrange.WebKitRange");goog.require("goog.dom.RangeEndpoint");goog.require("goog.dom.browserrange.W3cRange");goog.require("goog.userAgent");goog.dom.browserrange.WebKitRange=function(a){goog.dom.browserrange.W3cRange.call(this,a)};goog.inherits(goog.dom.browserrange.WebKitRange,goog.dom.browserrange.W3cRange);goog.dom.browserrange.WebKitRange.createFromNodeContents=function(a){return new goog.dom.browserrange.WebKitRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNode(a))};goog.dom.browserrange.WebKitRange.createFromNodes=function(d,b,a,c){return new goog.dom.browserrange.WebKitRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNodes(d,b,a,c))};goog.dom.browserrange.WebKitRange.prototype.compareBrowserRangeEndpoints=function(b,c,a){if(goog.userAgent.isVersion("528")){return(goog.dom.browserrange.WebKitRange.superClass_.compareBrowserRangeEndpoints.call(this,b,c,a))}return this.range_.compareBoundaryPoints(a==goog.dom.RangeEndpoint.START?(c==goog.dom.RangeEndpoint.START?goog.global.Range.START_TO_START:goog.global.Range.END_TO_START):(c==goog.dom.RangeEndpoint.START?goog.global.Range.START_TO_END:goog.global.Range.END_TO_END),(b))};goog.dom.browserrange.WebKitRange.prototype.selectInternal=function(a,b){a.removeAllRanges();if(b){a.setBaseAndExtent(this.getEndNode(),this.getEndOffset(),this.getStartNode(),this.getStartOffset())}else{a.setBaseAndExtent(this.getStartNode(),this.getStartOffset(),this.getEndNode(),this.getEndOffset())}};goog.provide("goog.dom.NodeIterator");goog.require("goog.dom.TagIterator");goog.dom.NodeIterator=function(d,a,c,b){goog.dom.TagIterator.call(this,d,a,c,null,b)};goog.inherits(goog.dom.NodeIterator,goog.dom.TagIterator);goog.dom.NodeIterator.prototype.next=function(){do{goog.dom.NodeIterator.superClass_.next.call(this)}while(this.isEndTag());return this.node};goog.provide("goog.dom.browserrange.IeRange");goog.require("goog.array");goog.require("goog.debug.Logger");goog.require("goog.dom");goog.require("goog.dom.NodeIterator");goog.require("goog.dom.NodeType");goog.require("goog.dom.RangeEndpoint");goog.require("goog.dom.TagName");goog.require("goog.dom.browserrange.AbstractRange");goog.require("goog.iter");goog.require("goog.iter.StopIteration");goog.require("goog.string");goog.dom.browserrange.IeRange=function(a,b){this.range_=a;this.doc_=b};goog.inherits(goog.dom.browserrange.IeRange,goog.dom.browserrange.AbstractRange);goog.dom.browserrange.IeRange.logger_=goog.debug.Logger.getLogger("goog.dom.browserrange.IeRange");goog.dom.browserrange.IeRange.getBrowserRangeForNode_=function(c){var e=goog.dom.getOwnerDocument(c).body.createTextRange();if(c.nodeType==goog.dom.NodeType.ELEMENT){e.moveToElementText(c);if(goog.dom.browserrange.canContainRangeEndpoint(c)&&!c.childNodes.length){e.collapse(false)}}else{var d=0;var b=c;while(b=b.previousSibling){var a=b.nodeType;if(a==goog.dom.NodeType.TEXT){d+=b.length}else{if(a==goog.dom.NodeType.ELEMENT){e.moveToElementText(b);break}}}if(!b){e.moveToElementText(c.parentNode)}e.collapse(!b);if(d){e.move("character",d)}e.moveEnd("character",c.length)}return e};goog.dom.browserrange.IeRange.getBrowserRangeForNodes_=function(d,b,a,c){var h,g=false;if(d.nodeType==goog.dom.NodeType.ELEMENT){if(b>d.childNodes.length){goog.dom.browserrange.IeRange.logger_.severe("Cannot have startOffset > startNode child count")}h=d.childNodes[b];g=!h;d=h||d.lastChild||d;b=0}var e=goog.dom.browserrange.IeRange.getBrowserRangeForNode_(d);if(b){e.move("character",b)}if(d==a&&b==c){e.collapse(true);return e}if(g){e.collapse(false)}g=false;if(a.nodeType==goog.dom.NodeType.ELEMENT){if(c>a.childNodes.length){goog.dom.browserrange.IeRange.logger_.severe("Cannot have endOffset > endNode child count")}h=a.childNodes[c];a=h||a.lastChild||a;c=0;g=!h}var f=goog.dom.browserrange.IeRange.getBrowserRangeForNode_(a);f.collapse(!g);if(c){f.moveEnd("character",c)}e.setEndPoint("EndToEnd",f);return e};goog.dom.browserrange.IeRange.createFromNodeContents=function(c){var b=new goog.dom.browserrange.IeRange(goog.dom.browserrange.IeRange.getBrowserRangeForNode_(c),goog.dom.getOwnerDocument(c));if(!goog.dom.browserrange.canContainRangeEndpoint(c)){b.startNode_=b.endNode_=b.parentNode_=c.parentNode;b.startOffset_=goog.array.indexOf(b.parentNode_.childNodes,c);b.endOffset_=b.startOffset_+1}else{var d,a=c;while((d=a.firstChild)&&goog.dom.browserrange.canContainRangeEndpoint(d)){a=d}b.startNode_=a;b.startOffset_=0;a=c;while((d=a.lastChild)&&goog.dom.browserrange.canContainRangeEndpoint(d)){a=d}b.endNode_=a;b.endOffset_=a.nodeType==goog.dom.NodeType.ELEMENT?a.childNodes.length:a.length;b.parentNode_=c}return b};goog.dom.browserrange.IeRange.createFromNodes=function(e,b,a,d){var c=new goog.dom.browserrange.IeRange(goog.dom.browserrange.IeRange.getBrowserRangeForNodes_(e,b,a,d),goog.dom.getOwnerDocument(e));c.startNode_=e;c.startOffset_=b;c.endNode_=a;c.endOffset_=d;return c};goog.dom.browserrange.IeRange.prototype.parentNode_=null;goog.dom.browserrange.IeRange.prototype.startNode_=null;goog.dom.browserrange.IeRange.prototype.endNode_=null;goog.dom.browserrange.IeRange.prototype.startOffset_=-1;goog.dom.browserrange.IeRange.prototype.endOffset_=-1;goog.dom.browserrange.IeRange.prototype.clone=function(){var a=new goog.dom.browserrange.IeRange(this.range_.duplicate(),this.doc_);a.parentNode_=this.parentNode_;a.startNode_=this.startNode_;a.endNode_=this.endNode_;return a};goog.dom.browserrange.IeRange.prototype.getBrowserRange=function(){return this.range_};goog.dom.browserrange.IeRange.prototype.clearCachedValues_=function(){this.parentNode_=this.startNode_=this.endNode_=null;this.startOffset_=this.endOffset_=-1};goog.dom.browserrange.IeRange.prototype.getContainer=function(){if(!this.parentNode_){var d=this.range_.text;var a=this.range_.duplicate();var c=d.replace(/ +$/,"");var f=d.length-c.length;if(f){a.moveEnd("character",-f)}var b=a.parentElement();var g=a.htmlText;var e=goog.string.stripNewlines(g).length;if(this.isCollapsed()&&e>0){return(this.parentNode_=b)}while(e>goog.string.stripNewlines(b.outerHTML).length){b=b.parentNode}while(b.childNodes.length==1&&b.innerText==goog.dom.browserrange.IeRange.getNodeText_(b.firstChild)){if(!goog.dom.browserrange.canContainRangeEndpoint(b.firstChild)){break}b=b.firstChild}if(d.length==0){b=this.findDeepestContainer_(b)}this.parentNode_=b}return this.parentNode_};goog.dom.browserrange.IeRange.prototype.findDeepestContainer_=function(d){var l=d.childNodes;for(var g=0,j=l.length;g<j;g++){var b=l[g];if(goog.dom.browserrange.canContainRangeEndpoint(b)){var e=goog.dom.browserrange.IeRange.getBrowserRangeForNode_(b);var a=goog.dom.RangeEndpoint.START;var f=goog.dom.RangeEndpoint.END;var h=(e.htmlText!=b.outerHTML);var k=this.isCollapsed()&&h;var c=k?(this.compareBrowserRangeEndpoints(e,a,a)>=0&&this.compareBrowserRangeEndpoints(e,a,f)<=0):this.range_.inRange(e);if(c){return this.findDeepestContainer_(b)}}}return d};goog.dom.browserrange.IeRange.prototype.getStartNode=function(){if(!this.startNode_){this.startNode_=this.getEndpointNode_(goog.dom.RangeEndpoint.START);if(this.isCollapsed()){this.endNode_=this.startNode_}}return this.startNode_};goog.dom.browserrange.IeRange.prototype.getStartOffset=function(){if(this.startOffset_<0){this.startOffset_=this.getOffset_(goog.dom.RangeEndpoint.START);if(this.isCollapsed()){this.endOffset_=this.startOffset_}}return this.startOffset_};goog.dom.browserrange.IeRange.prototype.getEndNode=function(){if(this.isCollapsed()){return this.getStartNode()}if(!this.endNode_){this.endNode_=this.getEndpointNode_(goog.dom.RangeEndpoint.END)}return this.endNode_};goog.dom.browserrange.IeRange.prototype.getEndOffset=function(){if(this.isCollapsed()){return this.getStartOffset()}if(this.endOffset_<0){this.endOffset_=this.getOffset_(goog.dom.RangeEndpoint.END);if(this.isCollapsed()){this.startOffset_=this.endOffset_}}return this.endOffset_};goog.dom.browserrange.IeRange.prototype.compareBrowserRangeEndpoints=function(b,c,a){return this.range_.compareEndPoints((c==goog.dom.RangeEndpoint.START?"Start":"End")+"To"+(a==goog.dom.RangeEndpoint.START?"Start":"End"),b)};goog.dom.browserrange.IeRange.prototype.getEndpointNode_=function(p,k){var g=k||this.getContainer();if(!g||!g.firstChild){return g}var b=goog.dom.RangeEndpoint.START,l=goog.dom.RangeEndpoint.END;var f=p==b;for(var m=0,d=g.childNodes.length;m<d;m++){var n=f?m:d-m-1;var c=g.childNodes[n];var h;try{h=goog.dom.browserrange.createRangeFromNodeContents(c)}catch(o){continue}var a=h.getBrowserRange();if(this.isCollapsed()){if(!goog.dom.browserrange.canContainRangeEndpoint(c)){if(this.compareBrowserRangeEndpoints(a,b,b)==0){this.startOffset_=this.endOffset_=n;return g}}else{if(h.containsRange(this)){return this.getEndpointNode_(p,c)}}}else{if(this.containsRange(h)){if(!goog.dom.browserrange.canContainRangeEndpoint(c)){if(f){this.startOffset_=n}else{this.endOffset_=n+1}return g}return this.getEndpointNode_(p,c)}else{if(this.compareBrowserRangeEndpoints(a,b,l)<0&&this.compareBrowserRangeEndpoints(a,l,b)>0){return this.getEndpointNode_(p,c)}}}}return g};goog.dom.browserrange.IeRange.prototype.compareNodeEndpoints_=function(c,b,a){return this.range_.compareEndPoints((b==goog.dom.RangeEndpoint.START?"Start":"End")+"To"+(a==goog.dom.RangeEndpoint.START?"Start":"End"),goog.dom.browserrange.createRangeFromNodeContents(c).getBrowserRange())};goog.dom.browserrange.IeRange.prototype.getOffset_=function(o,b){var f=o==goog.dom.RangeEndpoint.START;var c=b||(f?this.getStartNode():this.getEndNode());if(c.nodeType==goog.dom.NodeType.ELEMENT){var g=c.childNodes;var n=g.length;var e=f?0:n-1;var k=f?1:-1;for(var l=e;l>=0&&l<n;l+=k){var d=g[l];if(goog.dom.browserrange.canContainRangeEndpoint(d)){continue}var a=this.compareNodeEndpoints_(d,o,o);if(a==0){return f?l:l+1}}return l==-1?0:l}else{var m=this.range_.duplicate();var j=goog.dom.browserrange.IeRange.getBrowserRangeForNode_(c);m.setEndPoint(f?"EndToEnd":"StartToStart",j);var h=m.text.length;return f?c.length-h:h}};goog.dom.browserrange.IeRange.getNodeText_=function(a){return a.nodeType==goog.dom.NodeType.TEXT?a.nodeValue:a.innerText};goog.dom.browserrange.IeRange.prototype.isRangeInDocument=function(){var a=this.doc_.body.createTextRange();a.moveToElementText(this.doc_.body);return this.containsRange(new goog.dom.browserrange.IeRange(a,this.doc_),true)};goog.dom.browserrange.IeRange.prototype.isCollapsed=function(){return this.range_.compareEndPoints("StartToEnd",this.range_)==0};goog.dom.browserrange.IeRange.prototype.getText=function(){return this.range_.text};goog.dom.browserrange.IeRange.prototype.getValidHtml=function(){return this.range_.htmlText};goog.dom.browserrange.IeRange.prototype.select=function(a){this.range_.select()};goog.dom.browserrange.IeRange.prototype.removeContents=function(){if(!this.isCollapsed()&&this.range_.htmlText){var c=this.getStartNode();var b=this.getEndNode();var a=this.range_.text;var i=this.range_.duplicate();i.moveStart("character",1);i.moveStart("character",-1);if(i.text==a){this.range_=i}this.range_.text="";this.clearCachedValues_();var g=this.getStartNode();var h=this.getStartOffset();try{var d=c.nextSibling;if(c==b&&c.parentNode&&c.nodeType==goog.dom.NodeType.TEXT&&d&&d.nodeType==goog.dom.NodeType.TEXT){c.nodeValue+=d.nodeValue;goog.dom.removeNode(d);this.range_=goog.dom.browserrange.IeRange.getBrowserRangeForNode_(g);this.range_.move("character",h);this.clearCachedValues_()}}catch(f){}}};goog.dom.browserrange.IeRange.getDomHelper_=function(a){return goog.dom.getDomHelper(a.parentElement())};goog.dom.browserrange.IeRange.pasteElement_=function(b,d,c){c=c||goog.dom.browserrange.IeRange.getDomHelper_(b);var e;var a=e=d.id;if(!e){e=d.id=goog.string.createUniqueString()}b.pasteHTML(d.outerHTML);d=c.getElement(e);if(d){if(!a){d.removeAttribute("id")}}return d};goog.dom.browserrange.IeRange.prototype.surroundContents=function(a){goog.dom.removeNode(a);a.innerHTML=this.range_.htmlText;a=goog.dom.browserrange.IeRange.pasteElement_(this.range_,a);if(a){this.range_.moveToElementText(a)}this.clearCachedValues_();return a};goog.dom.browserrange.IeRange.insertNode_=function(f,d,e,b){b=b||goog.dom.browserrange.IeRange.getDomHelper_(f);var a;if(d.nodeType!=goog.dom.NodeType.ELEMENT){a=true;d=b.createDom(goog.dom.TagName.DIV,null,d)}f.collapse(e);d=goog.dom.browserrange.IeRange.pasteElement_(f,(d),b);if(a){var c=d.firstChild;b.flattenElement(d);d=c}return d};goog.dom.browserrange.IeRange.prototype.insertNode=function(b,c){var a=goog.dom.browserrange.IeRange.insertNode_(this.range_.duplicate(),b,c);this.clearCachedValues_();return a};goog.dom.browserrange.IeRange.prototype.surroundWithNodes=function(b,a){var d=this.range_.duplicate();var c=this.range_.duplicate();goog.dom.browserrange.IeRange.insertNode_(d,b,true);goog.dom.browserrange.IeRange.insertNode_(c,a,false);this.clearCachedValues_()};goog.dom.browserrange.IeRange.prototype.collapse=function(a){this.range_.collapse(a);if(a){this.endNode_=this.startNode_;this.endOffset_=this.startOffset_}else{this.startNode_=this.endNode_;this.startOffset_=this.endOffset_}};goog.provide("goog.dom.browserrange.GeckoRange");goog.require("goog.dom.browserrange.W3cRange");goog.dom.browserrange.GeckoRange=function(a){goog.dom.browserrange.W3cRange.call(this,a)};goog.inherits(goog.dom.browserrange.GeckoRange,goog.dom.browserrange.W3cRange);goog.dom.browserrange.GeckoRange.createFromNodeContents=function(a){return new goog.dom.browserrange.GeckoRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNode(a))};goog.dom.browserrange.GeckoRange.createFromNodes=function(d,b,a,c){return new goog.dom.browserrange.GeckoRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNodes(d,b,a,c))};goog.dom.browserrange.GeckoRange.prototype.selectInternal=function(c,f){var b=f?this.getEndNode():this.getStartNode();var d=f?this.getEndOffset():this.getStartOffset();var e=f?this.getStartNode():this.getEndNode();var a=f?this.getStartOffset():this.getEndOffset();c.collapse(b,d);if(b!=e||d!=a){c.extend(e,a)}};goog.provide("goog.dom.browserrange.OperaRange");goog.require("goog.dom.browserrange.W3cRange");goog.dom.browserrange.OperaRange=function(a){goog.dom.browserrange.W3cRange.call(this,a)};goog.inherits(goog.dom.browserrange.OperaRange,goog.dom.browserrange.W3cRange);goog.dom.browserrange.OperaRange.createFromNodeContents=function(a){return new goog.dom.browserrange.OperaRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNode(a))};goog.dom.browserrange.OperaRange.createFromNodes=function(d,b,a,c){return new goog.dom.browserrange.OperaRange(goog.dom.browserrange.W3cRange.getBrowserRangeForNodes(d,b,a,c))};goog.dom.browserrange.OperaRange.prototype.selectInternal=function(a,b){a.collapse(this.getStartNode(),this.getStartOffset());if(this.getEndNode()!=this.getStartNode()||this.getEndOffset()!=this.getStartOffset()){a.extend(this.getEndNode(),this.getEndOffset())}if(a.rangeCount==0){a.addRange(this.range_)}};goog.provide("goog.dom.browserrange");goog.provide("goog.dom.browserrange.Error");goog.require("goog.dom");goog.require("goog.dom.browserrange.GeckoRange");goog.require("goog.dom.browserrange.IeRange");goog.require("goog.dom.browserrange.OperaRange");goog.require("goog.dom.browserrange.W3cRange");goog.require("goog.dom.browserrange.WebKitRange");goog.require("goog.userAgent");goog.dom.browserrange.Error={NOT_IMPLEMENTED:"Not Implemented"};goog.dom.browserrange.createRange=function(a){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)){return new goog.dom.browserrange.IeRange((a),goog.dom.getOwnerDocument(a.parentElement()))}else{if(goog.userAgent.WEBKIT){return new goog.dom.browserrange.WebKitRange((a))}else{if(goog.userAgent.GECKO){return new goog.dom.browserrange.GeckoRange((a))}else{if(goog.userAgent.OPERA){return new goog.dom.browserrange.OperaRange((a))}else{return new goog.dom.browserrange.W3cRange((a))}}}}};goog.dom.browserrange.createRangeFromNodeContents=function(a){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)){return goog.dom.browserrange.IeRange.createFromNodeContents(a)}else{if(goog.userAgent.WEBKIT){return goog.dom.browserrange.WebKitRange.createFromNodeContents(a)}else{if(goog.userAgent.GECKO){return goog.dom.browserrange.GeckoRange.createFromNodeContents(a)}else{if(goog.userAgent.OPERA){return goog.dom.browserrange.OperaRange.createFromNodeContents(a)}else{return goog.dom.browserrange.W3cRange.createFromNodeContents(a)}}}}};goog.dom.browserrange.createRangeFromNodes=function(d,b,a,c){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)){return goog.dom.browserrange.IeRange.createFromNodes(d,b,a,c)}else{if(goog.userAgent.WEBKIT){return goog.dom.browserrange.WebKitRange.createFromNodes(d,b,a,c)}else{if(goog.userAgent.GECKO){return goog.dom.browserrange.GeckoRange.createFromNodes(d,b,a,c)}else{if(goog.userAgent.OPERA){return goog.dom.browserrange.OperaRange.createFromNodes(d,b,a,c)}else{return goog.dom.browserrange.W3cRange.createFromNodes(d,b,a,c)}}}}};goog.dom.browserrange.canContainRangeEndpoint=function(a){return goog.dom.canHaveChildren(a)||a.nodeType==goog.dom.NodeType.TEXT};goog.provide("goog.dom.TextRange");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.AbstractRange");goog.require("goog.dom.RangeType");goog.require("goog.dom.SavedRange");goog.require("goog.dom.TagName");goog.require("goog.dom.TextRangeIterator");goog.require("goog.dom.browserrange");goog.require("goog.string");goog.require("goog.userAgent");goog.dom.TextRange=function(){};goog.inherits(goog.dom.TextRange,goog.dom.AbstractRange);goog.dom.TextRange.createFromBrowserRange=function(a,b){return goog.dom.TextRange.createFromBrowserRangeWrapper_(goog.dom.browserrange.createRange(a),b)};goog.dom.TextRange.createFromBrowserRangeWrapper_=function(c,b){var a=new goog.dom.TextRange();a.browserRangeWrapper_=c;a.isReversed_=!!b;return a};goog.dom.TextRange.createFromNodeContents=function(b,a){return goog.dom.TextRange.createFromBrowserRangeWrapper_(goog.dom.browserrange.createRangeFromNodeContents(b),a)};goog.dom.TextRange.createFromNodes=function(c,e,f,a){var b=new goog.dom.TextRange();b.isReversed_=goog.dom.Range.isReversed(c,e,f,a);if(c.tagName=="BR"){var d=c.parentNode;e=goog.array.indexOf(d.childNodes,c);c=d}if(f.tagName=="BR"){var d=f.parentNode;a=goog.array.indexOf(d.childNodes,f);f=d}if(b.isReversed_){b.startNode_=f;b.startOffset_=a;b.endNode_=c;b.endOffset_=e}else{b.startNode_=c;b.startOffset_=e;b.endNode_=f;b.endOffset_=a}return b};goog.dom.TextRange.prototype.browserRangeWrapper_=null;goog.dom.TextRange.prototype.startNode_=null;goog.dom.TextRange.prototype.startOffset_=null;goog.dom.TextRange.prototype.endNode_=null;goog.dom.TextRange.prototype.endOffset_=null;goog.dom.TextRange.prototype.isReversed_=false;goog.dom.TextRange.prototype.clone=function(){var a=new goog.dom.TextRange();a.browserRangeWrapper_=this.browserRangeWrapper_;a.startNode_=this.startNode_;a.startOffset_=this.startOffset_;a.endNode_=this.endNode_;a.endOffset_=this.endOffset_;a.isReversed_=this.isReversed_;return a};goog.dom.TextRange.prototype.getType=function(){return goog.dom.RangeType.TEXT};goog.dom.TextRange.prototype.getBrowserRangeObject=function(){return this.getBrowserRangeWrapper_().getBrowserRange()};goog.dom.TextRange.prototype.setBrowserRangeObject=function(a){if(goog.dom.AbstractRange.isNativeControlRange(a)){return false}this.browserRangeWrapper_=goog.dom.browserrange.createRange(a);this.clearCachedValues_();return true};goog.dom.TextRange.prototype.clearCachedValues_=function(){this.startNode_=this.startOffset_=this.endNode_=this.endOffset_=null};goog.dom.TextRange.prototype.getTextRangeCount=function(){return 1};goog.dom.TextRange.prototype.getTextRange=function(a){return this};goog.dom.TextRange.prototype.getBrowserRangeWrapper_=function(){return this.browserRangeWrapper_||(this.browserRangeWrapper_=goog.dom.browserrange.createRangeFromNodes(this.getStartNode(),this.getStartOffset(),this.getEndNode(),this.getEndOffset()))};goog.dom.TextRange.prototype.getContainer=function(){return this.getBrowserRangeWrapper_().getContainer()};goog.dom.TextRange.prototype.getStartNode=function(){return this.startNode_||(this.startNode_=this.getBrowserRangeWrapper_().getStartNode())};goog.dom.TextRange.prototype.getStartOffset=function(){return this.startOffset_!=null?this.startOffset_:(this.startOffset_=this.getBrowserRangeWrapper_().getStartOffset())};goog.dom.TextRange.prototype.getEndNode=function(){return this.endNode_||(this.endNode_=this.getBrowserRangeWrapper_().getEndNode())};goog.dom.TextRange.prototype.getEndOffset=function(){return this.endOffset_!=null?this.endOffset_:(this.endOffset_=this.getBrowserRangeWrapper_().getEndOffset())};goog.dom.TextRange.prototype.moveToNodes=function(d,b,a,c,e){this.startNode_=d;this.startOffset_=b;this.endNode_=a;this.endOffset_=c;this.isReversed_=e;this.browserRangeWrapper_=null};goog.dom.TextRange.prototype.isReversed=function(){return this.isReversed_};goog.dom.TextRange.prototype.containsRange=function(e,d){var a=e.getType();if(a==goog.dom.RangeType.TEXT){return this.getBrowserRangeWrapper_().containsRange(e.getBrowserRangeWrapper_(),d)}else{if(a==goog.dom.RangeType.CONTROL){var c=e.getElements();var b=d?goog.array.some:goog.array.every;return b(c,function(f){return this.containsNode(f,d)},this)}}return false};goog.dom.TextRange.isAttachedNode=function(b){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)){var a=false;try{a=b.parentNode}catch(c){}return !!a}else{return goog.dom.contains(b.ownerDocument.body,b)}};goog.dom.TextRange.prototype.isRangeInDocument=function(){return(!this.startNode_||goog.dom.TextRange.isAttachedNode(this.startNode_))&&(!this.endNode_||goog.dom.TextRange.isAttachedNode(this.endNode_))&&(!(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9))||this.getBrowserRangeWrapper_().isRangeInDocument())};goog.dom.TextRange.prototype.isCollapsed=function(){return this.getBrowserRangeWrapper_().isCollapsed()};goog.dom.TextRange.prototype.getText=function(){return this.getBrowserRangeWrapper_().getText()};goog.dom.TextRange.prototype.getHtmlFragment=function(){return this.getBrowserRangeWrapper_().getHtmlFragment()};goog.dom.TextRange.prototype.getValidHtml=function(){return this.getBrowserRangeWrapper_().getValidHtml()};goog.dom.TextRange.prototype.getPastableHtml=function(){var b=this.getValidHtml();if(b.match(/^\s*<td\b/i)){b="<table><tbody><tr>"+b+"</tr></tbody></table>"}else{if(b.match(/^\s*<tr\b/i)){b="<table><tbody>"+b+"</tbody></table>"}else{if(b.match(/^\s*<tbody\b/i)){b="<table>"+b+"</table>"}else{if(b.match(/^\s*<li\b/i)){var a=this.getContainer();var c=goog.dom.TagName.UL;while(a){if(a.tagName==goog.dom.TagName.OL){c=goog.dom.TagName.OL;break}else{if(a.tagName==goog.dom.TagName.UL){break}}a=a.parentNode}b=goog.string.buildString("<",c,">",b,"</",c,">")}}}}return b};goog.dom.TextRange.prototype.__iterator__=function(a){return new goog.dom.TextRangeIterator(this.getStartNode(),this.getStartOffset(),this.getEndNode(),this.getEndOffset())};goog.dom.TextRange.prototype.select=function(){this.getBrowserRangeWrapper_().select(this.isReversed_)};goog.dom.TextRange.prototype.removeContents=function(){this.getBrowserRangeWrapper_().removeContents();this.clearCachedValues_()};goog.dom.TextRange.prototype.surroundContents=function(b){var a=this.getBrowserRangeWrapper_().surroundContents(b);this.clearCachedValues_();return a};goog.dom.TextRange.prototype.insertNode=function(b,c){var a=this.getBrowserRangeWrapper_().insertNode(b,c);this.clearCachedValues_();return a};goog.dom.TextRange.prototype.surroundWithNodes=function(b,a){this.getBrowserRangeWrapper_().surroundWithNodes(b,a);this.clearCachedValues_()};goog.dom.TextRange.prototype.saveUsingDom=function(){return new goog.dom.DomSavedTextRange_(this)};goog.dom.TextRange.prototype.collapse=function(b){var a=this.isReversed()?!b:b;if(this.browserRangeWrapper_){this.browserRangeWrapper_.collapse(a)}if(a){this.endNode_=this.startNode_;this.endOffset_=this.startOffset_}else{this.startNode_=this.endNode_;this.startOffset_=this.endOffset_}this.isReversed_=false};goog.dom.DomSavedTextRange_=function(a){this.anchorNode_=a.getAnchorNode();this.anchorOffset_=a.getAnchorOffset();this.focusNode_=a.getFocusNode();this.focusOffset_=a.getFocusOffset()};goog.inherits(goog.dom.DomSavedTextRange_,goog.dom.SavedRange);goog.dom.DomSavedTextRange_.prototype.restoreInternal=function(){return goog.dom.Range.createFromNodes(this.anchorNode_,this.anchorOffset_,this.focusNode_,this.focusOffset_)};goog.dom.DomSavedTextRange_.prototype.disposeInternal=function(){goog.dom.DomSavedTextRange_.superClass_.disposeInternal.call(this);this.anchorNode_=null;this.focusNode_=null};goog.provide("goog.dom.ControlRange");goog.provide("goog.dom.ControlRangeIterator");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.AbstractMultiRange");goog.require("goog.dom.AbstractRange");goog.require("goog.dom.RangeIterator");goog.require("goog.dom.RangeType");goog.require("goog.dom.SavedRange");goog.require("goog.dom.TagWalkType");goog.require("goog.dom.TextRange");goog.require("goog.iter.StopIteration");goog.require("goog.userAgent");goog.dom.ControlRange=function(){};goog.inherits(goog.dom.ControlRange,goog.dom.AbstractMultiRange);goog.dom.ControlRange.createFromBrowserRange=function(b){var a=new goog.dom.ControlRange();a.range_=b;return a};goog.dom.ControlRange.createFromElements=function(d){var b=goog.dom.getOwnerDocument(arguments[0]).body.createControlRange();for(var c=0,a=arguments.length;c<a;c++){b.addElement(arguments[c])}return goog.dom.ControlRange.createFromBrowserRange(b)};goog.dom.ControlRange.prototype.range_=null;goog.dom.ControlRange.prototype.elements_=null;goog.dom.ControlRange.prototype.sortedElements_=null;goog.dom.ControlRange.prototype.clearCachedValues_=function(){this.elements_=null;this.sortedElements_=null};goog.dom.ControlRange.prototype.clone=function(){return goog.dom.ControlRange.createFromElements.apply(this,this.getElements())};goog.dom.ControlRange.prototype.getType=function(){return goog.dom.RangeType.CONTROL};goog.dom.ControlRange.prototype.getBrowserRangeObject=function(){return this.range_||document.body.createControlRange()};goog.dom.ControlRange.prototype.setBrowserRangeObject=function(a){if(!goog.dom.AbstractRange.isNativeControlRange(a)){return false}this.range_=a;return true};goog.dom.ControlRange.prototype.getTextRangeCount=function(){return this.range_?this.range_.length:0};goog.dom.ControlRange.prototype.getTextRange=function(a){return goog.dom.TextRange.createFromNodeContents(this.range_.item(a))};goog.dom.ControlRange.prototype.getContainer=function(){return goog.dom.findCommonAncestor.apply(null,this.getElements())};goog.dom.ControlRange.prototype.getStartNode=function(){return this.getSortedElements()[0]};goog.dom.ControlRange.prototype.getStartOffset=function(){return 0};goog.dom.ControlRange.prototype.getEndNode=function(){var b=this.getSortedElements();var a=(goog.array.peek(b));return(goog.array.find(b,function(c){return goog.dom.contains(c,a)}))};goog.dom.ControlRange.prototype.getEndOffset=function(){return this.getEndNode().childNodes.length};goog.dom.ControlRange.prototype.getElements=function(){if(!this.elements_){this.elements_=[];if(this.range_){for(var a=0;a<this.range_.length;a++){this.elements_.push(this.range_.item(a))}}}return this.elements_};goog.dom.ControlRange.prototype.getSortedElements=function(){if(!this.sortedElements_){this.sortedElements_=this.getElements().concat();this.sortedElements_.sort(function(d,c){return d.sourceIndex-c.sourceIndex})}return this.sortedElements_};goog.dom.ControlRange.prototype.isRangeInDocument=function(){var a=false;try{a=goog.array.every(this.getElements(),function(c){return goog.userAgent.IE?c.parentNode:goog.dom.contains(c.ownerDocument.body,c)})}catch(b){}return a};goog.dom.ControlRange.prototype.isCollapsed=function(){return !this.range_||!this.range_.length};goog.dom.ControlRange.prototype.getText=function(){return""};goog.dom.ControlRange.prototype.getHtmlFragment=function(){return goog.array.map(this.getSortedElements(),goog.dom.getOuterHtml).join("")};goog.dom.ControlRange.prototype.getValidHtml=function(){return this.getHtmlFragment()};goog.dom.ControlRange.prototype.getPastableHtml=goog.dom.ControlRange.prototype.getValidHtml;goog.dom.ControlRange.prototype.__iterator__=function(a){return new goog.dom.ControlRangeIterator(this)};goog.dom.ControlRange.prototype.select=function(){if(this.range_){this.range_.select()}};goog.dom.ControlRange.prototype.removeContents=function(){if(this.range_){var b=[];for(var c=0,a=this.range_.length;c<a;c++){b.push(this.range_.item(c))}goog.array.forEach(b,goog.dom.removeNode);this.collapse(false)}};goog.dom.ControlRange.prototype.replaceContentsWithNode=function(b){var a=this.insertNode(b,true);if(!this.isCollapsed()){this.removeContents()}return a};goog.dom.ControlRange.prototype.saveUsingDom=function(){return new goog.dom.DomSavedControlRange_(this)};goog.dom.ControlRange.prototype.collapse=function(a){this.range_=null;this.clearCachedValues_()};goog.dom.DomSavedControlRange_=function(a){this.elements_=a.getElements()};goog.inherits(goog.dom.DomSavedControlRange_,goog.dom.SavedRange);goog.dom.DomSavedControlRange_.prototype.restoreInternal=function(){var d=this.elements_.length?goog.dom.getOwnerDocument(this.elements_[0]):document;var c=d.body.createControlRange();for(var b=0,a=this.elements_.length;b<a;b++){c.addElement(this.elements_[b])}return goog.dom.ControlRange.createFromBrowserRange(c)};goog.dom.DomSavedControlRange_.prototype.disposeInternal=function(){goog.dom.DomSavedControlRange_.superClass_.disposeInternal.call(this);delete this.elements_};goog.dom.ControlRangeIterator=function(a){if(a){this.elements_=a.getSortedElements();this.startNode_=this.elements_.shift();this.endNode_=(goog.array.peek(this.elements_))||this.startNode_}goog.dom.RangeIterator.call(this,this.startNode_,false)};goog.inherits(goog.dom.ControlRangeIterator,goog.dom.RangeIterator);goog.dom.ControlRangeIterator.prototype.startNode_=null;goog.dom.ControlRangeIterator.prototype.endNode_=null;goog.dom.ControlRangeIterator.prototype.elements_=null;goog.dom.ControlRangeIterator.prototype.getStartTextOffset=function(){return 0};goog.dom.ControlRangeIterator.prototype.getEndTextOffset=function(){return 0};goog.dom.ControlRangeIterator.prototype.getStartNode=function(){return this.startNode_};goog.dom.ControlRangeIterator.prototype.getEndNode=function(){return this.endNode_};goog.dom.ControlRangeIterator.prototype.isLast=function(){return !this.depth&&!this.elements_.length};goog.dom.ControlRangeIterator.prototype.next=function(){if(this.isLast()){throw goog.iter.StopIteration}else{if(!this.depth){var a=this.elements_.shift();this.setPosition(a,goog.dom.TagWalkType.START_TAG,goog.dom.TagWalkType.START_TAG);return a}}return goog.dom.ControlRangeIterator.superClass_.next.call(this)};goog.dom.ControlRangeIterator.prototype.copyFrom=function(a){this.elements_=a.elements_;this.startNode_=a.startNode_;this.endNode_=a.endNode_;goog.dom.ControlRangeIterator.superClass_.copyFrom.call(this,a)};goog.dom.ControlRangeIterator.prototype.clone=function(){var a=new goog.dom.ControlRangeIterator(null);a.copyFrom(this);return a};goog.provide("goog.dom.MultiRange");goog.provide("goog.dom.MultiRangeIterator");goog.require("goog.array");goog.require("goog.debug.Logger");goog.require("goog.dom.AbstractMultiRange");goog.require("goog.dom.AbstractRange");goog.require("goog.dom.RangeIterator");goog.require("goog.dom.RangeType");goog.require("goog.dom.SavedRange");goog.require("goog.dom.TextRange");goog.require("goog.iter.StopIteration");goog.dom.MultiRange=function(){this.browserRanges_=[];this.ranges_=[];this.sortedRanges_=null;this.container_=null};goog.inherits(goog.dom.MultiRange,goog.dom.AbstractMultiRange);goog.dom.MultiRange.createFromBrowserSelection=function(d){var b=new goog.dom.MultiRange();for(var c=0,a=d.rangeCount;c<a;c++){b.browserRanges_.push(d.getRangeAt(c))}return b};goog.dom.MultiRange.createFromBrowserRanges=function(b){var a=new goog.dom.MultiRange();a.browserRanges_=goog.array.clone(b);return a};goog.dom.MultiRange.createFromTextRanges=function(b){var a=new goog.dom.MultiRange();a.ranges_=b;a.browserRanges_=goog.array.map(b,function(c){return c.getBrowserRangeObject()});return a};goog.dom.MultiRange.prototype.logger_=goog.debug.Logger.getLogger("goog.dom.MultiRange");goog.dom.MultiRange.prototype.clearCachedValues_=function(){this.ranges_=[];this.sortedRanges_=null;this.container_=null};goog.dom.MultiRange.prototype.clone=function(){return goog.dom.MultiRange.createFromBrowserRanges(this.browserRanges_)};goog.dom.MultiRange.prototype.getType=function(){return goog.dom.RangeType.MULTI};goog.dom.MultiRange.prototype.getBrowserRangeObject=function(){if(this.browserRanges_.length>1){this.logger_.warning("getBrowserRangeObject called on MultiRange with more than 1 range")}return this.browserRanges_[0]};goog.dom.MultiRange.prototype.setBrowserRangeObject=function(a){return false};goog.dom.MultiRange.prototype.getTextRangeCount=function(){return this.browserRanges_.length};goog.dom.MultiRange.prototype.getTextRange=function(a){if(!this.ranges_[a]){this.ranges_[a]=goog.dom.TextRange.createFromBrowserRange(this.browserRanges_[a])}return this.ranges_[a]};goog.dom.MultiRange.prototype.getContainer=function(){if(!this.container_){var b=[];for(var c=0,a=this.getTextRangeCount();c<a;c++){b.push(this.getTextRange(c).getContainer())}this.container_=goog.dom.findCommonAncestor.apply(null,b)}return this.container_};goog.dom.MultiRange.prototype.getSortedRanges=function(){if(!this.sortedRanges_){this.sortedRanges_=this.getTextRanges();this.sortedRanges_.sort(function(d,c){var f=d.getStartNode();var g=d.getStartOffset();var e=c.getStartNode();var h=c.getStartOffset();if(f==e&&g==h){return 0}return goog.dom.Range.isReversed(f,g,e,h)?1:-1})}return this.sortedRanges_};goog.dom.MultiRange.prototype.getStartNode=function(){return this.getSortedRanges()[0].getStartNode()};goog.dom.MultiRange.prototype.getStartOffset=function(){return this.getSortedRanges()[0].getStartOffset()};goog.dom.MultiRange.prototype.getEndNode=function(){return goog.array.peek(this.getSortedRanges()).getEndNode()};goog.dom.MultiRange.prototype.getEndOffset=function(){return goog.array.peek(this.getSortedRanges()).getEndOffset()};goog.dom.MultiRange.prototype.isRangeInDocument=function(){return goog.array.every(this.getTextRanges(),function(a){return a.isRangeInDocument()})};goog.dom.MultiRange.prototype.isCollapsed=function(){return this.browserRanges_.length==0||this.browserRanges_.length==1&&this.getTextRange(0).isCollapsed()};goog.dom.MultiRange.prototype.getText=function(){return goog.array.map(this.getTextRanges(),function(a){return a.getText()}).join("")};goog.dom.MultiRange.prototype.getHtmlFragment=function(){return this.getValidHtml()};goog.dom.MultiRange.prototype.getValidHtml=function(){return goog.array.map(this.getTextRanges(),function(a){return a.getValidHtml()}).join("")};goog.dom.MultiRange.prototype.getPastableHtml=function(){return this.getValidHtml()};goog.dom.MultiRange.prototype.__iterator__=function(a){return new goog.dom.MultiRangeIterator(this)};goog.dom.MultiRange.prototype.select=function(){var c=goog.dom.AbstractRange.getBrowserSelectionForWindow(this.getWindow());c.removeAllRanges();for(var b=0,a=this.getTextRangeCount();b<a;b++){c.addRange(this.getTextRange(b).getBrowserRangeObject())}};goog.dom.MultiRange.prototype.removeContents=function(){goog.array.forEach(this.getTextRanges(),function(a){a.removeContents()})};goog.dom.MultiRange.prototype.saveUsingDom=function(){return new goog.dom.DomSavedMultiRange_(this)};goog.dom.MultiRange.prototype.collapse=function(b){if(!this.isCollapsed()){var a=b?this.getTextRange(0):this.getTextRange(this.getTextRangeCount()-1);this.clearCachedValues_();a.collapse(b);this.ranges_=[a];this.sortedRanges_=[a];this.browserRanges_=[a.getBrowserRangeObject()]}};goog.dom.DomSavedMultiRange_=function(a){this.savedRanges_=goog.array.map(a.getTextRanges(),function(b){return b.saveUsingDom()})};goog.inherits(goog.dom.DomSavedMultiRange_,goog.dom.SavedRange);goog.dom.DomSavedMultiRange_.prototype.restoreInternal=function(){var a=goog.array.map(this.savedRanges_,function(b){return b.restore()});return goog.dom.MultiRange.createFromTextRanges(a)};goog.dom.DomSavedMultiRange_.prototype.disposeInternal=function(){goog.dom.DomSavedMultiRange_.superClass_.disposeInternal.call(this);goog.array.forEach(this.savedRanges_,function(a){a.dispose()});delete this.savedRanges_};goog.dom.MultiRangeIterator=function(a){if(a){this.iterators_=goog.array.map(a.getSortedRanges(),function(b){return goog.iter.toIterator(b)})}goog.dom.RangeIterator.call(this,a?this.getStartNode():null,false)};goog.inherits(goog.dom.MultiRangeIterator,goog.dom.RangeIterator);goog.dom.MultiRangeIterator.prototype.iterators_=null;goog.dom.MultiRangeIterator.prototype.currentIdx_=0;goog.dom.MultiRangeIterator.prototype.getStartTextOffset=function(){return this.iterators_[this.currentIdx_].getStartTextOffset()};goog.dom.MultiRangeIterator.prototype.getEndTextOffset=function(){return this.iterators_[this.currentIdx_].getEndTextOffset()};goog.dom.MultiRangeIterator.prototype.getStartNode=function(){return this.iterators_[0].getStartNode()};goog.dom.MultiRangeIterator.prototype.getEndNode=function(){return goog.array.peek(this.iterators_).getEndNode()};goog.dom.MultiRangeIterator.prototype.isLast=function(){return this.iterators_[this.currentIdx_].isLast()};goog.dom.MultiRangeIterator.prototype.next=function(){try{var c=this.iterators_[this.currentIdx_];var b=c.next();this.setPosition(c.node,c.tagType,c.depth);return b}catch(a){if(a!==goog.iter.StopIteration||this.iterators_.length-1==this.currentIdx_){throw a}else{this.currentIdx_++;return this.next()}}};goog.dom.MultiRangeIterator.prototype.copyFrom=function(a){this.iterators_=goog.array.clone(a.iterators_);goog.dom.MultiRangeIterator.superClass_.copyFrom.call(this,a)};goog.dom.MultiRangeIterator.prototype.clone=function(){var a=new goog.dom.MultiRangeIterator(null);a.copyFrom(this);return a};goog.provide("goog.dom.Range");goog.require("goog.dom");goog.require("goog.dom.AbstractRange");goog.require("goog.dom.ControlRange");goog.require("goog.dom.MultiRange");goog.require("goog.dom.NodeType");goog.require("goog.dom.TextRange");goog.require("goog.userAgent");goog.dom.Range.createFromWindow=function(b){var a=goog.dom.AbstractRange.getBrowserSelectionForWindow(b||window);return a&&goog.dom.Range.createFromBrowserSelection(a)};goog.dom.Range.createFromBrowserSelection=function(b){var a;var c=false;if(b.createRange){try{a=b.createRange()}catch(d){return null}}else{if(b.rangeCount){if(b.rangeCount>1){return goog.dom.MultiRange.createFromBrowserSelection((b))}else{a=b.getRangeAt(0);c=goog.dom.Range.isReversed(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset)}}else{return null}}return goog.dom.Range.createFromBrowserRange(a,c)};goog.dom.Range.createFromBrowserRange=function(a,b){return goog.dom.AbstractRange.isNativeControlRange(a)?goog.dom.ControlRange.createFromBrowserRange(a):goog.dom.TextRange.createFromBrowserRange(a,b)};goog.dom.Range.createFromNodeContents=function(b,a){return goog.dom.TextRange.createFromNodeContents(b,a)};goog.dom.Range.createCaret=function(a,b){return goog.dom.TextRange.createFromNodes(a,b,a,b)};goog.dom.Range.createFromNodes=function(d,b,a,c){return goog.dom.TextRange.createFromNodes(d,b,a,c)};goog.dom.Range.clearSelection=function(b){var a=goog.dom.AbstractRange.getBrowserSelectionForWindow(b||window);if(!a){return}if(a.empty){try{a.empty()}catch(c){}}else{try{a.removeAllRanges()}catch(c){}}};goog.dom.Range.hasSelection=function(b){var a=goog.dom.AbstractRange.getBrowserSelectionForWindow(b||window);return !!a&&(goog.userAgent.IE?a.type!="None":!!a.rangeCount)};goog.dom.Range.isReversed=function(b,c,d,a){if(b==d){return a<c}var e;if(b.nodeType==goog.dom.NodeType.ELEMENT&&c){e=b.childNodes[c];if(e){b=e;c=0}else{if(goog.dom.contains(b,d)){return true}}}if(d.nodeType==goog.dom.NodeType.ELEMENT&&a){e=d.childNodes[a];if(e){d=e;a=0}else{if(goog.dom.contains(d,b)){return false}}}return(goog.dom.compareNodeOrder(b,d)||c-a)>0};goog.provide("goog.editor.range");goog.provide("goog.editor.range.Point");goog.require("goog.array");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.Range");goog.require("goog.dom.RangeEndpoint");goog.require("goog.dom.SavedCaretRange");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.node");goog.require("goog.editor.style");goog.require("goog.iter");goog.editor.range.narrow=function(c,d){var f=c.getStartNode();var h=c.getEndNode();if(f&&h){var e=function(i){return i==d};var g=goog.dom.getAncestor(f,e,true);var a=goog.dom.getAncestor(h,e,true);if(g&&a){return c.clone()}else{if(g){var b=goog.editor.node.getRightMostLeaf(d);return goog.dom.Range.createFromNodes(c.getStartNode(),c.getStartOffset(),b,goog.editor.node.getLength(b))}else{if(a){return goog.dom.Range.createFromNodes(goog.editor.node.getLeftMostLeaf(d),0,c.getEndNode(),c.getEndOffset())}}}}return null};goog.editor.range.expand=function(d,h){var g=goog.editor.range.expandEndPointToContainer_(d,goog.dom.RangeEndpoint.START,h);g=goog.editor.range.expandEndPointToContainer_(g,goog.dom.RangeEndpoint.END,h);var f=g.getStartNode();var c=g.getEndNode();var b=g.getStartOffset();var e=g.getEndOffset();if(f==c){while(c!=h&&b==0&&e==goog.editor.node.getLength(c)){var a=c.parentNode;b=goog.array.indexOf(a.childNodes,c);e=b+1;c=a}f=c}return goog.dom.Range.createFromNodes(f,b,c,e)};goog.editor.range.expandEndPointToContainer_=function(e,h,i){var a=h==goog.dom.RangeEndpoint.START;var c=a?e.getStartNode():e.getEndNode();var d=a?e.getStartOffset():e.getEndOffset();var b=e.getContainerElement();while(c!=b&&c!=i){if(a&&d!=0||!a&&d!=goog.editor.node.getLength(c)){break}var f=c.parentNode;var g=goog.array.indexOf(f.childNodes,c);d=a?g:g+1;c=f}return goog.dom.Range.createFromNodes(a?c:e.getStartNode(),a?d:e.getStartOffset(),a?e.getEndNode():c,a?e.getEndOffset():d)};goog.editor.range.selectNodeStart=function(a){goog.dom.Range.createCaret(goog.editor.node.getLeftMostLeaf(a),0).select()};goog.editor.range.placeCursorNextTo=function(e,f){var d=e.parentNode;var g=goog.array.indexOf(d.childNodes,e)+(f?0:1);var a=goog.editor.range.Point.createDeepestPoint(d,g,f);if(goog.userAgent.IE&&goog.userAgent.isVersion("9")&&a.node.nodeType==goog.dom.NodeType.ELEMENT&&a.node.tagName==goog.dom.TagName.HR){var c=a.node;a.node=c.parentNode;a.offset=goog.array.indexOf(a.node.childNodes,c)+(f?0:1)}var b=goog.dom.Range.createCaret(a.node,a.offset);b.select();return b};goog.editor.range.selectionPreservingNormalize=function(c){var d=goog.dom.getOwnerDocument(c);var b=goog.dom.Range.createFromWindow(goog.dom.getWindow(d));var a=goog.editor.range.rangePreservingNormalize(c,b);if(a){a.select()}};goog.editor.range.normalizeNodeIe_=function(b){var c=null;var d=b.firstChild;while(d){var a=d.nextSibling;if(d.nodeType==goog.dom.NodeType.TEXT){if(d.nodeValue==""){b.removeChild(d)}else{if(c){c.nodeValue+=d.nodeValue;b.removeChild(d)}else{c=d}}}else{goog.editor.range.normalizeNodeIe_(d);c=null}d=a}};goog.editor.range.normalizeNode=function(a){if(goog.userAgent.IE){goog.editor.range.normalizeNodeIe_(a)}else{a.normalize()}};goog.editor.range.rangePreservingNormalize=function(d,b){if(b){var c=goog.editor.range.normalize(b);var a=goog.editor.style.getContainer(b.getContainerElement())}if(a){goog.editor.range.normalizeNode(goog.dom.findCommonAncestor(a,d))}else{if(d){goog.editor.range.normalizeNode(d)}}if(c){return c()}else{return null}};goog.editor.range.getDeepEndPoint=function(b,a){return a?goog.editor.range.Point.createDeepestPoint(b.getStartNode(),b.getStartOffset()):goog.editor.range.Point.createDeepestPoint(b.getEndNode(),b.getEndOffset())};goog.editor.range.normalize=function(b){var e=goog.editor.range.normalizePoint_(goog.editor.range.getDeepEndPoint(b,true));var f=e.getParentPoint();var c=e.node.previousSibling;if(e.node.nodeType==goog.dom.NodeType.TEXT){e.node=null}var d=goog.editor.range.normalizePoint_(goog.editor.range.getDeepEndPoint(b,false));var g=d.getParentPoint();var a=d.node.previousSibling;if(d.node.nodeType==goog.dom.NodeType.TEXT){d.node=null}return function(){if(!e.node&&c){e.node=c.nextSibling;if(!e.node){e=goog.editor.range.Point.getPointAtEndOfNode(c)}}if(!d.node&&a){d.node=a.nextSibling;if(!d.node){d=goog.editor.range.Point.getPointAtEndOfNode(a)}}return goog.dom.Range.createFromNodes(e.node||f.node.firstChild||f.node,e.offset,d.node||g.node.firstChild||g.node,d.offset)}};goog.editor.range.normalizePoint_=function(a){var c;if(a.node.nodeType==goog.dom.NodeType.TEXT){for(var d=a.node.previousSibling;d&&d.nodeType==goog.dom.NodeType.TEXT;d=d.previousSibling){a.offset+=goog.editor.node.getLength(d)}c=d}else{c=a.node.previousSibling}var b=a.node.parentNode;a.node=c?c.nextSibling:b.firstChild;return a};goog.editor.range.isEditable=function(b){var c=b.getContainerElement();var a=b.getStartNode()!=c.parentElement;return(a&&goog.editor.node.isEditableContainer(c))||goog.editor.node.isEditable(c)};goog.editor.range.intersectsTag=function(a,b){if(goog.dom.getAncestorByTagNameAndClass(a.getContainerElement(),b)){return true}return goog.iter.some(a,function(c){return c.tagName==b})};goog.editor.range.Point=function(a,b){this.node=a;this.offset=b};goog.editor.range.Point.prototype.getParentPoint=function(){var a=this.node.parentNode;return new goog.editor.range.Point(a,goog.array.indexOf(a.childNodes,this.node))};goog.editor.range.Point.createDeepestPoint=function(b,c,e){while(b.nodeType==goog.dom.NodeType.ELEMENT){var d=b.childNodes[c];if(!d&&!b.lastChild){break}if(d){var a=d.previousSibling;if(e&&a){b=a;c=goog.editor.node.getLength(b)}else{b=d;c=0}}else{b=b.lastChild;c=goog.editor.node.getLength(b)}}return new goog.editor.range.Point(b,c)};goog.editor.range.Point.getPointAtEndOfNode=function(a){return new goog.editor.range.Point(a,goog.editor.node.getLength(a))};goog.editor.range.saveUsingNormalizedCarets=function(a){return new goog.editor.range.NormalizedCaretRange_(a)};goog.editor.range.NormalizedCaretRange_=function(a){goog.dom.SavedCaretRange.call(this,a)};goog.inherits(goog.editor.range.NormalizedCaretRange_,goog.dom.SavedCaretRange);goog.editor.range.NormalizedCaretRange_.prototype.removeCarets=function(d){var b=this.getCaret(true);var a=this.getCaret(false);var c=b&&a?goog.dom.findCommonAncestor(b,a):b||a;goog.editor.range.NormalizedCaretRange_.superClass_.removeCarets.call(this);if(d){return goog.editor.range.rangePreservingNormalize(c,d)}else{if(c){goog.editor.range.selectionPreservingNormalize(c)}}};goog.provide("goog.reflect");goog.reflect.object=function(b,a){return a};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(b,c){try{goog.reflect.sinkValue(b[c]);return true}catch(a){}return false};goog.provide("goog.functions");goog.functions.constant=function(a){return function(){return a}};goog.functions.FALSE=goog.functions.constant(false);goog.functions.TRUE=goog.functions.constant(true);goog.functions.NULL=goog.functions.constant(null);goog.functions.identity=function(b,a){return b};goog.functions.error=function(a){return function(){throw Error(a)}};goog.functions.lock=function(a){return function(){return a.call(this)}};goog.functions.withReturnValue=function(a,b){return goog.functions.sequence(a,goog.functions.constant(b))};goog.functions.compose=function(c){var b=arguments;var a=b.length;return function(){var d;if(a){d=b[a-1].apply(this,arguments)}for(var e=a-2;e>=0;e--){d=b[e].call(this,d)}return d}};goog.functions.sequence=function(c){var b=arguments;var a=b.length;return function(){var d;for(var e=0;e<a;e++){d=b[e].apply(this,arguments)}return d}};goog.functions.and=function(c){var b=arguments;var a=b.length;return function(){for(var d=0;d<a;d++){if(!b[d].apply(this,arguments)){return false}}return true}};goog.functions.or=function(c){var b=arguments;var a=b.length;return function(){for(var d=0;d<a;d++){if(b[d].apply(this,arguments)){return true}}return false}};goog.functions.not=function(a){return function(){return !a.apply(this,arguments)}};goog.functions.create=function(b,d){var a=function(){};a.prototype=b.prototype;var c=new a();b.apply(c,Array.prototype.slice.call(arguments,1));return c};goog.provide("goog.editor.Command");goog.editor.Command={UNDO:"+undo",REDO:"+redo",LINK:"+link",FORMAT_BLOCK:"+formatBlock",INDENT:"+indent",OUTDENT:"+outdent",REMOVE_FORMAT:"+removeFormat",STRIKE_THROUGH:"+strikeThrough",HORIZONTAL_RULE:"+insertHorizontalRule",SUBSCRIPT:"+subscript",SUPERSCRIPT:"+superscript",UNDERLINE:"+underline",BOLD:"+bold",ITALIC:"+italic",FONT_SIZE:"+fontSize",FONT_FACE:"+fontName",FONT_COLOR:"+foreColor",EMOTICON:"+emoticon",EQUATION:"+equation",BACKGROUND_COLOR:"+backColor",ORDERED_LIST:"+insertOrderedList",UNORDERED_LIST:"+insertUnorderedList",TABLE:"+table",JUSTIFY_CENTER:"+justifyCenter",JUSTIFY_FULL:"+justifyFull",JUSTIFY_RIGHT:"+justifyRight",JUSTIFY_LEFT:"+justifyLeft",BLOCKQUOTE:"+BLOCKQUOTE",DIR_LTR:"ltr",DIR_RTL:"rtl",IMAGE:"image",EDIT_HTML:"editHtml",UPDATE_LINK_BUBBLE:"updateLinkBubble",DEFAULT_TAG:"+defaultTag",CLEAR_LOREM:"clearlorem",UPDATE_LOREM:"updatelorem",USING_LOREM:"usinglorem",MODAL_LINK_EDITOR:"link"};goog.provide("goog.debug.errorHandlerWeakDep");goog.debug.errorHandlerWeakDep={protectEntryPoint:function(b,a){return b}};goog.provide("goog.events.Listener");goog.events.Listener=function(){if(goog.events.Listener.ENABLE_MONITORING){this.creationStack=new Error().stack}};goog.events.Listener.counter_=0;goog.events.Listener.ENABLE_MONITORING=false;goog.events.Listener.prototype.isFunctionListener_;goog.events.Listener.prototype.listener;goog.events.Listener.prototype.proxy;goog.events.Listener.prototype.src;goog.events.Listener.prototype.type;goog.events.Listener.prototype.capture;goog.events.Listener.prototype.handler;goog.events.Listener.prototype.key=0;goog.events.Listener.prototype.removed=false;goog.events.Listener.prototype.callOnce=false;goog.events.Listener.prototype.creationStack;goog.events.Listener.prototype.init=function(d,b,f,c,a,e){if(goog.isFunction(d)){this.isFunctionListener_=true}else{if(d&&d.handleEvent&&goog.isFunction(d.handleEvent)){this.isFunctionListener_=false}else{throw Error("Invalid listener argument")}}this.listener=d;this.proxy=b;this.src=f;this.type=c;this.capture=!!a;this.handler=e;this.callOnce=false;this.key=++goog.events.Listener.counter_;this.removed=false};goog.events.Listener.prototype.handleEvent=function(a){if(this.isFunctionListener_){return this.listener.call(this.handler||this.src,a)}return this.listener.handleEvent.call(this.listener,a)};goog.provide("goog.events.BrowserFeature");goog.require("goog.userAgent");goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersion("8"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersion("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersion("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersion("8")||goog.userAgent.OPERA&&goog.userAgent.isVersion("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersion("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersion("8")||goog.userAgent.IE&&!goog.userAgent.isVersion("9")};goog.provide("goog.debug.EntryPointMonitor");goog.provide("goog.debug.entryPointRegistry");goog.require("goog.asserts");goog.debug.EntryPointMonitor=function(){};goog.debug.EntryPointMonitor.prototype.wrap;goog.debug.EntryPointMonitor.prototype.unwrap;goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=false;goog.debug.entryPointRegistry.register=function(c){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=c;if(goog.debug.entryPointRegistry.monitorsMayExist_){var b=goog.debug.entryPointRegistry.monitors_;for(var a=0;a<b.length;a++){c(goog.bind(b[a].wrap,b[a]))}}};goog.debug.entryPointRegistry.monitorAll=function(b){goog.debug.entryPointRegistry.monitorsMayExist_=true;var a=goog.bind(b.wrap,b);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++){goog.debug.entryPointRegistry.refList_[c](a)}goog.debug.entryPointRegistry.monitors_.push(b)};goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(b){var d=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(b==d[d.length-1],"Only the most recent monitor can be unwrapped.");var a=goog.bind(b.unwrap,b);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++){goog.debug.entryPointRegistry.refList_[c](a)}d.length--};goog.provide("goog.events.EventWrapper");goog.events.EventWrapper=function(){};goog.events.EventWrapper.prototype.listen=function(e,c,d,b,a){};goog.events.EventWrapper.prototype.unlisten=function(e,c,d,b,a){};goog.provide("goog.events.Event");goog.require("goog.Disposable");goog.events.Event=function(b,a){goog.Disposable.call(this);this.type=b;this.target=a;this.currentTarget=this.target};goog.inherits(goog.events.Event,goog.Disposable);goog.events.Event.prototype.disposeInternal=function(){delete this.type;delete this.target;delete this.currentTarget};goog.events.Event.prototype.propagationStopped_=false;goog.events.Event.prototype.defaultPrevented=false;goog.events.Event.prototype.returnValue_=true;goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=true};goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=true;this.returnValue_=false};goog.events.Event.stopPropagation=function(a){a.stopPropagation()};goog.events.Event.preventDefault=function(a){a.preventDefault()};goog.provide("goog.events.BrowserEvent");goog.provide("goog.events.BrowserEvent.MouseButton");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.reflect");goog.require("goog.userAgent");goog.events.BrowserEvent=function(b,a){if(b){this.init(b,a)}};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.target=null;goog.events.BrowserEvent.prototype.currentTarget;goog.events.BrowserEvent.prototype.relatedTarget=null;goog.events.BrowserEvent.prototype.offsetX=0;goog.events.BrowserEvent.prototype.offsetY=0;goog.events.BrowserEvent.prototype.clientX=0;goog.events.BrowserEvent.prototype.clientY=0;goog.events.BrowserEvent.prototype.screenX=0;goog.events.BrowserEvent.prototype.screenY=0;goog.events.BrowserEvent.prototype.button=0;goog.events.BrowserEvent.prototype.keyCode=0;goog.events.BrowserEvent.prototype.charCode=0;goog.events.BrowserEvent.prototype.ctrlKey=false;goog.events.BrowserEvent.prototype.altKey=false;goog.events.BrowserEvent.prototype.shiftKey=false;goog.events.BrowserEvent.prototype.metaKey=false;goog.events.BrowserEvent.prototype.state;goog.events.BrowserEvent.prototype.platformModifierKey=false;goog.events.BrowserEvent.prototype.event_=null;goog.events.BrowserEvent.prototype.init=function(d,b){var c=this.type=d.type;goog.events.Event.call(this,c);this.target=(d.target)||d.srcElement;this.currentTarget=b;var a=(d.relatedTarget);if(a){if(goog.userAgent.GECKO){if(!goog.reflect.canAccessProperty(a,"nodeName")){a=null}}}else{if(c==goog.events.EventType.MOUSEOVER){a=d.fromElement}else{if(c==goog.events.EventType.MOUSEOUT){a=d.toElement}}}this.relatedTarget=a;this.offsetX=(goog.userAgent.WEBKIT||d.offsetX!==undefined)?d.offsetX:d.layerX;this.offsetY=(goog.userAgent.WEBKIT||d.offsetY!==undefined)?d.offsetY:d.layerY;this.clientX=d.clientX!==undefined?d.clientX:d.pageX;this.clientY=d.clientY!==undefined?d.clientY:d.pageY;this.screenX=d.screenX||0;this.screenY=d.screenY||0;this.button=d.button;this.keyCode=d.keyCode||0;this.charCode=d.charCode||(c=="keypress"?d.keyCode:0);this.ctrlKey=d.ctrlKey;this.altKey=d.altKey;this.shiftKey=d.shiftKey;this.metaKey=d.metaKey;this.platformModifierKey=goog.userAgent.MAC?d.metaKey:d.ctrlKey;this.state=d.state;this.event_=d;if(d.defaultPrevented){this.preventDefault()}delete this.propagationStopped_};goog.events.BrowserEvent.prototype.isButton=function(a){if(!goog.events.BrowserFeature.HAS_W3C_BUTTON){if(this.type=="click"){return a==goog.events.BrowserEvent.MouseButton.LEFT}else{return !!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[a])}}else{return this.event_.button==a}};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);if(this.event_.stopPropagation){this.event_.stopPropagation()}else{this.event_.cancelBubble=true}};goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var d=this.event_;if(!d.preventDefault){d.returnValue=false;if(goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT){try{var a=112;var b=123;if(d.ctrlKey||d.keyCode>=a&&d.keyCode<=b){d.keyCode=-1}}catch(c){}}}else{d.preventDefault()}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.prototype.disposeInternal=function(){goog.events.BrowserEvent.superClass_.disposeInternal.call(this);this.event_=null;this.target=null;this.currentTarget=null;this.relatedTarget=null};goog.provide("goog.events");goog.require("goog.array");goog.require("goog.debug.entryPointRegistry");goog.require("goog.debug.errorHandlerWeakDep");goog.require("goog.events.BrowserEvent");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Event");goog.require("goog.events.EventWrapper");goog.require("goog.events.Listener");goog.require("goog.object");goog.require("goog.userAgent");goog.events.listeners_={};goog.events.listenerTree_={};goog.events.sources_={};goog.events.onString_="on";goog.events.onStringMap_={};goog.events.keySeparator_="_";goog.events.listen=function(a,k,d,f,n){if(!k){throw Error("Invalid event type")}else{if(goog.isArray(k)){for(var g=0;g<k.length;g++){goog.events.listen(a,k[g],d,f,n)}return null}else{var m=!!f;var b=goog.events.listenerTree_;if(!(k in b)){b[k]={count_:0,remaining_:0}}b=b[k];if(!(m in b)){b[m]={count_:0,remaining_:0};b.count_++}b=b[m];var c=goog.getUid(a);var h,e;b.remaining_++;if(!b[c]){h=b[c]=[];b.count_++}else{h=b[c];for(var g=0;g<h.length;g++){e=h[g];if(e.listener==d&&e.handler==n){if(e.removed){break}return h[g].key}}}var j=goog.events.getProxy();j.src=a;e=new goog.events.Listener();e.init(d,j,a,k,m,n);var l=e.key;j.key=l;h.push(e);goog.events.listeners_[l]=e;if(!goog.events.sources_[c]){goog.events.sources_[c]=[]}goog.events.sources_[c].push(e);if(a.addEventListener){if(a==goog.global||!a.customEvent_){a.addEventListener(k,j,m)}}else{a.attachEvent(goog.events.getOnString_(k),j)}return l}}};goog.events.getProxy=function(){var a=goog.events.handleBrowserEvent_;var b=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(c){return a.call(b.src,b.key,c)}:function(c){var d=a.call(b.src,b.key,c);if(!d){return d}};return b};goog.events.listenOnce=function(h,c,d,g,f){if(goog.isArray(c)){for(var b=0;b<c.length;b++){goog.events.listenOnce(h,c[b],d,g,f)}return null}var a=goog.events.listen(h,c,d,g,f);var e=goog.events.listeners_[a];e.callOnce=true;return a};goog.events.listenWithWrapper=function(d,e,a,c,b){e.listen(d,a,c,b)};goog.events.unlisten=function(h,d,e,g,f){if(goog.isArray(d)){for(var c=0;c<d.length;c++){goog.events.unlisten(h,d[c],e,g,f)}return null}var b=!!g;var a=goog.events.getListeners_(h,d,b);if(!a){return false}for(var c=0;c<a.length;c++){if(a[c].listener==e&&a[c].capture==b&&a[c].handler==f){return goog.events.unlistenByKey(a[c].key)}}return false};goog.events.unlistenByKey=function(g){if(!goog.events.listeners_[g]){return false}var c=goog.events.listeners_[g];if(c.removed){return false}var a=c.src;var f=c.type;var e=c.proxy;var h=c.capture;if(a.removeEventListener){if(a==goog.global||!a.customEvent_){a.removeEventListener(f,e,h)}}else{if(a.detachEvent){a.detachEvent(goog.events.getOnString_(f),e)}}var b=goog.getUid(a);var d=goog.events.listenerTree_[f][h][b];if(goog.events.sources_[b]){var i=goog.events.sources_[b];goog.array.remove(i,c);if(i.length==0){delete goog.events.sources_[b]}}c.removed=true;d.needsCleanup_=true;goog.events.cleanUp_(f,h,b,d);delete goog.events.listeners_[g];return true};goog.events.unlistenWithWrapper=function(d,e,a,c,b){e.unlisten(d,a,c,b)};goog.events.cleanUp_=function(e,b,g,a){if(!a.locked_){if(a.needsCleanup_){for(var f=0,d=0;f<a.length;f++){if(a[f].removed){var c=a[f].proxy;c.src=null;continue}if(f!=d){a[d]=a[f]}d++}a.length=d;a.needsCleanup_=false;if(d==0){delete goog.events.listenerTree_[e][b][g];goog.events.listenerTree_[e][b].count_--;if(goog.events.listenerTree_[e][b].count_==0){delete goog.events.listenerTree_[e][b];goog.events.listenerTree_[e].count_--}if(goog.events.listenerTree_[e].count_==0){delete goog.events.listenerTree_[e]}}}}};goog.events.removeAll=function(c,j,e){var g=0;var l=c==null;var a=j==null;var h=e==null;e=!!e;if(!l){var b=goog.getUid((c));if(goog.events.sources_[b]){var k=goog.events.sources_[b];for(var f=k.length-1;f>=0;f--){var d=k[f];if((a||j==d.type)&&(h||e==d.capture)){goog.events.unlistenByKey(d.key);g++}}}}else{goog.object.forEach(goog.events.sources_,function(n){for(var m=n.length-1;m>=0;m--){var o=n[m];if((a||j==o.type)&&(h||e==o.capture)){goog.events.unlistenByKey(o.key);g++}}})}return g};goog.events.getListeners=function(c,b,a){return goog.events.getListeners_(c,b,a)||[]};goog.events.getListeners_=function(e,b,a){var d=goog.events.listenerTree_;if(b in d){d=d[b];if(a in d){d=d[a];var c=goog.getUid(e);if(d[c]){return d[c]}}}return null};goog.events.getListener=function(h,d,e,g,f){var b=!!g;var a=goog.events.getListeners_(h,d,b);if(a){for(var c=0;c<a.length;c++){if(!a[c].removed&&a[c].listener==e&&a[c].capture==b&&a[c].handler==f){return a[c]}}}return null};goog.events.hasListener=function(g,h,c){var d=goog.getUid(g);var b=goog.events.sources_[d];if(b){var a=goog.isDef(h);var f=goog.isDef(c);if(a&&f){var e=goog.events.listenerTree_[h];return !!e&&!!e[c]&&d in e[c]}else{if(!(a||f)){return true}else{return goog.array.some(b,function(i){return(a&&i.type==h)||(f&&i.capture==c)})}}}return false};goog.events.expose=function(b){var c=[];for(var a in b){if(b[a]&&b[a].id){c.push(a+" = "+b[a]+" ("+b[a].id+")")}else{c.push(a+" = "+b[a])}}return c.join("\n")};goog.events.getOnString_=function(a){if(a in goog.events.onStringMap_){return goog.events.onStringMap_[a]}return goog.events.onStringMap_[a]=goog.events.onString_+a};goog.events.fireListeners=function(e,c,b,a){var d=goog.events.listenerTree_;if(c in d){d=d[c];if(b in d){return goog.events.fireListeners_(d[b],e,c,b,a)}}return true};goog.events.fireListeners_=function(a,g,k,l,e){var b=1;var h=goog.getUid(g);if(a[h]){a.remaining_--;var j=a[h];if(!j.locked_){j.locked_=1}else{j.locked_++}try{var c=j.length;for(var f=0;f<c;f++){var d=j[f];if(d&&!d.removed){b&=goog.events.fireListener(d,e)!==false}}}finally{j.locked_--;goog.events.cleanUp_(k,l,h,j)}}return Boolean(b)};goog.events.fireListener=function(b,a){if(b.callOnce){goog.events.unlistenByKey(b.key)}return b.handleEvent(a)};goog.events.getTotalListenerCount=function(){return goog.object.getCount(goog.events.listeners_)};goog.events.dispatchEvent=function(a,j){var l=j.type||j;var b=goog.events.listenerTree_;if(!(l in b)){return true}if(goog.isString(j)){j=new goog.events.Event(j,a)}else{if(!(j instanceof goog.events.Event)){var f=j;j=new goog.events.Event(l,a);goog.object.extend(j,f)}else{j.target=j.target||a}}var d=1,o;b=b[l];var k=true in b;var c;if(k){o=[];for(var n=a;n;n=n.getParentEventTarget()){o.push(n)}c=b[true];c.remaining_=c.count_;for(var g=o.length-1;!j.propagationStopped_&&g>=0&&c.remaining_;g--){j.currentTarget=o[g];d&=goog.events.fireListeners_(c,o[g],j.type,true,j)&&j.returnValue_!=false}}var m=false in b;if(m){c=b[false];c.remaining_=c.count_;if(k){for(var g=0;!j.propagationStopped_&&g<o.length&&c.remaining_;g++){j.currentTarget=o[g];d&=goog.events.fireListeners_(c,o[g],j.type,false,j)&&j.returnValue_!=false}}else{for(var h=a;!j.propagationStopped_&&h&&c.remaining_;h=h.getParentEventTarget()){j.currentTarget=h;d&=goog.events.fireListeners_(c,h,j.type,false,j)&&j.returnValue_!=false}}}return Boolean(d)};goog.events.protectBrowserEventEntryPoint=function(a){goog.events.handleBrowserEvent_=a.protectEntryPoint(goog.events.handleBrowserEvent_)};goog.events.handleBrowserEvent_=function(o,h){if(!goog.events.listeners_[o]){return true}var d=goog.events.listeners_[o];var j=d.type;var a=goog.events.listenerTree_;if(!(j in a)){return true}a=a[j];var c,b;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var l=h||(goog.getObjectByName("window.event"));var g=true in a;var k=false in a;if(g){if(goog.events.isMarkedIeEvent_(l)){return true}goog.events.markIeEvent_(l)}var n=new goog.events.BrowserEvent();n.init(l,this);c=true;try{if(g){var p=[];for(var m=n.currentTarget;m;m=m.parentNode){p.push(m)}b=a[true];b.remaining_=b.count_;for(var e=p.length-1;!n.propagationStopped_&&e>=0&&b.remaining_;e--){n.currentTarget=p[e];c&=goog.events.fireListeners_(b,p[e],j,true,n)}if(k){b=a[false];b.remaining_=b.count_;for(var e=0;!n.propagationStopped_&&e<p.length&&b.remaining_;e++){n.currentTarget=p[e];c&=goog.events.fireListeners_(b,p[e],j,false,n)}}}else{c=goog.events.fireListener(d,n)}}finally{if(p){p.length=0}n.dispose()}return c}var f=new goog.events.BrowserEvent(h,this);try{c=goog.events.fireListener(d,f)}finally{f.dispose()}return c};goog.events.markIeEvent_=function(b){var c=false;if(b.keyCode==0){try{b.keyCode=-1;return}catch(a){c=true}}if(c||(b.returnValue)==undefined){b.returnValue=true}};goog.events.isMarkedIeEvent_=function(a){return a.keyCode<0||a.returnValue!=undefined};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(a){return a+"_"+goog.events.uniqueIdCounter_++};goog.debug.entryPointRegistry.register(function(a){goog.events.handleBrowserEvent_=a(goog.events.handleBrowserEvent_)});goog.provide("goog.events.EventTarget");goog.require("goog.Disposable");goog.require("goog.events");goog.events.EventTarget=function(){goog.Disposable.call(this)};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.EventTarget.prototype.customEvent_=true;goog.events.EventTarget.prototype.parentEventTarget_=null;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(a){this.parentEventTarget_=a};goog.events.EventTarget.prototype.addEventListener=function(b,a,c,d){goog.events.listen(this,b,a,c,d)};goog.events.EventTarget.prototype.removeEventListener=function(b,a,c,d){goog.events.unlisten(this,b,a,c,d)};goog.events.EventTarget.prototype.dispatchEvent=function(a){return goog.events.dispatchEvent(this,a)};goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);goog.events.removeAll(this);this.parentEventTarget_=null};goog.provide("goog.editor.Plugin");goog.require("goog.debug.Logger");goog.require("goog.editor.Command");goog.require("goog.events.EventTarget");goog.require("goog.functions");goog.require("goog.object");goog.require("goog.reflect");goog.editor.Plugin=function(){goog.events.EventTarget.call(this);this.enabled_=this.activeOnUneditableFields()};goog.inherits(goog.editor.Plugin,goog.events.EventTarget);goog.editor.Plugin.prototype.fieldObject=null;goog.editor.Plugin.prototype.getFieldDomHelper=function(){return this.fieldObject&&this.fieldObject.getEditableDomHelper()};goog.editor.Plugin.prototype.autoDispose_=true;goog.editor.Plugin.prototype.logger=goog.debug.Logger.getLogger("goog.editor.Plugin");goog.editor.Plugin.prototype.registerFieldObject=function(a){this.fieldObject=a};goog.editor.Plugin.prototype.unregisterFieldObject=function(a){if(this.fieldObject){this.disable(this.fieldObject);this.fieldObject=null}};goog.editor.Plugin.prototype.enable=function(a){if(this.fieldObject==a){this.enabled_=true}else{this.logger.severe("Trying to enable an unregistered field with this plugin.")}};goog.editor.Plugin.prototype.disable=function(a){if(this.fieldObject==a){this.enabled_=false}else{this.logger.severe("Trying to disable an unregistered field with this plugin.")}};goog.editor.Plugin.prototype.isEnabled=function(a){return this.fieldObject==a?this.enabled_:false};goog.editor.Plugin.prototype.setAutoDispose=function(a){this.autoDispose_=a};goog.editor.Plugin.prototype.isAutoDispose=function(){return this.autoDispose_};goog.editor.Plugin.prototype.activeOnUneditableFields=goog.functions.FALSE;goog.editor.Plugin.prototype.isSilentCommand=goog.functions.FALSE;goog.editor.Plugin.prototype.disposeInternal=function(){if(this.fieldObject){this.unregisterFieldObject(this.fieldObject)}goog.editor.Plugin.superClass_.disposeInternal.call(this)};goog.editor.Plugin.prototype.getTrogClassId;goog.editor.Plugin.Op={KEYDOWN:1,KEYPRESS:2,KEYUP:3,SELECTION:4,SHORTCUT:5,EXEC_COMMAND:6,QUERY_COMMAND:7,PREPARE_CONTENTS_HTML:8,CLEAN_CONTENTS_HTML:10,CLEAN_CONTENTS_DOM:11};goog.editor.Plugin.OPCODE=goog.object.transpose(goog.reflect.object(goog.editor.Plugin,{handleKeyDown:goog.editor.Plugin.Op.KEYDOWN,handleKeyPress:goog.editor.Plugin.Op.KEYPRESS,handleKeyUp:goog.editor.Plugin.Op.KEYUP,handleSelectionChange:goog.editor.Plugin.Op.SELECTION,handleKeyboardShortcut:goog.editor.Plugin.Op.SHORTCUT,execCommand:goog.editor.Plugin.Op.EXEC_COMMAND,queryCommandValue:goog.editor.Plugin.Op.QUERY_COMMAND,prepareContentsHtml:goog.editor.Plugin.Op.PREPARE_CONTENTS_HTML,cleanContentsHtml:goog.editor.Plugin.Op.CLEAN_CONTENTS_HTML,cleanContentsDom:goog.editor.Plugin.Op.CLEAN_CONTENTS_DOM}));goog.editor.Plugin.IRREPRESSIBLE_OPS=goog.object.createSet(goog.editor.Plugin.Op.PREPARE_CONTENTS_HTML,goog.editor.Plugin.Op.CLEAN_CONTENTS_HTML,goog.editor.Plugin.Op.CLEAN_CONTENTS_DOM);goog.editor.Plugin.prototype.handleKeyDown;goog.editor.Plugin.prototype.handleKeyPress;goog.editor.Plugin.prototype.handleKeyUp;goog.editor.Plugin.prototype.handleSelectionChange;goog.editor.Plugin.prototype.handleKeyboardShortcut;goog.editor.Plugin.prototype.execCommand=function(d,c){var b=this.isSilentCommand(d);if(!b){if(goog.userAgent.GECKO){this.fieldObject.stopChangeEvents(true,true)}this.fieldObject.dispatchBeforeChange()}try{var a=this.execCommandInternal.apply(this,arguments)}finally{if(!b){this.fieldObject.dispatchChange();this.fieldObject.dispatchSelectionChangeEvent()}}return a};goog.editor.Plugin.prototype.execCommandInternal;goog.editor.Plugin.prototype.queryCommandValue;goog.editor.Plugin.prototype.prepareContentsHtml;goog.editor.Plugin.prototype.cleanContentsDom;goog.editor.Plugin.prototype.cleanContentsHtml;goog.editor.Plugin.prototype.isSupportedCommand=function(a){return false};goog.provide("goog.editor.plugins.RemoveFormatting");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.Range");goog.require("goog.dom.TagName");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Plugin");goog.require("goog.editor.node");goog.require("goog.editor.range");goog.require("goog.string");goog.editor.plugins.RemoveFormatting=function(){goog.editor.Plugin.call(this);this.optRemoveFormattingFunc_=null};goog.inherits(goog.editor.plugins.RemoveFormatting,goog.editor.Plugin);goog.editor.plugins.RemoveFormatting.REMOVE_FORMATTING_COMMAND="+removeFormat";goog.editor.plugins.RemoveFormatting.BLOCK_RE_=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/;goog.editor.plugins.RemoveFormatting.appendNewline_=function(a){a.push("<br>")};goog.editor.plugins.RemoveFormatting.createRangeDelimitedByRanges_=function(b,a){return goog.dom.Range.createFromNodes(b.getStartNode(),b.getStartOffset(),a.getEndNode(),a.getEndOffset())};goog.editor.plugins.RemoveFormatting.prototype.getTrogClassId=function(){return"RemoveFormatting"};goog.editor.plugins.RemoveFormatting.prototype.isSupportedCommand=function(a){return a==goog.editor.plugins.RemoveFormatting.REMOVE_FORMATTING_COMMAND};goog.editor.plugins.RemoveFormatting.prototype.execCommandInternal=function(b,a){if(b==goog.editor.plugins.RemoveFormatting.REMOVE_FORMATTING_COMMAND){this.removeFormatting_()}};goog.editor.plugins.RemoveFormatting.prototype.handleKeyboardShortcut=function(c,a,b){if(!b){return false}if(a==" "){this.fieldObject.execCommand(goog.editor.plugins.RemoveFormatting.REMOVE_FORMATTING_COMMAND);return true}return false};goog.editor.plugins.RemoveFormatting.prototype.removeFormatting_=function(){var a=this.fieldObject.getRange();if(a.isCollapsed()){return}var c=this.optRemoveFormattingFunc_||goog.bind(this.removeFormattingWorker_,this);this.convertSelectedHtmlText_(c);var b=this.getFieldDomHelper().getDocument();b.execCommand("RemoveFormat",false,undefined);if(goog.editor.BrowserFeature.ADDS_NBSPS_IN_REMOVE_FORMAT){this.convertSelectedHtmlText_(function(e){var d=goog.userAgent.isVersion("528")?/&nbsp;/g:/\u00A0/g;return e.replace(d," ")})}};goog.editor.plugins.RemoveFormatting.getTableAncestor_=function(a){return goog.dom.getAncestor(a,function(b){return b.tagName==goog.dom.TagName.TABLE},true)};goog.editor.plugins.RemoveFormatting.prototype.pasteHtml_=function(c){var d=this.fieldObject.getRange();var i=this.getFieldDomHelper();var g=goog.string.createUniqueString();var h=goog.string.createUniqueString();c='<span id="'+g+'"></span>'+c+'<span id="'+h+'"></span>';var f=goog.string.createUniqueString();var k='<span id="'+f+'"></span>';if(goog.editor.BrowserFeature.HAS_IE_RANGES){var n=d.getTextRange(0).getBrowserRangeObject();n.pasteHTML(k);var l;while((l=n.parentElement())&&goog.editor.node.isEmpty(l)&&!goog.editor.node.isEditableContainer(l)){var m=l.nodeName;if(m==goog.dom.TagName.TD||m==goog.dom.TagName.TR||m==goog.dom.TagName.TH){break}goog.dom.removeNode(l)}n.pasteHTML(c);var e=i.getElement(f);if(e){goog.dom.removeNode(e)}}else{if(goog.editor.BrowserFeature.HAS_W3C_RANGES){i.getDocument().execCommand("insertImage",false,f);var a=new RegExp("<[^<]*"+f+"[^>]*>");var l=this.fieldObject.getRange().getContainerElement();if(l.nodeType==goog.dom.NodeType.TEXT){l=l.parentNode}while(!a.test(l.innerHTML)){l=l.parentNode}if(goog.userAgent.GECKO){l.innerHTML=l.innerHTML.replace(a,c)}else{l.innerHTML=l.innerHTML.replace(a,k);var e=i.getElement(f);l=e;while((l=e.parentNode)&&goog.editor.node.isEmpty(l)&&!goog.editor.node.isEditableContainer(l)){var m=l.nodeName;if(m==goog.dom.TagName.TD||m==goog.dom.TagName.TR||m==goog.dom.TagName.TH){break}goog.dom.insertSiblingAfter(e,l);goog.dom.removeNode(l)}l.innerHTML=l.innerHTML.replace(new RegExp(k,"i"),c)}}}var j=i.getElement(g);var b=i.getElement(h);goog.dom.Range.createFromNodes(j,0,b,b.childNodes.length).select();goog.dom.removeNode(j);goog.dom.removeNode(b)};goog.editor.plugins.RemoveFormatting.prototype.getHtmlText_=function(c){var h=this.getFieldDomHelper().createDom("div");var e=c.getBrowserRangeObject();if(goog.editor.BrowserFeature.HAS_W3C_RANGES){h.appendChild(e.cloneContents())}else{if(goog.editor.BrowserFeature.HAS_IE_RANGES){var b=c.getText();b=b.replace(/\r\n/g,"\r");var a=b.length;var f=a-goog.string.trimLeft(b).length;var d=a-goog.string.trimRight(b).length;e.moveStart("character",f);e.moveEnd("character",-d);var g=e.htmlText;if(e.queryCommandValue("formatBlock")=="Formatted"){g=goog.string.newLineToBr(e.htmlText)}h.innerHTML=g}}return h.innerHTML};goog.editor.plugins.RemoveFormatting.prototype.adjustRangeForTables_=function(e,j,d){var b=goog.editor.range.saveUsingNormalizedCarets(e);var a=e.getStartNode();var g=e.getStartOffset();var f=e.getEndNode();var i=e.getEndOffset();var h=this.getFieldDomHelper();if(j){var c=h.createTextNode("");goog.dom.insertSiblingAfter(c,j);a=c;g=0}if(d){var c=h.createTextNode("");goog.dom.insertSiblingBefore(c,d);f=c;i=0}goog.dom.Range.createFromNodes(a,g,f,i).select();return b};goog.editor.plugins.RemoveFormatting.prototype.putCaretInCave_=function(c,a){var b=goog.dom.removeNode(c.getCaret(a));if(a){this.startCaretInCave_=b}else{this.endCaretInCave_=b}};goog.editor.plugins.RemoveFormatting.prototype.restoreCaretsFromCave_=function(){var a=this.fieldObject.getElement();if(this.startCaretInCave_){a.insertBefore(this.startCaretInCave_,a.firstChild);this.startCaretInCave_=null}if(this.endCaretInCave_){a.appendChild(this.endCaretInCave_);this.endCaretInCave_=null}};goog.editor.plugins.RemoveFormatting.prototype.convertSelectedHtmlText_=function(d){var f=this.fieldObject.getRange();if(f.getTextRangeCount()>1){return}if(goog.userAgent.GECKO){var j=goog.editor.range.expand(f,this.fieldObject.getElement());var i=goog.editor.plugins.RemoveFormatting.getTableAncestor_(j.getStartNode());var b=goog.editor.plugins.RemoveFormatting.getTableAncestor_(j.getEndNode());if(i||b){if(i==b){return}var a=this.adjustRangeForTables_(f,i,b);if(!i){this.putCaretInCave_(a,true)}if(!b){this.putCaretInCave_(a,false)}f=this.fieldObject.getRange();j=goog.editor.range.expand(f,this.fieldObject.getElement())}j.select();f=j}var k=this.getHtmlText_(f);this.pasteHtml_(d(k));if(goog.userAgent.GECKO&&a){f=this.fieldObject.getRange();this.restoreCaretsFromCave_();var e=a.toAbstractRange();var h=i?e:f;var c=b?e:f;var g=goog.editor.plugins.RemoveFormatting.createRangeDelimitedByRanges_(h,c);g.select();a.dispose()}};goog.editor.plugins.RemoveFormatting.prototype.removeFormattingWorker_=function(l){var d=goog.dom.createElement("div");d.innerHTML=l;var b=[];var j=[d.childNodes,0];var n=[];var h=0;var m=[];var f=0;for(var q=0;q>=0;q-=2){var o=false;while(f>0&&q<=m[f-1]){f--;o=true}if(o){goog.editor.plugins.RemoveFormatting.appendNewline_(b)}o=false;while(h>0&&q<=n[h-1]){h--;o=true}if(o){goog.editor.plugins.RemoveFormatting.appendNewline_(b)}var r=j[q];var i=j[q+1];while(i<r.length){var p=r[i++];var a=p.nodeName;var c=this.getValueForNode(p);if(goog.isDefAndNotNull(c)){b.push(c);continue}switch(a){case"#text":var e=h>0?p.nodeValue:goog.string.stripNewlines(p.nodeValue);e=goog.string.htmlEscape(e);b.push(e);continue;case goog.dom.TagName.P:goog.editor.plugins.RemoveFormatting.appendNewline_(b);goog.editor.plugins.RemoveFormatting.appendNewline_(b);break;case goog.dom.TagName.BR:goog.editor.plugins.RemoveFormatting.appendNewline_(b);continue;case goog.dom.TagName.TABLE:goog.editor.plugins.RemoveFormatting.appendNewline_(b);m[f++]=q;break;case goog.dom.TagName.PRE:case"XMP":n[h++]=q;break;case goog.dom.TagName.STYLE:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.SELECT:continue;case goog.dom.TagName.A:if(p.href&&p.href!=""){b.push("<a href='");b.push(p.href);b.push("'>");b.push(this.removeFormattingWorker_(p.innerHTML));b.push("</a>");continue}else{break}case goog.dom.TagName.IMG:b.push("<img src='");b.push(p.src);b.push("'");if(p.border=="0"){b.push(" border='0'")}b.push(">");continue;case goog.dom.TagName.TD:if(p.previousSibling){b.push(" ")}break;case goog.dom.TagName.TR:if(p.previousSibling){goog.editor.plugins.RemoveFormatting.appendNewline_(b)}break;case goog.dom.TagName.DIV:var k=p.parentNode;if(k.firstChild==p&&goog.editor.plugins.RemoveFormatting.BLOCK_RE_.test(k.tagName)){break}default:if(goog.editor.plugins.RemoveFormatting.BLOCK_RE_.test(a)){goog.editor.plugins.RemoveFormatting.appendNewline_(b)}}var g=p.childNodes;if(g.length>0){j[q++]=r;j[q++]=i;r=g;i=0}}}return goog.string.normalizeSpaces(b.join(""))};goog.editor.plugins.RemoveFormatting.prototype.getValueForNode=function(a){return null};goog.editor.plugins.RemoveFormatting.prototype.setRemoveFormattingFunc=function(a){this.optRemoveFormattingFunc_=a};goog.provide("goog.editor.icontent");goog.provide("goog.editor.icontent.FieldFormatInfo");goog.provide("goog.editor.icontent.FieldStyleInfo");goog.require("goog.editor.BrowserFeature");goog.require("goog.style");goog.require("goog.userAgent");goog.editor.icontent.FieldFormatInfo=function(c,b,e,d,a){this.fieldId_=c;this.standards_=b;this.blended_=e;this.fixedHeight_=d;this.extraStyles_=a||{}};goog.editor.icontent.FieldStyleInfo=function(b,a){this.wrapper_=b;this.css_=a};goog.editor.icontent.useStandardsModeIframes_=false;goog.editor.icontent.forceStandardsModeIframes=function(){goog.editor.icontent.useStandardsModeIframes_=true};goog.editor.icontent.getInitialIframeContent_=function(e,a,d){var c=[];if(e.blended_&&e.standards_||goog.editor.icontent.useStandardsModeIframes_){c.push("<!DOCTYPE HTML>")}c.push('<html style="background:none transparent;min-width:0;');if(e.blended_){c.push("height:",e.fixedHeight_?"100%":"auto")}c.push('">');c.push("<head><style>");if(d&&d.css_){c.push(d.css_)}if(goog.userAgent.GECKO&&e.standards_){c.push(" img {-moz-force-broken-image-icon: 1;}")}c.push("</style></head>");c.push('<body g_editable="true" hidefocus="true" ');if(goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE){c.push("contentEditable ")}c.push('class="editable ');c.push('" id="',e.fieldId_,'" style="min-width:0;');if(goog.userAgent.GECKO&&e.blended_){c.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",e.standards_?"100%":"auto");if(e.fixedHeight_){c.push(";overflow:auto")}else{c.push(";overflow-y:hidden;overflow-x:auto")}}if(goog.userAgent.OPERA){c.push(";outline:hidden")}for(var b in e.extraStyles_){c.push(";"+b+":"+e.extraStyles_[b])}c.push('">',a,"</body></html>");return c.join("")};goog.editor.icontent.writeNormalInitialBlendedIframe=function(f,a,d,c){if(f.blended_){var e=d.wrapper_;var b=goog.style.getPaddingBox(e);if(b.top||b.left||b.right||b.bottom){goog.style.setStyle(c,"margin",(-b.top)+"px "+(-b.right)+"px "+(-b.bottom)+"px "+(-b.left)+"px")}}goog.editor.icontent.writeNormalInitialIframe(f,a,d,c)};goog.editor.icontent.writeNormalInitialIframe=function(f,a,d,c){var b=goog.editor.icontent.getInitialIframeContent_(f,a,d);var e=goog.dom.getFrameContentDocument(c);e.open();e.write(b);e.close()};goog.editor.icontent.writeHttpsInitialIframe=function(d,c,b){var a=c.body;if(goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE){a.contentEditable=true}a.className="editable";a.setAttribute("g_editable",true);a.hideFocus=true;a.id=d.fieldId_;goog.style.setStyle(a,d.extraStyles_);a.innerHTML=b};goog.provide("goog.events.KeyCodes");goog.require("goog.userAgent");goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,PHANTOM:255};goog.events.KeyCodes.isTextModifyingKeyEvent=function(a){if(a.altKey&&!a.ctrlKey||a.metaKey||a.keyCode>=goog.events.KeyCodes.F1&&a.keyCode<=goog.events.KeyCodes.F12){return false}switch(a.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return false;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return !goog.userAgent.GECKO;default:return a.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||a.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};goog.events.KeyCodes.firesKeyPressEvent=function(e,d,c,a,b){if(!goog.userAgent.IE&&!(goog.userAgent.WEBKIT&&goog.userAgent.isVersion("525"))){return true}if(goog.userAgent.MAC&&b){return goog.events.KeyCodes.isCharacterKey(e)}if(b&&!a){return false}if(!c&&(d==goog.events.KeyCodes.CTRL||d==goog.events.KeyCodes.ALT)){return false}if(goog.userAgent.IE&&a&&d==e){return false}switch(e){case goog.events.KeyCodes.ENTER:return !(goog.userAgent.IE&&goog.userAgent.isDocumentMode(9));case goog.events.KeyCodes.ESC:return !goog.userAgent.WEBKIT}return goog.events.KeyCodes.isCharacterKey(e)};goog.events.KeyCodes.isCharacterKey=function(a){if(a>=goog.events.KeyCodes.ZERO&&a<=goog.events.KeyCodes.NINE){return true}if(a>=goog.events.KeyCodes.NUM_ZERO&&a<=goog.events.KeyCodes.NUM_MULTIPLY){return true}if(a>=goog.events.KeyCodes.A&&a<=goog.events.KeyCodes.Z){return true}if(goog.userAgent.WEBKIT&&a==0){return true}switch(a){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return true;default:return false}};goog.events.KeyCodes.normalizeGeckoKeyCode=function(a){switch(a){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return a}};goog.provide("goog.events.EventHandler");goog.require("goog.Disposable");goog.require("goog.array");goog.require("goog.events");goog.require("goog.events.EventWrapper");goog.events.EventHandler=function(a){goog.Disposable.call(this);this.handler_=a;this.keys_=[]};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(g,d,c,e,f){if(!goog.isArray(d)){goog.events.EventHandler.typeArray_[0]=(d);d=goog.events.EventHandler.typeArray_}for(var b=0;b<d.length;b++){var a=(goog.events.listen(g,d[b],c||this,e||false,f||this.handler_||this));this.keys_.push(a)}return this};goog.events.EventHandler.prototype.listenOnce=function(g,d,c,e,f){if(goog.isArray(d)){for(var b=0;b<d.length;b++){this.listenOnce(g,d[b],c,e,f)}}else{var a=(goog.events.listenOnce(g,d,c||this,e,f||this.handler_||this));this.keys_.push(a)}return this};goog.events.EventHandler.prototype.listenWithWrapper=function(d,e,a,c,b){e.listen(d,a,c,b||this.handler_||this,this);return this};goog.events.EventHandler.prototype.getListenerCount=function(){return this.keys_.length};goog.events.EventHandler.prototype.unlisten=function(h,d,c,e,g){if(goog.isArray(d)){for(var b=0;b<d.length;b++){this.unlisten(h,d[b],c,e,g)}}else{var f=goog.events.getListener(h,d,c||this,e,g||this.handler_||this);if(f){var a=f.key;goog.events.unlistenByKey(a);goog.array.remove(this.keys_,a)}}return this};goog.events.EventHandler.prototype.unlistenWithWrapper=function(d,e,a,c,b){e.unlisten(d,a,c,b||this.handler_||this,this);return this};goog.events.EventHandler.prototype.removeAll=function(){goog.array.forEach(this.keys_,goog.events.unlistenByKey);this.keys_.length=0};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(a){throw Error("EventHandler.handleEvent not implemented")};goog.provide("goog.Timer");goog.require("goog.events.EventTarget");goog.Timer=function(a,b){goog.events.EventTarget.call(this);this.interval_=a||1;this.timerObject_=b||goog.Timer.defaultTimerObject;this.boundTick_=goog.bind(this.tick_,this);this.last_=goog.now()};goog.inherits(goog.Timer,goog.events.EventTarget);goog.Timer.MAX_TIMEOUT_=2147483647;goog.Timer.prototype.enabled=false;goog.Timer.defaultTimerObject=goog.global.window;goog.Timer.intervalScale=0.8;goog.Timer.prototype.timer_=null;goog.Timer.prototype.getInterval=function(){return this.interval_};goog.Timer.prototype.setInterval=function(a){this.interval_=a;if(this.timer_&&this.enabled){this.stop();this.start()}else{if(this.timer_){this.stop()}}};goog.Timer.prototype.tick_=function(){if(this.enabled){var a=goog.now()-this.last_;if(a>0&&a<this.interval_*goog.Timer.intervalScale){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-a);return}this.dispatchTick();if(this.enabled){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_);this.last_=goog.now()}}};goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)};goog.Timer.prototype.start=function(){this.enabled=true;if(!this.timer_){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_);this.last_=goog.now()}};goog.Timer.prototype.stop=function(){this.enabled=false;if(this.timer_){this.timerObject_.clearTimeout(this.timer_);this.timer_=null}};goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this);this.stop();delete this.timerObject_};goog.Timer.TICK="tick";goog.Timer.callOnce=function(a,c,b){if(goog.isFunction(a)){if(b){a=goog.bind(a,b)}}else{if(a&&typeof a.handleEvent=="function"){a=goog.bind(a.handleEvent,a)}else{throw Error("Invalid listener argument")}}if(c>goog.Timer.MAX_TIMEOUT_){return -1}else{return goog.Timer.defaultTimerObject.setTimeout(a,c||0)}};goog.Timer.clear=function(a){goog.Timer.defaultTimerObject.clearTimeout(a)};goog.provide("goog.Delay");goog.provide("goog.async.Delay");goog.require("goog.Disposable");goog.require("goog.Timer");goog.async.Delay=function(b,a,c){goog.Disposable.call(this);this.listener_=b;this.interval_=a||0;this.handler_=c;this.callback_=goog.bind(this.doAction_,this)};goog.inherits(goog.async.Delay,goog.Disposable);goog.Delay=goog.async.Delay;goog.async.Delay.prototype.id_=0;goog.async.Delay.prototype.disposeInternal=function(){goog.async.Delay.superClass_.disposeInternal.call(this);this.stop();delete this.listener_;delete this.handler_};goog.async.Delay.prototype.start=function(a){this.stop();this.id_=goog.Timer.callOnce(this.callback_,goog.isDef(a)?a:this.interval_)};goog.async.Delay.prototype.stop=function(){if(this.isActive()){goog.Timer.clear(this.id_)}this.id_=0};goog.async.Delay.prototype.fire=function(){this.stop();this.doAction_()};goog.async.Delay.prototype.fireIfActive=function(){if(this.isActive()){this.fire()}};goog.async.Delay.prototype.isActive=function(){return this.id_!=0};goog.async.Delay.prototype.doAction_=function(){this.id_=0;if(this.listener_){this.listener_.call(this.handler_)}};goog.provide("goog.editor.Field");goog.provide("goog.editor.Field.EventType");goog.require("goog.array");goog.require("goog.async.Delay");goog.require("goog.debug.Logger");goog.require("goog.dom");goog.require("goog.dom.Range");goog.require("goog.dom.TagName");goog.require("goog.dom.classes");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Command");goog.require("goog.editor.Plugin");goog.require("goog.editor.icontent");goog.require("goog.editor.icontent.FieldFormatInfo");goog.require("goog.editor.icontent.FieldStyleInfo");goog.require("goog.editor.node");goog.require("goog.editor.range");goog.require("goog.events");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.functions");goog.require("goog.string");goog.require("goog.string.Unicode");goog.require("goog.style");goog.require("goog.userAgent");goog.editor.Field=function(e,b){goog.events.EventTarget.call(this);this.id=e;this.hashCode_=e;this.editableDomHelper=null;this.plugins_={};this.indexedPlugins_={};for(var d in goog.editor.Plugin.OPCODE){this.indexedPlugins_[d]=[]}this.cssStyles="";if(goog.userAgent.WEBKIT&&goog.userAgent.isVersion("525.13")&&goog.string.compareVersions(goog.userAgent.VERSION,"525.18")<=0){this.workaroundClassName_=goog.getCssName("tr-webkit-workaround");this.cssStyles="."+this.workaroundClassName_+">*{padding-right:1}"}this.stoppedEvents_={};this.stopEvent(goog.editor.Field.EventType.CHANGE);this.stopEvent(goog.editor.Field.EventType.DELAYEDCHANGE);this.isModified_=false;this.isEverModified_=false;this.delayedChangeTimer_=new goog.async.Delay(this.dispatchDelayedChange_,goog.editor.Field.DELAYED_CHANGE_FREQUENCY,this);this.debouncedEvents_={};for(var a in goog.editor.Field.EventType){this.debouncedEvents_[goog.editor.Field.EventType[a]]=0}if(goog.editor.BrowserFeature.USE_MUTATION_EVENTS){this.changeTimerGecko_=new goog.async.Delay(this.handleChange,goog.editor.Field.CHANGE_FREQUENCY,this)}this.eventRegister=new goog.events.EventHandler(this);this.wrappers_=[];this.loadState_=goog.editor.Field.LoadState_.UNEDITABLE;var c=b||document;this.originalDomHelper=goog.dom.getDomHelper(c);this.originalElement=this.originalDomHelper.getElement(this.id);this.appWindow_=this.originalDomHelper.getWindow()};goog.inherits(goog.editor.Field,goog.events.EventTarget);goog.editor.Field.prototype.field=null;goog.editor.Field.prototype.originalElement=null;goog.editor.Field.prototype.logger=goog.debug.Logger.getLogger("goog.editor.Field");goog.editor.Field.EventType={COMMAND_VALUE_CHANGE:"cvc",LOAD:"load",UNLOAD:"unload",BEFORECHANGE:"beforechange",CHANGE:"change",DELAYEDCHANGE:"delayedchange",BEFOREFOCUS:"beforefocus",FOCUS:"focus",BLUR:"blur",BEFORETAB:"beforetab",SELECTIONCHANGE:"selectionchange"};goog.editor.Field.LoadState_={UNEDITABLE:0,LOADING:1,EDITABLE:2};goog.editor.Field.DEBOUNCE_TIME_MS_=500;goog.editor.Field.activeFieldId_=null;goog.editor.Field.prototype.inModalMode_=false;goog.editor.Field.prototype.appWindow_;goog.editor.Field.prototype.originalDomHelper;goog.editor.Field.prototype.selectionChangeTarget_;goog.editor.Field.setActiveFieldId=function(a){goog.editor.Field.activeFieldId_=a};goog.editor.Field.getActiveFieldId=function(){return goog.editor.Field.activeFieldId_};goog.editor.Field.prototype.inModalMode=function(){return this.inModalMode_};goog.editor.Field.prototype.setModalMode=function(a){this.inModalMode_=a};goog.editor.Field.prototype.getHashCode=function(){return this.hashCode_};goog.editor.Field.prototype.getElement=function(){return this.field};goog.editor.Field.prototype.getOriginalElement=function(){return this.originalElement};goog.editor.Field.prototype.addListener=function(a,d,c,e){var b=this.getElement();if(b&&goog.editor.BrowserFeature.USE_DOCUMENT_FOR_KEY_EVENTS){b=b.ownerDocument}this.eventRegister.listen(b,a,d,c,e)};goog.editor.Field.prototype.getPluginByClassId=function(a){return this.plugins_[a]};goog.editor.Field.prototype.registerPlugin=function(a){var b=a.getTrogClassId();if(this.plugins_[b]){this.logger.severe("Cannot register the same class of plugin twice.")}this.plugins_[b]=a;for(var d in goog.editor.Plugin.OPCODE){var c=goog.editor.Plugin.OPCODE[d];if(a[c]){this.indexedPlugins_[d].push(a)}}a.registerFieldObject(this);if(this.isLoaded()){a.enable(this)}};goog.editor.Field.prototype.unregisterPlugin=function(a){var b=a.getTrogClassId();if(!this.plugins_[b]){this.logger.severe("Cannot unregister a plugin that isn't registered.")}delete this.plugins_[b];for(var d in goog.editor.Plugin.OPCODE){var c=goog.editor.Plugin.OPCODE[d];if(a[c]){goog.array.remove(this.indexedPlugins_[d],a)}}a.unregisterFieldObject(this)};goog.editor.Field.prototype.setInitialStyle=function(a){this.cssText=a};goog.editor.Field.prototype.resetOriginalElemProperties=function(){var b=this.getOriginalElement();b.removeAttribute("contentEditable");b.removeAttribute("g_editable");if(!this.id){b.removeAttribute("id")}else{b.id=this.id}b.className=this.savedClassName_||"";var a=this.cssText;if(!a){b.removeAttribute("style")}else{goog.dom.setProperties(b,{style:a})}if(goog.isString(this.originalFieldLineHeight_)){goog.style.setStyle(b,"lineHeight",this.originalFieldLineHeight_);this.originalFieldLineHeight_=null}};goog.editor.Field.prototype.isModified=function(a){return a?this.isEverModified_:this.isModified_};goog.editor.Field.CHANGE_FREQUENCY=15;goog.editor.Field.DELAYED_CHANGE_FREQUENCY=250;goog.editor.Field.prototype.usesIframe=goog.functions.TRUE;goog.editor.Field.prototype.isFixedHeight=goog.functions.TRUE;goog.editor.Field.KEYS_CAUSING_CHANGES_={46:true,8:true};if(!goog.userAgent.IE){goog.editor.Field.KEYS_CAUSING_CHANGES_[9]=true}goog.editor.Field.CTRL_KEYS_CAUSING_CHANGES_={86:true,88:true};if(goog.userAgent.IE){goog.editor.Field.KEYS_CAUSING_CHANGES_[229]=true}goog.editor.Field.isGeneratingKey_=function(b,a){if(goog.editor.Field.isSpecialGeneratingKey_(b)){return true}return !!(a&&!(b.ctrlKey||b.metaKey)&&(!goog.userAgent.GECKO||b.charCode))};goog.editor.Field.isSpecialGeneratingKey_=function(b){var c=(b.ctrlKey||b.metaKey)&&b.keyCode in goog.editor.Field.CTRL_KEYS_CAUSING_CHANGES_;var a=!(b.ctrlKey||b.metaKey)&&b.keyCode in goog.editor.Field.KEYS_CAUSING_CHANGES_;return c||a};goog.editor.Field.prototype.setAppWindow=function(a){this.appWindow_=a};goog.editor.Field.prototype.getAppWindow=function(){return this.appWindow_};goog.editor.Field.prototype.setBaseZindex=function(a){this.baseZindex_=a};goog.editor.Field.prototype.getBaseZindex=function(){return this.baseZindex_||0};goog.editor.Field.prototype.setupFieldObject=function(a){this.loadState_=goog.editor.Field.LoadState_.EDITABLE;this.field=a;this.editableDomHelper=goog.dom.getDomHelper(a);this.isModified_=false;this.isEverModified_=false;a.setAttribute("g_editable","true")};goog.editor.Field.prototype.tearDownFieldObject_=function(){this.loadState_=goog.editor.Field.LoadState_.UNEDITABLE;for(var b in this.plugins_){var a=this.plugins_[b];if(!a.activeOnUneditableFields()){a.disable(this)}}this.field=null;this.editableDomHelper=null};goog.editor.Field.prototype.setupChangeListeners_=function(){if(goog.userAgent.OPERA&&this.usesIframe()){this.boundFocusListenerOpera_=goog.bind(this.dispatchFocusAndBeforeFocus_,this);this.boundBlurListenerOpera_=goog.bind(this.dispatchBlur,this);var a=this.getEditableDomHelper().getWindow();a.addEventListener(goog.events.EventType.FOCUS,this.boundFocusListenerOpera_,false);a.addEventListener(goog.events.EventType.BLUR,this.boundBlurListenerOpera_,false)}else{if(goog.editor.BrowserFeature.SUPPORTS_FOCUSIN){this.addListener(goog.events.EventType.FOCUS,this.dispatchFocus_);this.addListener(goog.events.EventType.FOCUSIN,this.dispatchBeforeFocus_)}else{this.addListener(goog.events.EventType.FOCUS,this.dispatchFocusAndBeforeFocus_)}this.addListener(goog.events.EventType.BLUR,this.dispatchBlur,goog.editor.BrowserFeature.USE_MUTATION_EVENTS)}if(goog.editor.BrowserFeature.USE_MUTATION_EVENTS){this.setupMutationEventHandlersGecko()}else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.dispatchBeforeChange);this.addListener(["cut","paste"],goog.functions.lock(this.dispatchChange));this.addListener("drop",this.handleDrop_)}var b=goog.userAgent.WEBKIT?"dragend":"dragdrop";this.addListener(b,this.handleDrop_);this.addListener(goog.events.EventType.KEYDOWN,this.handleKeyDown_);this.addListener(goog.events.EventType.KEYPRESS,this.handleKeyPress_);this.addListener(goog.events.EventType.KEYUP,this.handleKeyUp_);this.selectionChangeTimer_=new goog.async.Delay(this.handleSelectionChangeTimer_,goog.editor.Field.SELECTION_CHANGE_FREQUENCY_,this);if(goog.editor.BrowserFeature.FOLLOWS_EDITABLE_LINKS){this.addListener(goog.events.EventType.CLICK,goog.editor.Field.cancelLinkClick_)}this.addListener(goog.events.EventType.MOUSEDOWN,this.handleMouseDown_);this.addListener(goog.events.EventType.MOUSEUP,this.handleMouseUp_)};goog.editor.Field.SELECTION_CHANGE_FREQUENCY_=250;goog.editor.Field.prototype.clearListeners=function(){if(this.eventRegister){this.eventRegister.removeAll()}if(goog.userAgent.OPERA&&this.usesIframe()){try{var b=this.getEditableDomHelper().getWindow();b.removeEventListener(goog.events.EventType.FOCUS,this.boundFocusListenerOpera_,false);b.removeEventListener(goog.events.EventType.BLUR,this.boundBlurListenerOpera_,false)}catch(a){}delete this.boundFocusListenerOpera_;delete this.boundBlurListenerOpera_}if(this.changeTimerGecko_){this.changeTimerGecko_.stop()}this.delayedChangeTimer_.stop()};goog.editor.Field.prototype.disposeInternal=function(){if(this.isLoading()||this.isLoaded()){this.logger.warning("Disposing a field that is in use.")}if(this.getOriginalElement()){this.execCommand(goog.editor.Command.CLEAR_LOREM)}this.tearDownFieldObject_();this.clearListeners();this.clearFieldLoadListener_();this.originalDomHelper=null;if(this.eventRegister){this.eventRegister.dispose();this.eventRegister=null}this.removeAllWrappers();if(goog.editor.Field.getActiveFieldId()==this.id){goog.editor.Field.setActiveFieldId(null)}for(var b in this.plugins_){var a=this.plugins_[b];if(a.isAutoDispose()){a.dispose()}}delete (this.plugins_);goog.editor.Field.superClass_.disposeInternal.call(this)};goog.editor.Field.prototype.attachWrapper=function(a){this.wrappers_.push(a)};goog.editor.Field.prototype.removeAllWrappers=function(){var a;while(a=this.wrappers_.pop()){a.dispose()}};goog.editor.Field.MUTATION_EVENTS_GECKO=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];goog.editor.Field.prototype.setupMutationEventHandlersGecko=function(){if(goog.editor.BrowserFeature.HAS_DOM_SUBTREE_MODIFIED_EVENT){this.eventRegister.listen(this.getElement(),"DOMSubtreeModified",this.handleMutationEventGecko_)}else{var a=this.getEditableDomHelper().getDocument();this.eventRegister.listen(a,goog.editor.Field.MUTATION_EVENTS_GECKO,this.handleMutationEventGecko_,true);this.eventRegister.listen(a,"DOMAttrModified",goog.bind(this.handleDomAttrChange,this,this.handleMutationEventGecko_),true)}};goog.editor.Field.prototype.handleBeforeChangeKeyEvent_=function(a){var b=(a.keyCode==goog.events.KeyCodes.TAB&&!this.dispatchBeforeTab_(a))||(goog.userAgent.GECKO&&a.metaKey&&(a.keyCode==goog.events.KeyCodes.LEFT||a.keyCode==goog.events.KeyCodes.RIGHT));if(b){a.preventDefault();return false}else{this.gotGeneratingKey_=a.charCode||goog.editor.Field.isGeneratingKey_(a,goog.userAgent.GECKO);if(this.gotGeneratingKey_){this.dispatchBeforeChange()}}return true};goog.editor.Field.SELECTION_CHANGE_KEYCODES_={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1};goog.editor.Field.CTRL_KEYS_CAUSING_SELECTION_CHANGES_={65:true,86:true,88:true};goog.editor.Field.POTENTIAL_SHORTCUT_KEYCODES_={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};goog.editor.Field.prototype.invokeShortCircuitingOp_=function(f,e){var a=this.indexedPlugins_[f];var b=goog.array.slice(arguments,1);for(var c=0;c<a.length;++c){var d=a[c];if((d.isEnabled(this)||goog.editor.Plugin.IRREPRESSIBLE_OPS[f])&&d[goog.editor.Plugin.OPCODE[f]].apply(d,b)){return true}}return false};goog.editor.Field.prototype.invokeOp_=function(f,e){var a=this.indexedPlugins_[f];var b=goog.array.slice(arguments,1);for(var c=0;c<a.length;++c){var d=a[c];if(d.isEnabled(this)||goog.editor.Plugin.IRREPRESSIBLE_OPS[f]){d[goog.editor.Plugin.OPCODE[f]].apply(d,b)}}};goog.editor.Field.prototype.reduceOp_=function(g,a,f){var b=this.indexedPlugins_[g];var c=goog.array.slice(arguments,1);for(var d=0;d<b.length;++d){var e=b[d];if(e.isEnabled(this)||goog.editor.Plugin.IRREPRESSIBLE_OPS[g]){c[0]=e[goog.editor.Plugin.OPCODE[g]].apply(e,c)}}return c[0]};goog.editor.Field.prototype.injectContents=function(c,d){var b={};var a=this.getInjectableContents(c,b);goog.style.setStyle(d,b);d.innerHTML=a};goog.editor.Field.prototype.getInjectableContents=function(b,a){return this.reduceOp_(goog.editor.Plugin.Op.PREPARE_CONTENTS_HTML,b||"",a)};goog.editor.Field.prototype.handleKeyDown_=function(a){if(!goog.editor.BrowserFeature.USE_MUTATION_EVENTS){if(!this.handleBeforeChangeKeyEvent_(a)){return}}if(!this.invokeShortCircuitingOp_(goog.editor.Plugin.Op.KEYDOWN,a)&&goog.editor.BrowserFeature.USES_KEYDOWN){this.handleKeyboardShortcut_(a)}};goog.editor.Field.prototype.handleKeyPress_=function(a){if(goog.editor.BrowserFeature.USE_MUTATION_EVENTS){if(!this.handleBeforeChangeKeyEvent_(a)){return}}else{this.gotGeneratingKey_=true;this.dispatchBeforeChange()}if(!this.invokeShortCircuitingOp_(goog.editor.Plugin.Op.KEYPRESS,a)&&!goog.editor.BrowserFeature.USES_KEYDOWN){this.handleKeyboardShortcut_(a)}};goog.editor.Field.prototype.handleKeyUp_=function(a){if(!goog.editor.BrowserFeature.USE_MUTATION_EVENTS&&(this.gotGeneratingKey_||goog.editor.Field.isSpecialGeneratingKey_(a))){this.handleChange()}this.invokeShortCircuitingOp_(goog.editor.Plugin.Op.KEYUP,a);if(this.isEventStopped(goog.editor.Field.EventType.SELECTIONCHANGE)){return}if(goog.editor.Field.SELECTION_CHANGE_KEYCODES_[a.keyCode]||((a.ctrlKey||a.metaKey)&&goog.editor.Field.CTRL_KEYS_CAUSING_SELECTION_CHANGES_[a.keyCode])){this.selectionChangeTimer_.start()}};goog.editor.Field.prototype.handleKeyboardShortcut_=function(d){if(d.altKey){return}var b=goog.userAgent.MAC?d.metaKey:d.ctrlKey;if(b||goog.editor.Field.POTENTIAL_SHORTCUT_KEYCODES_[d.keyCode]){var a=d.charCode||d.keyCode;if(a==17){return}var c=String.fromCharCode(a).toLowerCase();if(this.invokeShortCircuitingOp_(goog.editor.Plugin.Op.SHORTCUT,d,c,b)){d.preventDefault()}}};goog.editor.Field.prototype.execCommand=function(g,f){var c=arguments;var a;var b=this.indexedPlugins_[goog.editor.Plugin.Op.EXEC_COMMAND];for(var d=0;d<b.length;++d){var e=b[d];if(e.isEnabled(this)&&e.isSupportedCommand(g)){a=e.execCommand.apply(e,c);break}}return a};goog.editor.Field.prototype.queryCommandValue=function(a){var b=this.isLoaded()&&this.isSelectionEditable();if(goog.isString(a)){return this.queryCommandValueInternal_(a,b)}else{var d={};for(var c=0;c<a.length;c++){d[a[c]]=this.queryCommandValueInternal_(a[c],b)}return d}};goog.editor.Field.prototype.queryCommandValueInternal_=function(e,b){var a=this.indexedPlugins_[goog.editor.Plugin.Op.QUERY_COMMAND];for(var c=0;c<a.length;++c){var d=a[c];if(d.isEnabled(this)&&d.isSupportedCommand(e)&&(b||d.activeOnUneditableFields())){return d.queryCommandValue(e)}}return b?null:false};goog.editor.Field.prototype.handleDomAttrChange=function(a,d){if(this.isEventStopped(goog.editor.Field.EventType.CHANGE)){return}var c=d.getBrowserEvent();try{if(c.originalTarget.prefix||c.originalTarget.nodeName=="scrollbar"){return}}catch(b){return}if(c.prevValue==c.newValue){return}a.call(this,c)};goog.editor.Field.prototype.handleMutationEventGecko_=function(a){if(this.isEventStopped(goog.editor.Field.EventType.CHANGE)){return}a=a.getBrowserEvent?a.getBrowserEvent():a;if(a.target.firebugIgnore){return}this.isModified_=true;this.isEverModified_=true;this.changeTimerGecko_.start()};goog.editor.Field.prototype.handleDrop_=function(a){if(goog.userAgent.IE){this.execCommand(goog.editor.Command.CLEAR_LOREM,true)}if(goog.editor.BrowserFeature.USE_MUTATION_EVENTS){this.dispatchFocusAndBeforeFocus_()}this.dispatchChange()};goog.editor.Field.prototype.getEditableIframe=function(){var a;if(this.usesIframe()&&(a=this.getEditableDomHelper())){var b=a.getWindow();return(b&&b.frameElement)}return null};goog.editor.Field.prototype.getEditableDomHelper=function(){return this.editableDomHelper};goog.editor.Field.prototype.getRange=function(){var a=this.editableDomHelper&&this.editableDomHelper.getWindow();return a&&goog.dom.Range.createFromWindow(a)};goog.editor.Field.prototype.dispatchSelectionChangeEvent=function(d,c){if(this.isEventStopped(goog.editor.Field.EventType.SELECTIONCHANGE)){return}var a=this.getRange();var b=a&&a.getContainerElement();this.isSelectionEditable_=!!b&&goog.dom.contains(this.getElement(),b);this.dispatchCommandValueChange();this.dispatchEvent({type:goog.editor.Field.EventType.SELECTIONCHANGE,originalType:d&&d.type});this.invokeShortCircuitingOp_(goog.editor.Plugin.Op.SELECTION,d,c)};goog.editor.Field.prototype.handleSelectionChangeTimer_=function(){var a=this.selectionChangeTarget_;this.selectionChangeTarget_=null;this.dispatchSelectionChangeEvent(undefined,a)};goog.editor.Field.prototype.dispatchBeforeChange=function(){if(this.isEventStopped(goog.editor.Field.EventType.BEFORECHANGE)){return}this.dispatchEvent(goog.editor.Field.EventType.BEFORECHANGE)};goog.editor.Field.prototype.dispatchBeforeTab_=function(a){return this.dispatchEvent({type:goog.editor.Field.EventType.BEFORETAB,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.ctrlKey})};goog.editor.Field.prototype.stopChangeEvents=function(a,b){if(a){if(this.changeTimerGecko_){this.changeTimerGecko_.fireIfActive()}this.stopEvent(goog.editor.Field.EventType.CHANGE)}if(b){this.clearDelayedChange();this.stopEvent(goog.editor.Field.EventType.DELAYEDCHANGE)}};goog.editor.Field.prototype.startChangeEvents=function(b,a){if(!b&&this.changeTimerGecko_){this.changeTimerGecko_.fireIfActive()}this.startEvent(goog.editor.Field.EventType.CHANGE);this.startEvent(goog.editor.Field.EventType.DELAYEDCHANGE);if(b){this.handleChange()}if(a){this.dispatchDelayedChange_()}};goog.editor.Field.prototype.stopEvent=function(a){this.stoppedEvents_[a]=1};goog.editor.Field.prototype.startEvent=function(a){this.stoppedEvents_[a]=0};goog.editor.Field.prototype.debounceEvent=function(a){this.debouncedEvents_[a]=goog.now()};goog.editor.Field.prototype.isEventStopped=function(a){return !!this.stoppedEvents_[a]||(this.debouncedEvents_[a]&&(goog.now()-this.debouncedEvents_[a]<=goog.editor.Field.DEBOUNCE_TIME_MS_))};goog.editor.Field.prototype.manipulateDom=function(b,a,c){this.stopChangeEvents(true,true);try{b.call(c)}finally{if(this.isLoaded()){if(a){this.startEvent(goog.editor.Field.EventType.CHANGE);this.handleChange();this.startEvent(goog.editor.Field.EventType.DELAYEDCHANGE)}else{this.dispatchChange()}}}};goog.editor.Field.prototype.dispatchCommandValueChange=function(a){if(a){this.dispatchEvent({type:goog.editor.Field.EventType.COMMAND_VALUE_CHANGE,commands:a})}else{this.dispatchEvent(goog.editor.Field.EventType.COMMAND_VALUE_CHANGE)}};goog.editor.Field.prototype.dispatchChange=function(a){this.startChangeEvents(true,a)};goog.editor.Field.prototype.handleChange=function(){if(this.isEventStopped(goog.editor.Field.EventType.CHANGE)){return}if(this.changeTimerGecko_){this.changeTimerGecko_.stop()}this.isModified_=true;this.isEverModified_=true;if(this.isEventStopped(goog.editor.Field.EventType.DELAYEDCHANGE)){return}this.delayedChangeTimer_.start()};goog.editor.Field.prototype.dispatchDelayedChange_=function(){if(this.isEventStopped(goog.editor.Field.EventType.DELAYEDCHANGE)){return}this.delayedChangeTimer_.stop();this.isModified_=false;this.dispatchEvent(goog.editor.Field.EventType.DELAYEDCHANGE)};goog.editor.Field.prototype.clearDelayedChange=function(){if(this.changeTimerGecko_){this.changeTimerGecko_.fireIfActive()}this.delayedChangeTimer_.fireIfActive()};goog.editor.Field.prototype.dispatchFocusAndBeforeFocus_=function(){this.dispatchBeforeFocus_();this.dispatchFocus_()};goog.editor.Field.prototype.dispatchBeforeFocus_=function(){if(this.isEventStopped(goog.editor.Field.EventType.BEFOREFOCUS)){return}this.execCommand(goog.editor.Command.CLEAR_LOREM,true);this.dispatchEvent(goog.editor.Field.EventType.BEFOREFOCUS)};goog.editor.Field.prototype.dispatchFocus_=function(){if(this.isEventStopped(goog.editor.Field.EventType.FOCUS)){return}goog.editor.Field.setActiveFieldId(this.id);this.isSelectionEditable_=true;this.dispatchEvent(goog.editor.Field.EventType.FOCUS);if(goog.editor.BrowserFeature.PUTS_CURSOR_BEFORE_FIRST_BLOCK_ELEMENT_ON_FOCUS){var c=this.getElement();var a=this.getRange();if(a){var d=a.getFocusNode();if(a.getFocusOffset()==0&&(!d||d==c||d.tagName==goog.dom.TagName.BODY)){goog.editor.range.selectNodeStart(c)}}}if(!goog.editor.BrowserFeature.CLEARS_SELECTION_WHEN_FOCUS_LEAVES&&this.usesIframe()){var b=this.getEditableDomHelper().getWindow().parent;b.getSelection().removeAllRanges()}};goog.editor.Field.prototype.dispatchBlur=function(){if(this.isEventStopped(goog.editor.Field.EventType.BLUR)){return}if(goog.editor.Field.getActiveFieldId()==this.id){goog.editor.Field.setActiveFieldId(null)}this.isSelectionEditable_=false;this.dispatchEvent(goog.editor.Field.EventType.BLUR)};goog.editor.Field.prototype.isSelectionEditable=function(){return this.isSelectionEditable_};goog.editor.Field.cancelLinkClick_=function(a){if(goog.dom.getAncestorByTagNameAndClass((a.target),goog.dom.TagName.A)){a.preventDefault()}};goog.editor.Field.prototype.handleMouseDown_=function(b){if(!goog.editor.Field.getActiveFieldId()){goog.editor.Field.setActiveFieldId(this.id)}if(goog.userAgent.IE){var a=b.target;if(a&&a.tagName==goog.dom.TagName.A&&b.ctrlKey){this.originalDomHelper.getWindow().open(a.href)}}};goog.editor.Field.prototype.handleMouseUp_=function(a){this.dispatchSelectionChangeEvent(a);if(goog.userAgent.IE){this.selectionChangeTarget_=(a.target);this.selectionChangeTimer_.start()}};goog.editor.Field.prototype.getCleanContents=function(){if(this.queryCommandValue(goog.editor.Command.USING_LOREM)){return goog.string.Unicode.NBSP}if(!this.isLoaded()){var b=this.getOriginalElement();if(!b){this.logger.shout("Couldn't get the field element to read the contents")}return b.innerHTML}var a=this.getFieldCopy();this.invokeOp_(goog.editor.Plugin.Op.CLEAN_CONTENTS_DOM,a);return this.reduceOp_(goog.editor.Plugin.Op.CLEAN_CONTENTS_HTML,a.innerHTML)};goog.editor.Field.prototype.getFieldCopy=function(){var c=this.getElement();var b=(c.cloneNode(false));var a=c.innerHTML;if(goog.userAgent.IE&&a.match(/^\s*<script/i)){a=goog.string.Unicode.NBSP+a}b.innerHTML=a;return b};goog.editor.Field.prototype.setHtml=function(a,c,b,d){if(this.isLoading()){this.logger.severe("Can't set html while loading Trogedit");return}if(d){this.execCommand(goog.editor.Command.CLEAR_LOREM)}if(c&&a){c="<p>"+c+"</p>"}if(b){this.stopChangeEvents(false,true)}this.setInnerHtml_(c);if(d){this.execCommand(goog.editor.Command.UPDATE_LOREM)}if(this.isLoaded()){if(b){if(goog.editor.BrowserFeature.USE_MUTATION_EVENTS){this.changeTimerGecko_.fireIfActive()}this.startChangeEvents()}else{this.dispatchChange()}}};goog.editor.Field.prototype.setInnerHtml_=function(b){var d=this.getElement();if(d){if(this.usesIframe()&&goog.editor.BrowserFeature.MOVES_STYLE_TO_HEAD){var c=d.ownerDocument.getElementsByTagName("HEAD");for(var a=c.length-1;a>=1;--a){c[a].parentNode.removeChild(c[a])}}}else{d=this.getOriginalElement()}if(d){this.injectContents(b,d)}};goog.editor.Field.prototype.turnOnDesignModeGecko=function(){var a=this.getEditableDomHelper().getDocument();a.designMode="on";if(goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS){a.execCommand("styleWithCSS",false,false)}};goog.editor.Field.prototype.installStyles=function(){if(this.cssStyles&&this.shouldLoadAsynchronously()){goog.style.installStyles(this.cssStyles,this.getElement())}};goog.editor.Field.prototype.dispatchLoadEvent_=function(){var a=this.getElement();if(this.workaroundClassName_){goog.dom.classes.add(a,this.workaroundClassName_)}this.installStyles();this.startChangeEvents();this.logger.info("Dispatching load "+this.id);this.dispatchEvent(goog.editor.Field.EventType.LOAD)};goog.editor.Field.prototype.isUneditable=function(){return this.loadState_==goog.editor.Field.LoadState_.UNEDITABLE};goog.editor.Field.prototype.isLoaded=function(){return this.loadState_==goog.editor.Field.LoadState_.EDITABLE};goog.editor.Field.prototype.isLoading=function(){return this.loadState_==goog.editor.Field.LoadState_.LOADING};goog.editor.Field.prototype.focus=function(){if(!goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE){this.getEditableDomHelper().getWindow().focus()}else{if(goog.userAgent.OPERA){var b=this.appWindow_.pageXOffset;var a=this.appWindow_.pageYOffset}this.getElement().focus();if(goog.userAgent.OPERA){this.appWindow_.scrollTo((b),(a))}}};goog.editor.Field.prototype.focusAndPlaceCursorAtStart=function(){if(goog.editor.BrowserFeature.HAS_IE_RANGES||goog.userAgent.WEBKIT){this.placeCursorAtStart()}this.focus()};goog.editor.Field.prototype.placeCursorAtStart=function(){this.placeCursorAtStartOrEnd_(true)};goog.editor.Field.prototype.placeCursorAtEnd=function(){this.placeCursorAtStartOrEnd_(false)};goog.editor.Field.prototype.placeCursorAtStartOrEnd_=function(b){var c=this.getElement();if(c){var a=b?goog.editor.node.getLeftMostLeaf(c):goog.editor.node.getRightMostLeaf(c);if(c==a){goog.dom.Range.createCaret(c,0).select()}else{goog.editor.range.placeCursorNextTo(a,b)}this.dispatchSelectionChangeEvent()}};goog.editor.Field.prototype.makeEditable=function(b){this.loadState_=goog.editor.Field.LoadState_.LOADING;var a=this.getOriginalElement();this.nodeName=a.nodeName;this.savedClassName_=a.className;this.setInitialStyle(a.style.cssText);a.className+=" editable";this.makeEditableInternal(b)};goog.editor.Field.prototype.makeEditableInternal=function(a){this.makeIframeField_(a)};goog.editor.Field.prototype.handleFieldLoad=function(){if(goog.userAgent.IE){goog.dom.Range.clearSelection(this.editableDomHelper.getWindow())}if(goog.editor.Field.getActiveFieldId()!=this.id){this.execCommand(goog.editor.Command.UPDATE_LOREM)}this.setupChangeListeners_();this.dispatchLoadEvent_();for(var a in this.plugins_){this.plugins_[a].enable(this)}};goog.editor.Field.prototype.makeUneditable=function(a){if(this.isUneditable()){throw Error("makeUneditable: Field is already uneditable")}this.clearDelayedChange();this.selectionChangeTimer_.fireIfActive();this.execCommand(goog.editor.Command.CLEAR_LOREM);var b=null;if(!a&&this.getElement()){b=this.getCleanContents()}this.clearFieldLoadListener_();var c=this.getOriginalElement();if(goog.editor.Field.getActiveFieldId()==c.id){goog.editor.Field.setActiveFieldId(null)}this.clearListeners();if(goog.isString(b)){c.innerHTML=b;this.resetOriginalElemProperties()}this.restoreDom();this.tearDownFieldObject_();if(goog.userAgent.WEBKIT){c.blur()}this.execCommand(goog.editor.Command.UPDATE_LOREM);this.dispatchEvent(goog.editor.Field.EventType.UNLOAD)};goog.editor.Field.prototype.restoreDom=function(){var b=this.getOriginalElement();if(b){var a=this.getEditableIframe();if(a){goog.dom.replaceNode(b,a)}}};goog.editor.Field.prototype.shouldLoadAsynchronously=function(){if(!goog.isDef(this.isHttps_)){this.isHttps_=false;if(goog.userAgent.IE&&this.usesIframe()){var b=this.originalDomHelper.getWindow();while(b!=b.parent){try{b=b.parent}catch(a){break}}var c=b.location;this.isHttps_=c.protocol=="https:"&&c.search.indexOf("nocheckhttps")==-1}}return this.isHttps_};goog.editor.Field.prototype.makeIframeField_=function(f){var e=this.getOriginalElement();if(e){var a=e.innerHTML;var d={};a=this.reduceOp_(goog.editor.Plugin.Op.PREPARE_CONTENTS_HTML,a,d);var c=(this.originalDomHelper.createDom(goog.dom.TagName.IFRAME,this.getIframeAttributes()));if(this.shouldLoadAsynchronously()){var b=goog.bind(this.iframeFieldLoadHandler,this,c,a,d);this.fieldLoadListenerKey_=goog.events.listen(c,goog.events.EventType.LOAD,b,true);if(f){c.src=f}}this.attachIframe(c);if(!this.shouldLoadAsynchronously()){this.iframeFieldLoadHandler(c,a,d)}}};goog.editor.Field.prototype.attachIframe=function(a){var b=this.getOriginalElement();a.className=b.className;a.id=b.id;goog.dom.replaceNode(a,b)};goog.editor.Field.prototype.getFieldFormatInfo=function(c){var a=this.getOriginalElement();var b=goog.editor.node.isStandardsMode(a);return new goog.editor.icontent.FieldFormatInfo(this.id,b,false,false,c)};goog.editor.Field.prototype.writeIframeContent=function(b,a,c){var f=this.getFieldFormatInfo(c);if(this.shouldLoadAsynchronously()){var d=goog.dom.getFrameContentDocument(b);goog.editor.icontent.writeHttpsInitialIframe(f,d,a)}else{var e=new goog.editor.icontent.FieldStyleInfo(this.getElement(),this.cssStyles);goog.editor.icontent.writeNormalInitialIframe(f,a,e,b)}};goog.editor.Field.prototype.iframeFieldLoadHandler=function(c,b,d){this.clearFieldLoadListener_();c.allowTransparency="true";this.writeIframeContent(c,b,d);var e=goog.dom.getFrameContentDocument(c);var a=e.body;this.setupFieldObject(a);if(!goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE){this.turnOnDesignModeGecko()}this.handleFieldLoad()};goog.editor.Field.prototype.clearFieldLoadListener_=function(){if(this.fieldLoadListenerKey_){goog.events.unlistenByKey(this.fieldLoadListenerKey_);this.fieldLoadListenerKey_=null}};goog.editor.Field.prototype.getIframeAttributes=function(){var a="padding:0;"+this.getOriginalElement().style.cssText;if(!goog.string.endsWith(a,";")){a+=";"}a+="background-color:white;";if(goog.userAgent.IE){a+="overflow:visible;"}return{frameBorder:0,style:a}};goog.provide("goog.cssom");goog.provide("goog.cssom.CssRuleType");goog.require("goog.array");goog.require("goog.dom");goog.cssom.CssRuleType={STYLE:1,IMPORT:3,MEDIA:4,FONT_FACE:5,PAGE:6,NAMESPACE:7};goog.cssom.getAllCssText=function(a){var b=a||document.styleSheets;return(goog.cssom.getAllCss_(b,true))};goog.cssom.getAllCssStyleRules=function(a){var b=a||document.styleSheets;return(goog.cssom.getAllCss_(b,false))};goog.cssom.getCssRulesFromStyleSheet=function(c){var a=null;try{a=c.rules||c.cssRules}catch(b){if(b.code==15){b.styleSheet=c;throw b}}return a};goog.cssom.getAllCssStyleSheets=function(f,b){var c=[];var j=f||document.styleSheets;var g=goog.isDef(b)?b:false;if(j.imports&&j.imports.length){for(var h=0,d=j.imports.length;h<d;h++){goog.array.extend(c,goog.cssom.getAllCssStyleSheets(j.imports[h]))}}else{if(j.length){for(var h=0,d=j.length;h<d;h++){goog.array.extend(c,goog.cssom.getAllCssStyleSheets(j[h]))}}else{var e=goog.cssom.getCssRulesFromStyleSheet(j);if(e&&e.length){for(var h=0,d=e.length,a;h<d;h++){a=e[h];if(a.styleSheet){goog.array.extend(c,goog.cssom.getAllCssStyleSheets(a.styleSheet))}}}}}if((j.type||j.rules||j.cssRules)&&(!j.disabled||g)){c.push(j)}return c};goog.cssom.getCssTextFromCssRule=function(b){var c="";if(b.cssText){c=b.cssText}else{if(b.style&&b.style.cssText&&b.selectorText){var a=b.style.cssText.replace(/\s*-closure-parent-stylesheet:\s*\[object\];?\s*/gi,"").replace(/\s*-closure-rule-index:\s*[\d]+;?\s*/gi,"");var d=b.selectorText+" { "+a+" }";c=d}}return c};goog.cssom.getCssRuleIndexInParentStyleSheet=function(c,a){if(c.style&&c.style["-closure-rule-index"]){return c.style["-closure-rule-index"]}var g=a||goog.cssom.getParentStyleSheet(c);if(!g){throw Error("Cannot find a parentStyleSheet.")}var e=goog.cssom.getCssRulesFromStyleSheet(g);if(e&&e.length){for(var b=0,f=e.length,d;b<f;b++){d=e[b];if(d==c){return b}}}return -1};goog.cssom.getParentStyleSheet=function(a){return a.parentStyleSheet||a.style["-closure-parent-stylesheet"]};goog.cssom.replaceCssRule=function(c,d,a,e){var f=a||goog.cssom.getParentStyleSheet(c);if(f){var b=e>=0?e:goog.cssom.getCssRuleIndexInParentStyleSheet(c,f);if(b>=0){goog.cssom.removeCssRule(f,b);goog.cssom.addCssRule(f,d,b)}else{throw Error("Cannot proceed without the index of the cssRule.")}}else{throw Error("Cannot proceed without the parentStyleSheet.")}};goog.cssom.addCssRule=function(h,d,g){var b=g;if(b<0||b==undefined){var f=h.rules||h.cssRules;b=f.length}if(h.insertRule){h.insertRule(d,b)}else{var e=/^([^\{]+)\{([^\{]+)\}/.exec(d);if(e.length==3){var a=e[1];var c=e[2];h.addRule(a,c,b)}else{throw Error("Your CSSRule appears to be ill-formatted.")}}};goog.cssom.removeCssRule=function(b,a){if(b.deleteRule){b.deleteRule(a)}else{b.removeRule(a)}};goog.cssom.addCssText=function(f,d){var a=d?d.getDocument():goog.dom.getDocument();var b=a.createElement("style");b.type="text/css";var e=a.getElementsByTagName("head")[0];e.appendChild(b);if(b.styleSheet){b.styleSheet.cssText=f}else{var c=a.createTextNode(f);b.appendChild(c)}return b};goog.cssom.getFileNameFromStyleSheet=function(d){var b=d.href;if(!b){return null}var c=/([^\/\?]+)[^\/]*$/.exec(b);var a=c[1];return a};goog.cssom.getAllCss_=function(k,h){var l=[];var m=goog.cssom.getAllCssStyleSheets(k);for(var f=0;k=m[f];f++){var c=goog.cssom.getCssRulesFromStyleSheet(k);if(c&&c.length){if(!h){var d=0}for(var e=0,b=c.length,a;e<b;e++){a=c[e];if(h&&!a.href){var g=goog.cssom.getCssTextFromCssRule(a);l.push(g)}else{if(!a.href){if(a.style){if(!a.parentStyleSheet){a.style["-closure-parent-stylesheet"]=k}a.style["-closure-rule-index"]=d}l.push(a)}}if(!h){d++}}}}return h?l.join(" "):l};goog.provide("goog.cssom.iframe.style");goog.require("goog.cssom");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.classes");goog.require("goog.string");goog.require("goog.style");goog.require("goog.userAgent");goog.cssom.iframe.style.selectorPartAnchorRegex_=/a(:(link|visited|active|hover))?/;goog.cssom.iframe.style.SELECTOR_DELIMITER_=",";goog.cssom.iframe.style.SELECTOR_PART_DELIMITER_=" ";goog.cssom.iframe.style.DECLARATION_START_DELIMITER_="{";goog.cssom.iframe.style.DECLARATION_END_DELIMITER_="}\n";goog.cssom.iframe.style.CssRuleSet_=function(){this.declarationText="";this.selectors=[]};goog.cssom.iframe.style.CssRuleSet_.prototype.initializeFromCssRule=function(d){var f=d.style;if(!f){return false}var b;var e;if(f&&(b=d.selectorText)&&(e=f.cssText)){if(goog.userAgent.IE){e+="/* */"}}else{if(d.cssText){var a=/([^\{]+)\{/;var c=/\}[^\}]*$/g;b=a.exec(d.cssText)[1];e=d.cssText.replace(a,"").replace(c,"")}}if(b){this.setSelectorsFromString(b);this.declarationText=e;return true}return false};goog.cssom.iframe.style.CssRuleSet_.prototype.setSelectorsFromString=function(d){this.selectors=[];var c=d.split(/,\s*/gm);for(var b=0;b<c.length;b++){var a=c[b];if(a.length>0){this.selectors.push(new goog.cssom.iframe.style.CssSelector_(a))}}};goog.cssom.iframe.style.CssRuleSet_.prototype.clone=function(){var a=new goog.cssom.iframe.style.CssRuleSet_();a.selectors=this.selectors.concat();a.declarationText=this.declarationText;return a};goog.cssom.iframe.style.CssRuleSet_.prototype.setDeclarationTextFromObject=function(e,b){var a=[];for(var d in e){var c=e[d];if(c){a.push(d,":",c,(b?" !important":""),";")}}this.declarationText=a.join("")};goog.cssom.iframe.style.CssRuleSet_.prototype.writeToArray=function(h){var d=this.selectors.length;var f=false;for(var b=0;b<d;b++){var e=this.selectors[b].parts;var g=e.length;for(var a=0;a<g;a++){h.push(e[a].inputString_,goog.cssom.iframe.style.SELECTOR_PART_DELIMITER_)}if(b<(d-1)){h.push(goog.cssom.iframe.style.SELECTOR_DELIMITER_)}if(goog.userAgent.GECKO&&!goog.userAgent.isVersion("1.9a")){f=f||goog.cssom.iframe.style.selectorPartAnchorRegex_.test(e[g-1].inputString_)}}var c=this.declarationText;if(f){c=goog.cssom.iframe.style.makeColorRuleImportant_(c)}h.push(goog.cssom.iframe.style.DECLARATION_START_DELIMITER_,c,goog.cssom.iframe.style.DECLARATION_END_DELIMITER_)};goog.cssom.iframe.style.colorImportantReplaceRegex_=/(^|;|{)\s*color:([^;]+);/g;goog.cssom.iframe.style.makeColorRuleImportant_=function(a){return a.replace(goog.cssom.iframe.style.colorImportantReplaceRegex_,"$1 color: $2 ! important; ")};goog.cssom.iframe.style.CssSelector_=function(a){this.parts_=[];this.ancestryMatchCache_={};if(a){this.setPartsFromString_(a)}};goog.cssom.iframe.style.CssSelector_.prototype.setPartsFromString_=function(c){var d=[];var e=c.split(/\s+/gm);for(var b=0;b<e.length;b++){if(!e[b]){continue}var a=new goog.cssom.iframe.style.CssSelectorPart_(e[b]);d.push(a)}this.parts=d};goog.cssom.iframe.style.CssSelector_.prototype.matchElementAncestry=function(j){var h=j.uid;if(this.ancestryMatchCache_[h]){return this.ancestryMatchCache_[h]}var c=0;var g=null;var e=null;var a=null;var k=j.nodes;var b=k.length;for(var f=0;f<=this.parts.length;f++){e=this.parts[f];while(c<b){var d=k[c];if(e&&e.testElement(d)){g={elementIndex:c,selectorPartIndex:f};c++;break}else{if(a&&a.testElement(d)){g={elementIndex:c,selectorPartIndex:f-1}}}c++}a=e}this.ancestryMatchCache_[h]=g;return g};goog.cssom.iframe.style.CssSelectorPart_=function(e){var f=goog.cssom.iframe.style.CssSelectorPart_.instances_[e];if(f){return f}var a;if(e.match(/[#\.]/)){a=e.split(/(?=[#\.])/)}else{a=[e]}var d={};for(var c=0;c<a.length;c++){var b=a[c];if(b.charAt(0)=="."){d.className=b.substring(1,b.length)}else{if(b.charAt(0)=="#"){d.id=b.substring(1,b.length)}else{d.tagName=b.toUpperCase()}}}this.inputString_=e;this.matchProperties_=d;this.testedElements_={};goog.cssom.iframe.style.CssSelectorPart_.instances_[e]=this};goog.cssom.iframe.style.CssSelectorPart_.instances_={};goog.cssom.iframe.style.CssSelectorPart_.prototype.testElement=function(d){var h=d.uid;var c=this.testedElements_[h];if(typeof c!="undefined"){return c}var g=this.matchProperties_;var e=g.tagName;var f=g.className;var b=g.id;var a=true;if(e&&e!="*"&&e!=d.nodeName){a=false}else{if(b&&b!=d.id){a=false}else{if(f&&!d.classNames[f]){a=false}}}this.testedElements_[h]=a;return a};goog.cssom.iframe.style.NodeAncestry_=function(d){var f=d;var e=goog.getUid(f);var c=goog.cssom.iframe.style.NodeAncestry_.instances_[e];if(c){return c}var b=[];do{var k={id:f.id,nodeName:f.nodeName};k.uid=goog.getUid(k);var j=f.className;var g={};if(j){var a=goog.dom.classes.get(f);for(var h=0;h<a.length;h++){g[a[h]]=1}}k.classNames=g;b.unshift(k)}while(f=f.parentNode);this.nodes=b;this.uid=goog.getUid(this);goog.cssom.iframe.style.NodeAncestry_.instances_[e]=this};goog.cssom.iframe.style.NodeAncestry_.instances_={};goog.cssom.iframe.style.resetDomCache=function(){goog.cssom.iframe.style.NodeAncestry_.instances_={}};goog.cssom.iframe.style.getRuleSetsFromDocument_=function(h){var b=[];var k=goog.cssom.getAllCssStyleSheets(h.styleSheets);for(var d=0,g;g=k[d];d++){var e=goog.cssom.getCssRulesFromStyleSheet(g);if(e&&e.length){for(var c=0,a=e.length;c<a;c++){var f=new goog.cssom.iframe.style.CssRuleSet_();if(f.initializeFromCssRule(e[c])){b.push(f)}}}}return b};goog.cssom.iframe.style.ruleSetCache_={};goog.cssom.iframe.style.ruleSetCache_.ruleSetCache_={};goog.cssom.iframe.style.ruleSetCache_.loadRuleSetsForDocument=function(b){var a=goog.getUid(b);goog.cssom.iframe.style.ruleSetCache_.ruleSetCache_[a]=goog.cssom.iframe.style.getRuleSetsFromDocument_(b)};goog.cssom.iframe.style.ruleSetCache_.getRuleSetsForDocument=function(d){var c=goog.getUid(d);var a=goog.cssom.iframe.style.ruleSetCache_.ruleSetCache_;if(!a[c]){goog.cssom.iframe.style.ruleSetCache_.loadRuleSetsForDocument(d)}var e=a[c];var f=[];for(var b=0;b<e.length;b++){f.push(e[b].clone())}return f};goog.cssom.iframe.style.inheritedProperties_=["color","visibility","quotes","list-style-type","list-style-image","list-style-position","list-style","page-break-inside","orphans","widows","font-family","font-style","font-variant","font-weight","text-indent","text-align","text-transform","white-space","caption-side","border-collapse","border-spacing","empty-cells","cursor"];goog.cssom.iframe.style.textProperties_=["font-family","font-size","font-weight","font-variant","font-style","color","text-align","text-decoration","text-indent","text-transform","letter-spacing","white-space","word-spacing"];goog.cssom.iframe.style.getElementContext=function(b,v,d){var q=b.ownerDocument;if(v){goog.cssom.iframe.style.ruleSetCache_.loadRuleSetsForDocument(q)}var u=goog.cssom.iframe.style.ruleSetCache_.getRuleSetsForDocument(q);var g=new goog.cssom.iframe.style.NodeAncestry_(b);var o=new goog.cssom.iframe.style.CssSelectorPart_("body");for(var z=0;z<u.length;z++){var a=u[z];var e=a.selectors;var s=e.length;for(var w=0;w<s;w++){var x=e[w];var h=x.matchElementAncestry(g);if(h){var t=h.selectorPartIndex;var r=x.parts;var B=r.length-1;var y;if(h.elementIndex==g.nodes.length-1||t<B){var m=r.concat();m.splice(0,t+1,o);y=new goog.cssom.iframe.style.CssSelector_();y.parts=m;e.push(y)}else{if(t>0&&t==B){y=new goog.cssom.iframe.style.CssSelector_();y.parts=[o,r[B]];e.push(y)}}}}}var D=new goog.cssom.iframe.style.CssRuleSet_();var G=[];var f=goog.cssom.iframe.style.getComputedStyleObject_(b);var E=new goog.cssom.iframe.style.CssSelector_();E.parts=[new goog.cssom.iframe.style.CssSelectorPart_("html")];D.selectors=[E];var C={};for(var z=0,c;c=goog.cssom.iframe.style.inheritedProperties_[z];z++){C[c]=f[goog.string.toCamelCase(c)]}D.setDeclarationTextFromObject(C);u.push(D);var F=new goog.cssom.iframe.style.CssRuleSet_();var p=new goog.cssom.iframe.style.CssSelector_();p.parts=[new goog.cssom.iframe.style.CssSelectorPart_("body")];var l={position:"relative",top:"0",left:"0",right:"auto",display:"block",visibility:"visible"};for(z=0,c;c=goog.cssom.iframe.style.textProperties_[z];z++){l[c]=f[goog.string.toCamelCase(c)]}if(d&&goog.cssom.iframe.style.isTransparentValue_(f.backgroundColor)){var k=goog.cssom.iframe.style.getBackgroundContext(b);l["background-color"]=k.backgroundColor;var n=f.backgroundImage;if(!n||n=="none"){l["background-image"]=k.backgroundImage;l["background-repeat"]=k.backgroundRepeat;l["background-position"]=k.backgroundPosition}}F.setDeclarationTextFromObject(l,true);F.selectors=[p];u.push(F);var A=[];s=u.length;for(z=0;z<s;z++){u[z].writeToArray(A)}return A.join("")};goog.cssom.iframe.style.isTransparentValue_=function(a){return a=="transparent"||a=="rgba(0, 0, 0, 0)"};goog.cssom.iframe.style.getComputedStyleObject_=function(a){return a.currentStyle||goog.dom.getOwnerDocument(a).defaultView.getComputedStyle(a,"")||{}};goog.cssom.iframe.style.valueWithUnitsRegEx_=/^(-?)([0-9]+)([a-z]*|%)/;goog.cssom.iframe.style.getBackgroundXYValues_=function(a){if(a.backgroundPositionY){return[a.backgroundPositionX,a.backgroundPositionY]}else{return(a.backgroundPosition||"0 0").split(" ")}};goog.cssom.iframe.style.getBackgroundContext=function(b){var m={backgroundImage:"none"};var s=b;var c;while((s=s.parentNode)&&s.nodeType==goog.dom.NodeType.ELEMENT){var d=goog.cssom.iframe.style.getComputedStyleObject_((s));var h=d.backgroundColor;if(!goog.cssom.iframe.style.isTransparentValue_(h)){m.backgroundColor=h}if(d.backgroundImage&&d.backgroundImage!="none"){m.backgroundImage=d.backgroundImage;m.backgroundRepeat=d.backgroundRepeat;var j;if(c){j=goog.style.getFramedPageOffset(b,c);var a=c.frameElement;var u=goog.style.getRelativePosition((a),(s));var f=goog.style.getBorderBox(a);j.x+=u.x+f.left;j.y+=u.y+f.top}else{j=goog.style.getRelativePosition(b,(s))}var r=goog.cssom.iframe.style.getBackgroundXYValues_(d);for(var n=0;n<2;n++){var g=r[n];var o=n==0?"X":"Y";var q="backgroundPosition"+o;var t=goog.cssom.iframe.style.valueWithUnitsRegEx_.exec(g);if(t){var k=parseInt(t[1]+t[2],10);var l=t[3];if(k==0||l=="px"){k-=(o=="X"?j.x:j.y)}g=k+l}m[q]=g}m.backgroundPosition=m.backgroundPositionX+" "+m.backgroundPositionY}if(m.backgroundColor){break}if(s.tagName==goog.dom.TagName.HTML){try{c=goog.dom.getWindow((s.parentNode));s=c.frameElement;if(!s){break}}catch(p){break}}}return m};goog.provide("goog.editor.SeamlessField");goog.require("goog.cssom.iframe.style");goog.require("goog.debug.Logger");goog.require("goog.dom");goog.require("goog.dom.Range");goog.require("goog.dom.TagName");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Field");goog.require("goog.editor.icontent");goog.require("goog.editor.icontent.FieldFormatInfo");goog.require("goog.editor.icontent.FieldStyleInfo");goog.require("goog.editor.node");goog.require("goog.events");goog.require("goog.events.EventType");goog.require("goog.style");goog.editor.SeamlessField=function(b,a){goog.editor.Field.call(this,b,a)};goog.inherits(goog.editor.SeamlessField,goog.editor.Field);goog.editor.SeamlessField.prototype.logger=goog.debug.Logger.getLogger("goog.editor.SeamlessField");goog.editor.SeamlessField.prototype.listenForDragOverEventKey_;goog.editor.SeamlessField.prototype.listenForIframeLoadEventKey_;goog.editor.SeamlessField.prototype.setMinHeight=function(a){if(a==this.minHeight_){return}this.minHeight_=a;if(this.usesIframe()){this.doFieldSizingGecko()}};goog.editor.SeamlessField.prototype.isFixedHeight_=false;goog.editor.SeamlessField.prototype.isFixedHeightOverridden_=false;goog.editor.SeamlessField.prototype.isFixedHeight=function(){return this.isFixedHeight_};goog.editor.SeamlessField.prototype.overrideFixedHeight=function(a){this.isFixedHeight_=a;this.isFixedHeightOverridden_=true};goog.editor.SeamlessField.prototype.autoDetectFixedHeight_=function(){if(!this.isFixedHeightOverridden_){var a=this.getOriginalElement();if(a){this.isFixedHeight_=goog.style.getComputedOverflowY(a)=="auto"}}};goog.editor.SeamlessField.prototype.handleOuterDocChange_=function(){if(this.isEventStopped(goog.editor.Field.EventType.CHANGE)){return}this.sizeIframeToWrapperGecko_()};goog.editor.SeamlessField.prototype.sizeIframeToBodyHeightGecko_=function(){if(this.acquireSizeIframeLockGecko_()){var b=this.getEditableIframe();if(b){var a=this.getIframeBodyHeightGecko_();if(this.minHeight_){a=Math.max(a,this.minHeight_)}if(parseInt(goog.style.getStyle(b,"height"),10)!=a){b.style.height=a+"px"}}this.releaseSizeIframeLockGecko_()}};goog.editor.SeamlessField.prototype.getIframeBodyHeightGecko_=function(){var d=this.getEditableIframe();var a=d.contentDocument.body;var c=a.parentNode;if(parseInt(goog.style.getStyle(d,"height"),10)===0){goog.style.setStyle(d,"height",1+"px")}var b;if(goog.editor.node.isStandardsMode(a)){b=c.offsetHeight}else{b=c.scrollHeight;if(c.clientHeight!=c.offsetHeight){b+=goog.editor.SeamlessField.getScrollbarWidth_()}}return b};goog.editor.SeamlessField.getScrollbarWidth_=function(){return goog.editor.SeamlessField.scrollbarWidth_||(goog.editor.SeamlessField.scrollbarWidth_=goog.style.getScrollbarWidth())};goog.editor.SeamlessField.prototype.sizeIframeToWrapperGecko_=function(){if(this.acquireSizeIframeLockGecko_()){var f=this.getEditableIframe();var e=this.getElement();if(f&&e){var d;var c=f.parentNode;var b=c.offsetWidth;if(parseInt(goog.style.getStyle(f,"width"),10)!=b){d=goog.style.getPaddingBox(e);f.style.width=b+"px";e.style.width=b-d.left-d.right+"px"}var a=c.offsetHeight;if(this.isFixedHeight()&&parseInt(goog.style.getStyle(f,"height"),10)!=a){if(!d){d=goog.style.getPaddingBox(e)}f.style.height=a+"px";e.style.height=a-d.top-d.bottom+"px"}}this.releaseSizeIframeLockGecko_()}};goog.editor.SeamlessField.prototype.doFieldSizingGecko=function(){if(this.getElement()){this.sizeIframeToWrapperGecko_();if(!this.isFixedHeight()){this.sizeIframeToBodyHeightGecko_()}}};goog.editor.SeamlessField.prototype.acquireSizeIframeLockGecko_=function(){if(this.sizeIframeLock_){return false}return this.sizeIframeLock_=true};goog.editor.SeamlessField.prototype.releaseSizeIframeLockGecko_=function(){this.sizeIframeLock_=false};goog.editor.SeamlessField.prototype.iframeableCss_="";goog.editor.SeamlessField.prototype.getIframeableCss=function(b){if(!this.iframeableCss_||b){var a=this.getOriginalElement();if(a){this.iframeableCss_=goog.cssom.iframe.style.getElementContext(a,b)}}return this.iframeableCss_};goog.editor.SeamlessField.prototype.setIframeableCss=function(a){this.iframeableCss_=a};goog.editor.SeamlessField.haveInstalledCss_=false;goog.editor.SeamlessField.prototype.inheritBlendedCSS=function(){if(!this.usesIframe()){return}var b=this.getElement();var a=goog.dom.getDomHelper(b).getElementsByTagNameAndClass("head")[0];if(a){goog.dom.removeChildren(a)}var c=this.getIframeableCss(true);goog.style.installStyles(c,b)};goog.editor.SeamlessField.prototype.usesIframe=function(){return !goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE};goog.editor.SeamlessField.prototype.setupMutationEventHandlersGecko=function(){goog.editor.SeamlessField.superClass_.setupMutationEventHandlersGecko.call(this);if(this.usesIframe()){var b=this.getEditableIframe();var a=b.ownerDocument;this.eventRegister.listen(a,goog.editor.Field.MUTATION_EVENTS_GECKO,this.handleOuterDocChange_,true);this.listenForIframeLoadEventKey_=goog.events.listenOnce(this.getEditableDomHelper().getWindow(),goog.events.EventType.LOAD,this.sizeIframeToBodyHeightGecko_,true,this);this.eventRegister.listen(a,"DOMAttrModified",goog.bind(this.handleDomAttrChange,this,this.handleOuterDocChange_),true)}};goog.editor.SeamlessField.prototype.handleChange=function(){if(this.isEventStopped(goog.editor.Field.EventType.CHANGE)){return}goog.editor.SeamlessField.superClass_.handleChange.call(this);if(this.usesIframe()){this.sizeIframeToBodyHeightGecko_()}};goog.editor.SeamlessField.prototype.dispatchBlur=function(){if(this.isEventStopped(goog.editor.Field.EventType.BLUR)){return}goog.editor.SeamlessField.superClass_.dispatchBlur.call(this);if(!goog.editor.BrowserFeature.HAS_CONTENT_EDITABLE&&!goog.editor.BrowserFeature.CLEARS_SELECTION_WHEN_FOCUS_LEAVES){var b=this.getEditableDomHelper().getWindow();var a=false;goog.events.unlistenByKey(this.listenForDragOverEventKey_);this.listenForDragOverEventKey_=goog.events.listenOnce(b.document.body,"dragover",function(){a=true});goog.global.setTimeout(goog.bind(function(){if(!a){if(this.editableDomHelper){var c=this.getRange();var d=this.editableDomHelper.getWindow();goog.dom.Range.clearSelection(d);if(c){c.collapse(true);c.select()}}}},this),0)}};goog.editor.SeamlessField.prototype.turnOnDesignModeGecko=function(){goog.editor.SeamlessField.superClass_.turnOnDesignModeGecko.call(this);var a=this.getEditableDomHelper().getDocument();a.execCommand("enableInlineTableEditing",false,"false");a.execCommand("enableObjectResizing",false,"false")};goog.editor.SeamlessField.prototype.installStyles=function(){if(!this.usesIframe()){if(!goog.editor.SeamlessField.haveInstalledCss_){if(this.cssStyles){goog.style.installStyles(this.cssStyles,this.getElement())}goog.editor.SeamlessField.haveInstalledCss_=true}}};goog.editor.SeamlessField.prototype.makeEditableInternal=function(b){if(this.usesIframe()){goog.editor.SeamlessField.superClass_.makeEditableInternal.call(this,b)}else{var a=this.getOriginalElement();if(a){this.setupFieldObject(a);a.contentEditable=true;this.injectContents(a.innerHTML,a);this.handleFieldLoad()}}};goog.editor.SeamlessField.prototype.handleFieldLoad=function(){if(this.usesIframe()){var a=this;goog.global.setTimeout(function(){a.doFieldSizingGecko()},0)}goog.editor.SeamlessField.superClass_.handleFieldLoad.call(this)};goog.editor.SeamlessField.prototype.getIframeAttributes=function(){return{frameBorder:0,style:"padding:0;"}};goog.editor.SeamlessField.prototype.attachIframe=function(c){this.autoDetectFixedHeight_();var h=this.getOriginalElement();var g=goog.dom.getDomHelper(h);var b=h.style.width;var k=h.style.height;goog.style.setStyle(h,"visibility","hidden");var l=g.createDom(goog.dom.TagName.DIV,{style:"height:0;clear:both",innerHTML:"&nbsp;"});var e=l.cloneNode(true);h.insertBefore(l,h.firstChild);goog.dom.appendChild(h,e);var f=goog.style.getContentBoxSize(h);var a=f.width;var j=f.height;var d="";if(this.isFixedHeight()){d="&nbsp;";goog.style.setStyle(h,"position","relative");goog.style.setStyle(h,"overflow","visible");goog.style.setStyle(c,"position","absolute");goog.style.setStyle(c,"top","0");goog.style.setStyle(c,"left","0")}goog.style.setSize(h,a,j);if(goog.editor.node.isStandardsMode(h)){this.originalFieldLineHeight_=h.style.lineHeight;goog.style.setStyle(h,"lineHeight","0")}h.innerHTML=d;goog.style.setSize(c,a,j);goog.style.setSize(h,b,k);goog.style.setStyle(h,"visibility","");goog.dom.appendChild(h,c);if(!this.shouldLoadAsynchronously()){var i=c.contentWindow.document;if(goog.editor.node.isStandardsMode(c.ownerDocument)){i.open();i.write("<!DOCTYPE HTML><html></html>");i.close()}}};goog.editor.SeamlessField.prototype.getFieldFormatInfo=function(b){var a=this.getOriginalElement();if(a){return new goog.editor.icontent.FieldFormatInfo(this.id,goog.editor.node.isStandardsMode(a),true,this.isFixedHeight(),b)}throw Error("no field")};goog.editor.SeamlessField.prototype.writeIframeContent=function(b,a,c){goog.style.setStyle(b,"visibility","hidden");var e=this.getFieldFormatInfo(c);var d=new goog.editor.icontent.FieldStyleInfo(this.getOriginalElement(),this.cssStyles+this.getIframeableCss());goog.editor.icontent.writeNormalInitialBlendedIframe(e,a,d,b);this.doFieldSizingGecko();goog.style.setStyle(b,"visibility","visible")};goog.editor.SeamlessField.prototype.restoreDom=function(){if(this.usesIframe()){goog.dom.removeNode(this.getEditableIframe())}};goog.editor.SeamlessField.prototype.clearListeners=function(){goog.events.unlistenByKey(this.listenForDragOverEventKey_);goog.events.unlistenByKey(this.listenForIframeLoadEventKey_);goog.base(this,"clearListeners")};goog.provide("goog.uri.utils");goog.provide("goog.uri.utils.ComponentIndex");goog.provide("goog.uri.utils.QueryArray");goog.provide("goog.uri.utils.QueryValue");goog.provide("goog.uri.utils.StandardQueryParam");goog.require("goog.asserts");goog.require("goog.string");goog.require("goog.userAgent");goog.uri.utils.CharCode_={AMPERSAND:38,EQUAL:61,HASH:35,QUESTION:63};goog.uri.utils.buildFromEncodedParts=function(h,f,e,g,b,a,d){var c=[];if(h){c.push(h,":")}if(e){c.push("//");if(f){c.push(f,"@")}c.push(e);if(g){c.push(":",g)}}if(b){c.push(b)}if(a){c.push("?",a)}if(d){c.push("#",d)}return c.join("")};goog.uri.utils.splitRe_=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");goog.uri.utils.ComponentIndex={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7};goog.uri.utils.split=function(a){return(a.match(goog.uri.utils.splitRe_))};goog.uri.utils.decodeIfPossible_=function(a){return a&&decodeURIComponent(a)};goog.uri.utils.getComponentByIndex_=function(a,b){return goog.uri.utils.split(b)[a]||null};goog.uri.utils.getScheme=function(a){return goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.SCHEME,a)};goog.uri.utils.getEffectiveScheme=function(b){var a=goog.uri.utils.getScheme(b);if(!a&&self.location){var c=self.location.protocol;a=c.substr(0,c.length-1)}return a?a.toLowerCase():""};goog.uri.utils.getUserInfoEncoded=function(a){return goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.USER_INFO,a)};goog.uri.utils.getUserInfo=function(a){return goog.uri.utils.decodeIfPossible_(goog.uri.utils.getUserInfoEncoded(a))};goog.uri.utils.getDomainEncoded=function(a){return goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.DOMAIN,a)};goog.uri.utils.getDomain=function(a){return goog.uri.utils.decodeIfPossible_(goog.uri.utils.getDomainEncoded(a))};goog.uri.utils.getPort=function(a){return Number(goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.PORT,a))||null};goog.uri.utils.getPathEncoded=function(a){return goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.PATH,a)};goog.uri.utils.getPath=function(a){return goog.uri.utils.decodeIfPossible_(goog.uri.utils.getPathEncoded(a))};goog.uri.utils.getQueryData=function(a){return goog.uri.utils.getComponentByIndex_(goog.uri.utils.ComponentIndex.QUERY_DATA,a)};goog.uri.utils.getFragmentEncoded=function(b){var a=b.indexOf("#");return a<0?null:b.substr(a+1)};goog.uri.utils.setFragmentEncoded=function(b,a){return goog.uri.utils.removeFragment(b)+(a?"#"+a:"")};goog.uri.utils.getFragment=function(a){return goog.uri.utils.decodeIfPossible_(goog.uri.utils.getFragmentEncoded(a))};goog.uri.utils.getHost=function(b){var a=goog.uri.utils.split(b);return goog.uri.utils.buildFromEncodedParts(a[goog.uri.utils.ComponentIndex.SCHEME],a[goog.uri.utils.ComponentIndex.USER_INFO],a[goog.uri.utils.ComponentIndex.DOMAIN],a[goog.uri.utils.ComponentIndex.PORT])};goog.uri.utils.getPathAndAfter=function(b){var a=goog.uri.utils.split(b);return goog.uri.utils.buildFromEncodedParts(null,null,null,null,a[goog.uri.utils.ComponentIndex.PATH],a[goog.uri.utils.ComponentIndex.QUERY_DATA],a[goog.uri.utils.ComponentIndex.FRAGMENT])};goog.uri.utils.removeFragment=function(b){var a=b.indexOf("#");return a<0?b:b.substr(0,a)};goog.uri.utils.haveSameDomain=function(d,c){var b=goog.uri.utils.split(d);var a=goog.uri.utils.split(c);return b[goog.uri.utils.ComponentIndex.DOMAIN]==a[goog.uri.utils.ComponentIndex.DOMAIN]&&b[goog.uri.utils.ComponentIndex.SCHEME]==a[goog.uri.utils.ComponentIndex.SCHEME]&&b[goog.uri.utils.ComponentIndex.PORT]==a[goog.uri.utils.ComponentIndex.PORT]};goog.uri.utils.assertNoFragmentsOrQueries_=function(a){if(goog.DEBUG&&(a.indexOf("#")>=0||a.indexOf("?")>=0)){throw Error("goog.uri.utils: Fragment or query identifiers are not supported: ["+a+"]")}};goog.uri.utils.QueryValue;goog.uri.utils.QueryArray;goog.uri.utils.appendQueryData_=function(a){if(a[1]){var d=(a[0]);var b=d.indexOf("#");if(b>=0){a.push(d.substr(b));a[0]=d=d.substr(0,b)}var c=d.indexOf("?");if(c<0){a[1]="?"}else{if(c==d.length-1){a[1]=undefined}}}return a.join("")};goog.uri.utils.appendKeyValuePairs_=function(b,d,c){if(goog.isArray(d)){goog.asserts.assertArray(d);for(var a=0;a<d.length;a++){goog.uri.utils.appendKeyValuePairs_(b,String(d[a]),c)}}else{if(d!=null){c.push("&",b,d===""?"":"=",goog.string.urlEncode(d))}}};goog.uri.utils.buildQueryDataBuffer_=function(a,b,d){goog.asserts.assert(Math.max(b.length-(d||0),0)%2==0,"goog.uri.utils: Key/value lists must be even in length.");for(var c=d||0;c<b.length;c+=2){goog.uri.utils.appendKeyValuePairs_(b[c],b[c+1],a)}return a};goog.uri.utils.buildQueryData=function(b,c){var a=goog.uri.utils.buildQueryDataBuffer_([],b,c);a[0]="";return a.join("")};goog.uri.utils.buildQueryDataBufferFromMap_=function(a,c){for(var b in c){goog.uri.utils.appendKeyValuePairs_(b,c[b],a)}return a};goog.uri.utils.buildQueryDataFromMap=function(b){var a=goog.uri.utils.buildQueryDataBufferFromMap_([],b);a[0]="";return a.join("")};goog.uri.utils.appendParams=function(a,b){return goog.uri.utils.appendQueryData_(arguments.length==2?goog.uri.utils.buildQueryDataBuffer_([a],arguments[1],0):goog.uri.utils.buildQueryDataBuffer_([a],arguments,1))};goog.uri.utils.appendParamsFromMap=function(a,b){return goog.uri.utils.appendQueryData_(goog.uri.utils.buildQueryDataBufferFromMap_([a],b))};goog.uri.utils.appendParam=function(b,a,c){return goog.uri.utils.appendQueryData_([b,"&",a,"=",goog.string.urlEncode(c)])};goog.uri.utils.findParam_=function(e,f,a,h){var d=f;var c=a.length;while((d=e.indexOf(a,d))>=0&&d<h){var g=e.charCodeAt(d-1);if(g==goog.uri.utils.CharCode_.AMPERSAND||g==goog.uri.utils.CharCode_.QUESTION){var b=e.charCodeAt(d+c);if(!b||b==goog.uri.utils.CharCode_.EQUAL||b==goog.uri.utils.CharCode_.AMPERSAND||b==goog.uri.utils.CharCode_.HASH){return d}}d+=c+1}return -1};goog.uri.utils.hashOrEndRe_=/#|$/;goog.uri.utils.hasParam=function(b,a){return goog.uri.utils.findParam_(b,0,a,b.search(goog.uri.utils.hashOrEndRe_))>=0};goog.uri.utils.getParamValue=function(c,a){var e=c.search(goog.uri.utils.hashOrEndRe_);var d=goog.uri.utils.findParam_(c,0,a,e);if(d<0){return null}else{var b=c.indexOf("&",d);if(b<0||b>e){b=e}d+=a.length+1;return goog.string.urlDecode(c.substr(d,b-d))}};goog.uri.utils.getParamValues=function(d,c){var f=d.search(goog.uri.utils.hashOrEndRe_);var b=0;var e;var a=[];while((e=goog.uri.utils.findParam_(d,b,c,f))>=0){b=d.indexOf("&",e);if(b<0||b>f){b=f}e+=c.length+1;a.push(goog.string.urlDecode(d.substr(e,b-e)))}return a};goog.uri.utils.trailingQueryPunctuationRe_=/[?&]($|#)/;goog.uri.utils.removeParam=function(d,b){var f=d.search(goog.uri.utils.hashOrEndRe_);var a=0;var e;var c=[];while((e=goog.uri.utils.findParam_(d,a,b,f))>=0){c.push(d.substring(a,e));a=Math.min((d.indexOf("&",e)+1)||f,f)}c.push(d.substr(a));return c.join("").replace(goog.uri.utils.trailingQueryPunctuationRe_,"$1")};goog.uri.utils.setParam=function(b,a,c){return goog.uri.utils.appendParam(goog.uri.utils.removeParam(b,a),a,c)};goog.uri.utils.appendPath=function(b,a){goog.uri.utils.assertNoFragmentsOrQueries_(b);if(goog.string.endsWith(b,"/")){b=b.substr(0,b.length-1)}if(goog.string.startsWith(a,"/")){a=a.substr(1)}return goog.string.buildString(b,"/",a)};goog.uri.utils.StandardQueryParam={RANDOM:"zx"};goog.uri.utils.makeUnique=function(a){return goog.uri.utils.setParam(a,goog.uri.utils.StandardQueryParam.RANDOM,goog.string.getRandomString())};goog.provide("goog.editor.Link");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.Range");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Command");goog.require("goog.editor.node");goog.require("goog.editor.range");goog.require("goog.string");goog.require("goog.string.Unicode");goog.require("goog.uri.utils");goog.editor.Link=function(b,a){this.anchor_=b;this.isNew_=a};goog.editor.Link.prototype.getAnchor=function(){return this.anchor_};goog.editor.Link.prototype.getCurrentText=function(){if(!this.currentText_){this.currentText_=goog.dom.getRawTextContent(this.getAnchor())}return this.currentText_};goog.editor.Link.prototype.isNew=function(){return this.isNew_};goog.editor.Link.prototype.initializeUrl=function(a){this.getAnchor().href=a};goog.editor.Link.prototype.removeLink=function(){goog.dom.flattenElement(this.anchor_);this.anchor_=null};goog.editor.Link.prototype.setTextAndUrl=function(e,f){var c=this.getAnchor();c.href=f;var d=this.getCurrentText();if(e!=d){var a=goog.editor.node.getLeftMostLeaf(c);if(a.nodeType==goog.dom.NodeType.TEXT){a=a.parentNode}if(goog.dom.getRawTextContent(a)!=d){a=c}goog.dom.removeChildren(a);var b=goog.dom.getDomHelper(a);goog.dom.appendChild(a,b.createTextNode(e));this.currentText_=null}this.isNew_=false};goog.editor.Link.prototype.placeCursorRightOf=function(){var b=this.getAnchor();if(goog.editor.BrowserFeature.GETS_STUCK_IN_LINKS){var c;var e=b.nextSibling;if(e&&e.nodeType==goog.dom.NodeType.TEXT&&(goog.string.startsWith(e.data,goog.string.Unicode.NBSP)||goog.string.startsWith(e.data," "))){c=e}else{var d=goog.dom.getDomHelper(b);c=d.createTextNode(goog.string.Unicode.NBSP);goog.dom.insertSiblingAfter(c,b)}var a=goog.dom.Range.createCaret(c,1);a.select()}else{goog.editor.range.placeCursorNextTo(b,false)}};goog.editor.Link.prototype.updateLinkDisplay_=function(b,a){this.initializeUrl(a);this.placeCursorRightOf();b.execCommand(goog.editor.Command.UPDATE_LINK_BUBBLE)};goog.editor.Link.prototype.finishLinkCreation=function(a){var b=this.getCurrentText();if(goog.editor.Link.isLikelyUrl(b)){if(b.search(/:/)<0){b="http://"+goog.string.trimLeft(b)}this.updateLinkDisplay_(a,b)}else{if(goog.editor.Link.isLikelyEmailAddress(b)){b="mailto:"+b;this.updateLinkDisplay_(a,b)}else{a.execCommand(goog.editor.Command.MODAL_LINK_EDITOR,this)}}};goog.editor.Link.createNewLink=function(b,a,c){var d=new goog.editor.Link(b,true);d.initializeUrl(a);if(c){b.target=c}return d};goog.editor.Link.isLikelyUrl=function(f){if(/\s/.test(f)){return false}if(goog.editor.Link.isLikelyEmailAddress(f)){return false}var e=false;if(!/^[^:\/?#.]+:/.test(f)){f="http://"+f;e=true}var d=goog.uri.utils.split(f);var a=d[goog.uri.utils.ComponentIndex.SCHEME];if(goog.array.indexOf(["mailto","aim"],a)!=-1){return true}var b=d[goog.uri.utils.ComponentIndex.DOMAIN];if(!b||(e&&b.indexOf(".")==-1)){return false}var c=d[goog.uri.utils.ComponentIndex.PATH];return !c||c.indexOf("/")==0};goog.editor.Link.LIKELY_EMAIL_ADDRESS_=new RegExp("^[\\w-]+(\\.[\\w-]+)*\\@([\\w-]+\\.)+(\\d+|\\w\\w+)$","i");goog.editor.Link.isLikelyEmailAddress=function(a){return goog.editor.Link.LIKELY_EMAIL_ADDRESS_.test(a)};goog.editor.Link.isMailto=function(a){return !!a&&goog.string.startsWith(a,"mailto:")};goog.provide("goog.ui.editor.messages");goog.ui.editor.messages.MSG_LINK_CAPTION=goog.getMsg("Link");goog.ui.editor.messages.MSG_EDIT_LINK=goog.getMsg("Edit Link");goog.ui.editor.messages.MSG_TEXT_TO_DISPLAY=goog.getMsg("Text to display:");goog.ui.editor.messages.MSG_LINK_TO=goog.getMsg("Link to:");goog.ui.editor.messages.MSG_ON_THE_WEB=goog.getMsg("Web address");goog.ui.editor.messages.MSG_ON_THE_WEB_TIP=goog.getMsg("Link to a page or file somewhere else on the web");goog.ui.editor.messages.MSG_TEST_THIS_LINK=goog.getMsg("Test this link");goog.ui.editor.messages.MSG_TR_LINK_EXPLANATION=goog.getMsg("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});goog.ui.editor.messages.MSG_WHAT_URL=goog.getMsg("To what URL should this link go?");goog.ui.editor.messages.MSG_EMAIL_ADDRESS=goog.getMsg("Email address");goog.ui.editor.messages.MSG_EMAIL_ADDRESS_TIP=goog.getMsg("Link to an email address");goog.ui.editor.messages.MSG_INVALID_EMAIL=goog.getMsg("Invalid email address");goog.ui.editor.messages.MSG_WHAT_EMAIL=goog.getMsg("To what email address should this link?");goog.ui.editor.messages.MSG_EMAIL_EXPLANATION=goog.getMsg("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});goog.ui.editor.messages.MSG_OPEN_IN_NEW_WINDOW=goog.getMsg("Open this link in a new window");goog.ui.editor.messages.MSG_IMAGE_CAPTION=goog.getMsg("Image");goog.provide("goog.editor.plugins.BasicTextFormatter");goog.provide("goog.editor.plugins.BasicTextFormatter.COMMAND");goog.require("goog.array");goog.require("goog.debug.Logger");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Link");goog.require("goog.editor.Plugin");goog.require("goog.editor.node");goog.require("goog.editor.range");goog.require("goog.iter");goog.require("goog.object");goog.require("goog.string");goog.require("goog.string.Unicode");goog.require("goog.style");goog.require("goog.ui.editor.messages");goog.require("goog.userAgent");goog.editor.plugins.BasicTextFormatter=function(){goog.editor.Plugin.call(this)};goog.inherits(goog.editor.plugins.BasicTextFormatter,goog.editor.Plugin);goog.editor.plugins.BasicTextFormatter.prototype.getTrogClassId=function(){return"BTF"};goog.editor.plugins.BasicTextFormatter.prototype.logger=goog.debug.Logger.getLogger("goog.editor.plugins.BasicTextFormatter");goog.editor.plugins.BasicTextFormatter.COMMAND={LINK:"+link",FORMAT_BLOCK:"+formatBlock",INDENT:"+indent",OUTDENT:"+outdent",STRIKE_THROUGH:"+strikeThrough",HORIZONTAL_RULE:"+insertHorizontalRule",SUBSCRIPT:"+subscript",SUPERSCRIPT:"+superscript",UNDERLINE:"+underline",BOLD:"+bold",ITALIC:"+italic",FONT_SIZE:"+fontSize",FONT_FACE:"+fontName",FONT_COLOR:"+foreColor",BACKGROUND_COLOR:"+backColor",ORDERED_LIST:"+insertOrderedList",UNORDERED_LIST:"+insertUnorderedList",JUSTIFY_CENTER:"+justifyCenter",JUSTIFY_FULL:"+justifyFull",JUSTIFY_RIGHT:"+justifyRight",JUSTIFY_LEFT:"+justifyLeft"};goog.editor.plugins.BasicTextFormatter.SUPPORTED_COMMANDS_=goog.object.transpose(goog.editor.plugins.BasicTextFormatter.COMMAND);goog.editor.plugins.BasicTextFormatter.prototype.isSupportedCommand=function(a){return a in goog.editor.plugins.BasicTextFormatter.SUPPORTED_COMMANDS_};goog.editor.plugins.BasicTextFormatter.prototype.getRange_=function(){return this.fieldObject.getRange()};goog.editor.plugins.BasicTextFormatter.prototype.getDocument_=function(){return this.getFieldDomHelper().getDocument()};goog.editor.plugins.BasicTextFormatter.prototype.execCommandInternal=function(f,e){var c,h,b,d;var a;var g=arguments[1];switch(f){case goog.editor.plugins.BasicTextFormatter.COMMAND.BACKGROUND_COLOR:if(!goog.isNull(g)){if(goog.editor.BrowserFeature.EATS_EMPTY_BACKGROUND_COLOR){this.applyBgColorManually_(g)}else{if(goog.userAgent.OPERA){this.execCommandHelper_("hiliteColor",g)}else{this.execCommandHelper_(f,g)}}}break;case goog.editor.plugins.BasicTextFormatter.COMMAND.LINK:a=this.toggleLink_(g);break;case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_CENTER:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_FULL:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_RIGHT:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_LEFT:this.justify_(f);break;default:if(goog.userAgent.IE&&f==goog.editor.plugins.BasicTextFormatter.COMMAND.FORMAT_BLOCK&&g){g="<"+g+">"}if(f==goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_COLOR&&goog.isNull(g)){break}switch(f){case goog.editor.plugins.BasicTextFormatter.COMMAND.INDENT:case goog.editor.plugins.BasicTextFormatter.COMMAND.OUTDENT:if(goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS){if(goog.userAgent.GECKO){h=true}if(goog.userAgent.OPERA){if(f==goog.editor.plugins.BasicTextFormatter.COMMAND.OUTDENT){h=!this.getDocument_().queryCommandEnabled("outdent")}else{h=true}}}case goog.editor.plugins.BasicTextFormatter.COMMAND.ORDERED_LIST:case goog.editor.plugins.BasicTextFormatter.COMMAND.UNORDERED_LIST:if(goog.editor.BrowserFeature.LEAVES_P_WHEN_REMOVING_LISTS&&this.queryCommandStateInternal_(this.getDocument_(),f)){b=this.fieldObject.queryCommandValue(goog.editor.Command.DEFAULT_TAG)!=goog.dom.TagName.P}else{if(!goog.editor.BrowserFeature.CAN_LISTIFY_BR){this.convertBreaksToDivs_()}}if(goog.userAgent.GECKO&&goog.editor.BrowserFeature.FORGETS_FORMATTING_WHEN_LISTIFYING&&!this.queryCommandValue(f)){d|=this.beforeInsertListGecko_()}case goog.editor.plugins.BasicTextFormatter.COMMAND.FORMAT_BLOCK:c=!!this.fieldObject.getPluginByClassId("Bidi");break;case goog.editor.plugins.BasicTextFormatter.COMMAND.SUBSCRIPT:case goog.editor.plugins.BasicTextFormatter.COMMAND.SUPERSCRIPT:if(goog.editor.BrowserFeature.NESTS_SUBSCRIPT_SUPERSCRIPT){this.applySubscriptSuperscriptWorkarounds_(f)}break;case goog.editor.plugins.BasicTextFormatter.COMMAND.UNDERLINE:case goog.editor.plugins.BasicTextFormatter.COMMAND.BOLD:case goog.editor.plugins.BasicTextFormatter.COMMAND.ITALIC:h=goog.userAgent.GECKO&&goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS&&this.queryCommandValue(f);break;case goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_COLOR:case goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_FACE:h=goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS&&goog.userAgent.GECKO}this.execCommandHelper_(f,g,c,!!h);if(d){this.getDocument_().execCommand("Delete",false,true)}if(b){this.getDocument_().execCommand("FormatBlock",false,"<div>")}}if(goog.userAgent.GECKO&&!this.fieldObject.inModalMode()){this.focusField_()}return a};goog.editor.plugins.BasicTextFormatter.prototype.focusField_=function(){this.getFieldDomHelper().getWindow().focus()};goog.editor.plugins.BasicTextFormatter.prototype.queryCommandValue=function(a){var b;switch(a){case goog.editor.plugins.BasicTextFormatter.COMMAND.LINK:return this.isNodeInState_(goog.dom.TagName.A);case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_CENTER:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_FULL:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_RIGHT:case goog.editor.plugins.BasicTextFormatter.COMMAND.JUSTIFY_LEFT:return this.isJustification_(a);case goog.editor.plugins.BasicTextFormatter.COMMAND.FORMAT_BLOCK:return goog.editor.plugins.BasicTextFormatter.getSelectionBlockState_(this.fieldObject.getRange());case goog.editor.plugins.BasicTextFormatter.COMMAND.INDENT:case goog.editor.plugins.BasicTextFormatter.COMMAND.OUTDENT:case goog.editor.plugins.BasicTextFormatter.COMMAND.HORIZONTAL_RULE:return false;case goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_SIZE:case goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_FACE:case goog.editor.plugins.BasicTextFormatter.COMMAND.FONT_COLOR:case goog.editor.plugins.BasicTextFormatter.COMMAND.BACKGROUND_COLOR:return this.queryCommandValueInternal_(this.getDocument_(),a,goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS&&goog.userAgent.GECKO);case goog.editor.plugins.BasicTextFormatter.COMMAND.UNDERLINE:case goog.editor.plugins.BasicTextFormatter.COMMAND.BOLD:case goog.editor.plugins.BasicTextFormatter.COMMAND.ITALIC:b=goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS&&goog.userAgent.GECKO;default:return this.queryCommandStateInternal_(this.getDocument_(),a,b)}};goog.editor.plugins.BasicTextFormatter.prototype.prepareContentsHtml=function(a){if(goog.editor.BrowserFeature.COLLAPSES_EMPTY_NODES&&a.match(/^\s*<script/i)){a="&nbsp;"+a}if(goog.editor.BrowserFeature.CONVERT_TO_B_AND_I_TAGS){a=a.replace(/<(\/?)strong([^\w])/gi,"<$1b$2");a=a.replace(/<(\/?)em([^\w])/gi,"<$1i$2")}return a};goog.editor.plugins.BasicTextFormatter.prototype.cleanContentsDom=function(c){var a=c.getElementsByTagName(goog.dom.TagName.IMG);for(var b=0,d;d=a[b];b++){if(goog.editor.BrowserFeature.SHOWS_CUSTOM_ATTRS_IN_INNER_HTML){d.removeAttribute("tabIndex");d.removeAttribute("tabIndexSet");goog.removeUid(d);d.oldTabIndex;if(d.oldTabIndex){d.tabIndex=d.oldTabIndex}}}};goog.editor.plugins.BasicTextFormatter.prototype.cleanContentsHtml=function(c){if(goog.editor.BrowserFeature.MOVES_STYLE_TO_HEAD){var f=this.fieldObject.getEditableDomHelper().getElementsByTagNameAndClass(goog.dom.TagName.HEAD);var h=[];var g=f.length;for(var b=1;b<g;++b){var e=f[b].getElementsByTagName(goog.dom.TagName.STYLE);var d=e.length;for(var a=0;a<d;++a){h.push(e[a].outerHTML)}}return h.join("")+c}return c};goog.editor.plugins.BasicTextFormatter.prototype.handleKeyboardShortcut=function(c,a,b){if(!b){return false}var d;switch(a){case"b":d=goog.editor.plugins.BasicTextFormatter.COMMAND.BOLD;break;case"i":d=goog.editor.plugins.BasicTextFormatter.COMMAND.ITALIC;break;case"u":d=goog.editor.plugins.BasicTextFormatter.COMMAND.UNDERLINE;break;case"s":return true}if(d){this.fieldObject.execCommand(d);return true}return false};goog.editor.plugins.BasicTextFormatter.BR_REGEXP_=goog.userAgent.IE?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi;goog.editor.plugins.BasicTextFormatter.prototype.convertBreaksToDivs_=function(){if(!goog.userAgent.IE&&!goog.userAgent.OPERA){return false}var b=this.getRange_();var c=b.getContainerElement();var g=this.getDocument_();goog.editor.plugins.BasicTextFormatter.BR_REGEXP_.lastIndex=0;if(goog.editor.plugins.BasicTextFormatter.BR_REGEXP_.test(c.innerHTML)){var a=b.saveUsingCarets();if(c.tagName==goog.dom.TagName.P){goog.editor.plugins.BasicTextFormatter.convertParagraphToDiv_(c,true)}else{var e="trtempbr";var f="temp_br";c.innerHTML=c.innerHTML.replace(goog.editor.plugins.BasicTextFormatter.BR_REGEXP_,"<p$1 "+e+'="'+f+'">');var d=goog.array.toArray(c.getElementsByTagName(goog.dom.TagName.P));goog.iter.forEach(d,function(i){if(i.getAttribute(e)==f){i.removeAttribute(e);if(goog.string.isBreakingWhitespace(goog.dom.getTextContent(i))){var h=goog.userAgent.IE?g.createTextNode(goog.string.Unicode.NBSP):g.createElement(goog.dom.TagName.BR);i.appendChild(h)}goog.editor.plugins.BasicTextFormatter.convertParagraphToDiv_(i)}})}a.restore();return true}return false};goog.editor.plugins.BasicTextFormatter.convertParagraphToDiv_=function(c,a){if(!goog.userAgent.IE&&!goog.userAgent.OPERA){return}var b=c.outerHTML.replace(/<(\/?)p/gi,"<$1div");if(a){b=b.replace(goog.editor.plugins.BasicTextFormatter.BR_REGEXP_,"</div><div$1>")}if(goog.userAgent.OPERA&&!/<\/div>$/i.test(b)){b+="</div>"}c.outerHTML=b};goog.editor.plugins.BasicTextFormatter.convertToRealExecCommand_=function(a){return a.indexOf("+")==0?a.substring(1):a};goog.editor.plugins.BasicTextFormatter.prototype.justify_=function(a){this.execCommandHelper_(a,null,false,true);if(goog.userAgent.GECKO){this.execCommandHelper_(a,null,false,true)}if(!(goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS&&goog.userAgent.GECKO)){goog.iter.forEach(this.fieldObject.getRange(),goog.editor.plugins.BasicTextFormatter.convertContainerToTextAlign_)}};goog.editor.plugins.BasicTextFormatter.convertContainerToTextAlign_=function(b){var a=goog.editor.style.getContainer(b);if(a.align){a.style.textAlign=a.align;a.removeAttribute("align")}};goog.editor.plugins.BasicTextFormatter.prototype.execCommandHelper_=function(b,e,g,i){var a=null;if(g){a=this.fieldObject.queryCommandValue(goog.editor.Command.DIR_RTL)?"rtl":this.fieldObject.queryCommandValue(goog.editor.Command.DIR_LTR)?"ltr":null}b=goog.editor.plugins.BasicTextFormatter.convertToRealExecCommand_(b);var c,f;if(goog.userAgent.IE){var d=this.applyExecCommandIEFixes_(b);c=d[0];f=d[1]}if(goog.userAgent.WEBKIT){c=this.applyExecCommandSafariFixes_(b)}if(goog.userAgent.GECKO){this.applyExecCommandGeckoFixes_(b)}if(goog.editor.BrowserFeature.DOESNT_OVERRIDE_FONT_SIZE_IN_STYLE_ATTR&&b.toLowerCase()=="fontsize"){this.removeFontSizeFromStyleAttrs_()}var h=this.getDocument_();if(i&&goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS){h.execCommand("styleWithCSS",false,true);if(goog.userAgent.OPERA){this.invalidateInlineCss_()}}h.execCommand(b,false,e);if(i&&goog.editor.BrowserFeature.HAS_STYLE_WITH_CSS){h.execCommand("styleWithCSS",false,false)}if(goog.userAgent.WEBKIT&&!goog.userAgent.isVersion("526")&&b.toLowerCase()=="formatblock"&&e&&/^[<]?h\d[>]?$/i.test(e)){this.cleanUpSafariHeadings_()}if(/insert(un)?orderedlist/i.test(b)){if(goog.userAgent.WEBKIT){this.fixSafariLists_()}if(goog.userAgent.IE){this.fixIELists_();if(f){goog.dom.removeNode(f)}}}if(c){goog.dom.removeNode(c)}if(a){this.fieldObject.execCommand(a)}};goog.editor.plugins.BasicTextFormatter.prototype.applyBgColorManually_=function(d){var c=goog.userAgent.GECKO;var b=this.fieldObject.getRange();var e;var f;if(b&&b.isCollapsed()){e=this.getFieldDomHelper().createTextNode(c?" ":"");var a=b.getStartNode();f=a.nodeType==goog.dom.NodeType.ELEMENT?a:a.parentNode;if(f.innerHTML==""){f.style.textIndent="-10000px";f.appendChild(e)}else{f=this.getFieldDomHelper().createDom("span",{style:"text-indent:-10000px"},e);b.replaceContentsWithNode(f)}goog.dom.Range.createFromNodeContents(e).select()}this.execCommandHelper_("hiliteColor",d,false,true);if(e){if(c){e.data=""}f.style.textIndent=""}};goog.editor.plugins.BasicTextFormatter.prototype.toggleLink_=function(f){if(!this.fieldObject.isSelectionEditable()){this.focusField_()}var c=this.getRange_();var e=c&&c.getContainerElement();var g=(goog.dom.getAncestorByTagNameAndClass(e,goog.dom.TagName.A));if(g&&goog.editor.node.isEditable(g)){goog.dom.flattenElement(g)}else{var b=this.createLink_(c,"/",f);if(b){if(!this.fieldObject.execCommand(goog.editor.Command.MODAL_LINK_EDITOR,b)){var d=this.fieldObject.getAppWindow().prompt(goog.ui.editor.messages.MSG_LINK_TO,"http://");if(d){b.setTextAndUrl(b.getCurrentText()||d,d);b.placeCursorRightOf()}else{var a=goog.editor.range.saveUsingNormalizedCarets(goog.dom.Range.createFromNodeContents(b.getAnchor()));b.removeLink();a.restore().select();return null}}return b}}return null};goog.editor.plugins.BasicTextFormatter.prototype.createLink_=function(a,c,f){var b=null;var e=a&&a.getContainerElement();if(e&&e.tagName==goog.dom.TagName.IMG){return null}if(a&&a.isCollapsed()){var g=a.getTextRange(0).getBrowserRangeObject();if(goog.editor.BrowserFeature.HAS_W3C_RANGES){b=this.getFieldDomHelper().createElement(goog.dom.TagName.A);g.insertNode(b)}else{if(goog.editor.BrowserFeature.HAS_IE_RANGES){g.pasteHTML("<a id='newLink'></a>");b=this.getFieldDomHelper().getElement("newLink");b.removeAttribute("id")}}}else{var h=goog.string.createUniqueString();this.execCommandHelper_("CreateLink",h);var d=function(k,j,i){if(goog.string.endsWith(k.href,h)){b=k}};goog.array.forEach(this.fieldObject.getElement().getElementsByTagName(goog.dom.TagName.A),d)}return goog.editor.Link.createNewLink((b),c,f)};goog.editor.plugins.BasicTextFormatter.brokenExecCommandsIE_={indent:1,outdent:1,insertOrderedList:1,insertUnorderedList:1,justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,ltr:1,rtl:1};goog.editor.plugins.BasicTextFormatter.blockquoteHatingCommandsIE_={insertOrderedList:1,insertUnorderedList:1};goog.editor.plugins.BasicTextFormatter.prototype.applySubscriptSuperscriptWorkarounds_=function(c){if(!this.queryCommandValue(c)){var a=(c==goog.editor.plugins.BasicTextFormatter.COMMAND.SUBSCRIPT?goog.editor.plugins.BasicTextFormatter.COMMAND.SUPERSCRIPT:goog.editor.plugins.BasicTextFormatter.COMMAND.SUBSCRIPT);var b=goog.editor.plugins.BasicTextFormatter.convertToRealExecCommand_(a);if(!this.queryCommandValue(a)){this.getDocument_().execCommand(b,false,null)}this.getDocument_().execCommand(b,false,null)}};goog.editor.plugins.BasicTextFormatter.prototype.removeFontSizeFromStyleAttrs_=function(){var a=goog.editor.range.expand(this.fieldObject.getRange(),this.fieldObject.getElement());goog.iter.forEach(goog.iter.filter(a,function(b,d,c){return c.isStartTag()&&a.containsNode(b)}),function(b){goog.style.setStyle(b,"font-size","");if(goog.userAgent.GECKO&&b.style.length==0&&b.getAttribute("style")!=null){b.removeAttribute("style")}})};goog.editor.plugins.BasicTextFormatter.prototype.applyExecCommandIEFixes_=function(c){var a=[];var e=null;var f=this.getRange_();var j=this.getFieldDomHelper();if(c in goog.editor.plugins.BasicTextFormatter.blockquoteHatingCommandsIE_){var n=f&&f.getContainerElement();if(n){var g=goog.dom.getElementsByTagNameAndClass(goog.dom.TagName.BLOCKQUOTE,null,n);var p;for(var d=0;d<g.length;d++){if(f.containsNode(g[d])){p=g[d];break}}var o=p||goog.dom.getAncestorByTagNameAndClass(n,"BLOCKQUOTE");if(o){e=j.createDom("div",{style:"height:0"});goog.dom.appendChild(o,e);a.push(e);if(p){f=goog.dom.Range.createFromNodes(p,0,e,0)}else{if(f.containsNode(e)){f=goog.dom.Range.createFromNodes(f.getStartNode(),f.getStartOffset(),e,0)}}f.select()}}}var h=this.fieldObject;if(!h.usesIframe()&&!e){if(c in goog.editor.plugins.BasicTextFormatter.brokenExecCommandsIE_){var l=h.getElement();if(f&&f.isCollapsed()&&!goog.dom.getFirstElementChild(l)){var m=f.getTextRange(0).getBrowserRangeObject();var b=m.duplicate();b.moveToElementText(l);b.collapse(false);if(b.isEqual(m)){var k=j.createTextNode(goog.string.Unicode.NBSP);l.appendChild(k);m.move("character",1);m.move("character",-1);m.select();a.push(k)}}e=j.createDom("div",{style:"height:0"});goog.dom.appendChild(l,e);a.push(e)}}return a};goog.editor.plugins.BasicTextFormatter.prototype.cleanUpSafariHeadings_=function(){goog.iter.forEach(this.getRange_(),function(a){if(a.className=="Apple-style-span"){a.style.fontSize="";a.style.fontWeight=""}})};goog.editor.plugins.BasicTextFormatter.prototype.fixSafariLists_=function(){var a=false;goog.iter.forEach(this.getRange_(),function(e){var c=e.tagName;if(c==goog.dom.TagName.UL||c==goog.dom.TagName.OL){if(!a){a=true;return}var d=goog.dom.getPreviousElementSibling(e);if(!d){return}var b=e.ownerDocument.createRange();b.setStartAfter(d);b.setEndBefore(e);if(!goog.string.isEmpty(b.toString())){return}if(d.nodeName==e.nodeName){while(d.lastChild){e.insertBefore(d.lastChild,e.firstChild)}d.parentNode.removeChild(d)}}})};goog.editor.plugins.BasicTextFormatter.orderedListTypes_={"1":1,a:1,A:1,i:1,I:1};goog.editor.plugins.BasicTextFormatter.unorderedListTypes_={disc:1,circle:1,square:1};goog.editor.plugins.BasicTextFormatter.prototype.fixIELists_=function(){var c=this.getRange_();var b=c&&c.getContainer();while(b&&b.tagName!=goog.dom.TagName.UL&&b.tagName!=goog.dom.TagName.OL){b=b.parentNode}if(b){b=b.parentNode}if(!b){return}var a=goog.array.toArray(b.getElementsByTagName(goog.dom.TagName.UL));goog.array.extend(a,goog.array.toArray(b.getElementsByTagName(goog.dom.TagName.OL)));goog.array.forEach(a,function(e){var d=e.type;if(d){var f=(e.tagName==goog.dom.TagName.UL?goog.editor.plugins.BasicTextFormatter.unorderedListTypes_:goog.editor.plugins.BasicTextFormatter.orderedListTypes_);if(!f[d]){e.type=""}}})};goog.editor.plugins.BasicTextFormatter.brokenExecCommandsSafari_={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1};goog.editor.plugins.BasicTextFormatter.hangingExecCommandWebkit_={insertOrderedList:1,insertUnorderedList:1};goog.editor.plugins.BasicTextFormatter.prototype.applyExecCommandSafariFixes_=function(b){var c;if(goog.editor.plugins.BasicTextFormatter.brokenExecCommandsSafari_[b]){c=this.getFieldDomHelper().createDom("div",{style:"height: 0"},"x");goog.dom.appendChild(this.fieldObject.getElement(),c)}if(goog.editor.plugins.BasicTextFormatter.hangingExecCommandWebkit_[b]){var a=this.fieldObject.getElement();c=this.getFieldDomHelper().createDom("div",{style:"height: 0"},"x");a.insertBefore(c,a.firstChild)}return c};goog.editor.plugins.BasicTextFormatter.prototype.applyExecCommandGeckoFixes_=function(f){if(goog.userAgent.isVersion("1.9")&&f.toLowerCase()=="formatblock"){var b=this.getRange_();var c=b.getStartNode();if(b.isCollapsed()&&c&&c.tagName==goog.dom.TagName.BODY){var a=b.getStartOffset();var d=c.childNodes[a];if(d&&d.tagName==goog.dom.TagName.BR){var e=b.getBrowserRangeObject();e.setStart(d,0);e.setEnd(d,0)}}}};goog.editor.plugins.BasicTextFormatter.prototype.invalidateInlineCss_=function(){var c=[];var b=this.fieldObject.getRange().getContainerElement();do{c.push(b)}while(b=b.parentNode);var a=goog.iter.chain(goog.iter.toIterator(this.fieldObject.getRange()),goog.iter.toIterator(c));var d=goog.iter.filter(a,goog.editor.style.isContainer);goog.iter.forEach(d,function(f){var e=f.style.outline;f.style.outline="0px solid red";f.style.outline=e})};goog.editor.plugins.BasicTextFormatter.prototype.beforeInsertListGecko_=function(){var b=this.fieldObject.queryCommandValue(goog.editor.Command.DEFAULT_TAG);if(b==goog.dom.TagName.P||b==goog.dom.TagName.DIV){return false}var c=this.getRange_();if(c.isCollapsed()&&(c.getContainer().nodeType!=goog.dom.NodeType.TEXT)){var a=this.getFieldDomHelper().createTextNode(goog.string.Unicode.NBSP);c.insertNode(a,false);goog.dom.Range.createFromNodeContents(a).select();return true}return false};goog.editor.plugins.BasicTextFormatter.getSelectionBlockState_=function(a){var b=null;goog.iter.forEach(a,function(f,g,e){if(!e.isEndTag()){var c=goog.editor.style.getContainer(f);var d=c.tagName;b=b||d;if(b!=d){b=null;throw goog.iter.StopIteration}e.skipTag()}});return b};goog.editor.plugins.BasicTextFormatter.SUPPORTED_JUSTIFICATIONS_={center:1,justify:1,right:1,left:1};goog.editor.plugins.BasicTextFormatter.prototype.isJustification_=function(c){var h=c.replace("+justify","").toLowerCase();if(h=="full"){h="justify"}var d=this.fieldObject.getPluginByClassId("Bidi");if(d){d.getSelectionAlignment;return h==d.getSelectionAlignment()}else{var f=this.getRange_();if(!f){return false}var j=f.getContainerElement();var b=goog.array.filter(j.childNodes,function(i){return goog.editor.node.isImportant(i)&&f.containsNode(i,true)});b=b.length?b:[j];for(var e=0;e<b.length;e++){var g=b[e];var a=goog.editor.style.getContainer((g));if(h!=goog.editor.plugins.BasicTextFormatter.getNodeJustification_(a)){return false}}return true}};goog.editor.plugins.BasicTextFormatter.getNodeJustification_=function(a){var b=goog.style.getComputedTextAlign(a);b=b.replace(/^-(moz|webkit)-/,"");if(!goog.editor.plugins.BasicTextFormatter.SUPPORTED_JUSTIFICATIONS_[b]){b=a.align||"left"}return(b)};goog.editor.plugins.BasicTextFormatter.prototype.isNodeInState_=function(d){var a=this.getRange_();var c=a&&a.getContainerElement();var b=goog.dom.getAncestorByTagNameAndClass(c,d);return !!b&&goog.editor.node.isEditable(b)};goog.editor.plugins.BasicTextFormatter.prototype.queryCommandStateInternal_=function(c,b,a){return(this.queryCommandHelper_(true,c,b,a))};goog.editor.plugins.BasicTextFormatter.prototype.queryCommandValueInternal_=function(c,b,a){return this.queryCommandHelper_(false,c,b,a)};goog.editor.plugins.BasicTextFormatter.prototype.queryCommandHelper_=function(c,f,e,b){e=goog.editor.plugins.BasicTextFormatter.convertToRealExecCommand_(e);if(b){var d=this.getDocument_();d.execCommand("styleWithCSS",false,true)}var a=c?f.queryCommandState(e):f.queryCommandValue(e);if(b){d.execCommand("styleWithCSS",false,false)}return a};goog.provide("goog.dom.NodeOffset");goog.require("goog.Disposable");goog.require("goog.dom.TagName");goog.dom.NodeOffset=function(c,d){goog.Disposable.call(this);this.offsetStack_=[];this.nameStack_=[];while(c&&c.nodeName!=goog.dom.TagName.BODY&&c!=d){var a=0;var b=c.previousSibling;while(b){b=b.previousSibling;++a}this.offsetStack_.unshift(a);this.nameStack_.unshift(c.nodeName);c=c.parentNode}};goog.inherits(goog.dom.NodeOffset,goog.Disposable);goog.dom.NodeOffset.prototype.toString=function(){var c=[];var a;for(var b=0;a=this.nameStack_[b];b++){c.push(this.offsetStack_[b]+","+a)}return c.join("\n")};goog.dom.NodeOffset.prototype.findTargetNode=function(d){var a;var c=d;for(var b=0;a=this.nameStack_[b];++b){c=c.childNodes[this.offsetStack_[b]];if(!c||c.nodeName!=a){return null}}return c};goog.dom.NodeOffset.prototype.disposeInternal=function(){delete this.offsetStack_;delete this.nameStack_};goog.provide("goog.editor.plugins.UndoRedoState");goog.require("goog.events.EventTarget");goog.editor.plugins.UndoRedoState=function(a){this.asynchronous_=a};goog.inherits(goog.editor.plugins.UndoRedoState,goog.events.EventTarget);goog.editor.plugins.UndoRedoState.ACTION_COMPLETED="action_completed";goog.editor.plugins.UndoRedoState.prototype.isAsynchronous=function(){return this.asynchronous_};goog.editor.plugins.UndoRedoState.prototype.undo=goog.abstractMethod;goog.editor.plugins.UndoRedoState.prototype.redo=goog.abstractMethod;goog.editor.plugins.UndoRedoState.prototype.equals=goog.abstractMethod;goog.provide("goog.editor.plugins.UndoRedoManager");goog.provide("goog.editor.plugins.UndoRedoManager.EventType");goog.require("goog.editor.plugins.UndoRedoState");goog.require("goog.events.EventTarget");goog.editor.plugins.UndoRedoManager=function(){goog.events.EventTarget.call(this);this.maxUndoDepth_=100;this.undoStack_=[];this.redoStack_=[];this.pendingActions_=[]};goog.inherits(goog.editor.plugins.UndoRedoManager,goog.events.EventTarget);goog.editor.plugins.UndoRedoManager.EventType={STATE_CHANGE:"state_change",STATE_ADDED:"state_added",BEFORE_UNDO:"before_undo",BEFORE_REDO:"before_redo"};goog.editor.plugins.UndoRedoManager.prototype.inProgressActionKey_=null;goog.editor.plugins.UndoRedoManager.prototype.setMaxUndoDepth=function(a){this.maxUndoDepth_=a};goog.editor.plugins.UndoRedoManager.prototype.addState=function(b){if(this.undoStack_.length==0||!b.equals(this.undoStack_[this.undoStack_.length-1])){this.undoStack_.push(b);if(this.undoStack_.length>this.maxUndoDepth_){this.undoStack_.shift()}var a=this.redoStack_.length;this.redoStack_.length=0;this.dispatchEvent({type:goog.editor.plugins.UndoRedoManager.EventType.STATE_ADDED,state:b});if(this.undoStack_.length==1||a){this.dispatchStateChange_()}}};goog.editor.plugins.UndoRedoManager.prototype.dispatchStateChange_=function(){this.dispatchEvent(goog.editor.plugins.UndoRedoManager.EventType.STATE_CHANGE)};goog.editor.plugins.UndoRedoManager.prototype.undo=function(){this.shiftState_(this.undoStack_,this.redoStack_)};goog.editor.plugins.UndoRedoManager.prototype.redo=function(){this.shiftState_(this.redoStack_,this.undoStack_)};goog.editor.plugins.UndoRedoManager.prototype.hasUndoState=function(){return this.undoStack_.length>0};goog.editor.plugins.UndoRedoManager.prototype.hasRedoState=function(){return this.redoStack_.length>0};goog.editor.plugins.UndoRedoManager.prototype.shiftState_=function(a,b){if(a.length){var c=a.pop();b.push(c);this.addAction_({type:a==this.undoStack_?goog.editor.plugins.UndoRedoManager.EventType.BEFORE_UNDO:goog.editor.plugins.UndoRedoManager.EventType.BEFORE_REDO,func:a==this.undoStack_?c.undo:c.redo,state:c});if(a.length==0||b.length==1){this.dispatchStateChange_()}}};goog.editor.plugins.UndoRedoManager.prototype.addAction_=function(a){this.pendingActions_.push(a);if(this.pendingActions_.length==1){this.doAction_()}};goog.editor.plugins.UndoRedoManager.prototype.doAction_=function(){if(this.inProgressActionKey_||this.pendingActions_.length==0){return}var a=this.pendingActions_.shift();var b={type:a.type,state:a.state};if(this.dispatchEvent(b)){if(a.state.isAsynchronous()){this.inProgressActionKey_=goog.events.listen(a.state,goog.editor.plugins.UndoRedoState.ACTION_COMPLETED,this.finishAction_,false,this);a.func.call(a.state)}else{a.func.call(a.state);this.doAction_()}}};goog.editor.plugins.UndoRedoManager.prototype.finishAction_=function(){goog.events.unlistenByKey((this.inProgressActionKey_));this.inProgressActionKey_=null;this.doAction_()};goog.editor.plugins.UndoRedoManager.prototype.clearHistory=function(){if(this.undoStack_.length>0||this.redoStack_.length>0){this.undoStack_.length=0;this.redoStack_.length=0;this.dispatchStateChange_()}};goog.editor.plugins.UndoRedoManager.prototype.undoPeek=function(){return this.undoStack_[this.undoStack_.length-1]};goog.editor.plugins.UndoRedoManager.prototype.redoPeek=function(){return this.redoStack_[this.redoStack_.length-1]};goog.provide("goog.editor.plugins.UndoRedo");goog.require("goog.debug.Logger");goog.require("goog.dom");goog.require("goog.dom.NodeOffset");goog.require("goog.dom.Range");goog.require("goog.editor.BrowserFeature");goog.require("goog.editor.Command");goog.require("goog.editor.Field.EventType");goog.require("goog.editor.Plugin");goog.require("goog.editor.plugins.UndoRedoManager");goog.require("goog.editor.plugins.UndoRedoState");goog.require("goog.events");goog.require("goog.events.EventHandler");goog.editor.plugins.UndoRedo=function(a){goog.editor.Plugin.call(this);this.setUndoRedoManager(a||new goog.editor.plugins.UndoRedoManager());this.eventHandlers_={};this.currentStates_={};this.initialFieldChange_=null;this.boundRestoreState_=goog.bind(this.restoreState,this)};goog.inherits(goog.editor.plugins.UndoRedo,goog.editor.Plugin);goog.editor.plugins.UndoRedo.prototype.logger=goog.debug.Logger.getLogger("goog.editor.plugins.UndoRedo");goog.editor.plugins.UndoRedo.prototype.inProgressUndo_=null;goog.editor.plugins.UndoRedo.prototype.undoManager_;goog.editor.plugins.UndoRedo.prototype.managerStateChangeKey_;goog.editor.plugins.UndoRedo.COMMAND={UNDO:"+undo",REDO:"+redo"};goog.editor.plugins.UndoRedo.SUPPORTED_COMMANDS_=goog.object.transpose(goog.editor.plugins.UndoRedo.COMMAND);goog.editor.plugins.UndoRedo.prototype.setMaxUndoDepth=function(a){this.undoManager_.setMaxUndoDepth(a)};goog.editor.plugins.UndoRedo.prototype.setUndoRedoManager=function(a){if(this.managerStateChangeKey_){goog.events.unlistenByKey(this.managerStateChangeKey_)}this.undoManager_=a;this.managerStateChangeKey_=(goog.events.listen(this.undoManager_,goog.editor.plugins.UndoRedoManager.EventType.STATE_CHANGE,this.dispatchCommandValueChange_,false,this))};goog.editor.plugins.UndoRedo.prototype.isSupportedCommand=function(a){return a in goog.editor.plugins.UndoRedo.SUPPORTED_COMMANDS_};goog.editor.plugins.UndoRedo.prototype.registerFieldObject=function(a){this.fieldObject=a};goog.editor.plugins.UndoRedo.prototype.unregisterFieldObject=function(a){this.disable(a);this.fieldObject=null};goog.editor.plugins.UndoRedo.prototype.getCurrentFieldObject=function(){return this.fieldObject};goog.editor.plugins.UndoRedo.prototype.getFieldObject=function(a){return this.fieldObject};goog.editor.plugins.UndoRedo.prototype.getCurrentEventTarget=function(){return this.fieldObject};goog.editor.plugins.UndoRedo.prototype.enable=function(b){if(this.isEnabled(b)){return}b.clearDelayedChange();var a=new goog.events.EventHandler(this);if(!goog.editor.BrowserFeature.USE_MUTATION_EVENTS){a.listen(b,goog.editor.Field.EventType.BEFORECHANGE,this.handleBeforeChange_)}a.listen(b,goog.editor.Field.EventType.DELAYEDCHANGE,this.handleDelayedChange_);a.listen(b,goog.editor.Field.EventType.BLUR,this.handleBlur_);this.eventHandlers_[b.getHashCode()]=a;this.updateCurrentState_(b)};goog.editor.plugins.UndoRedo.prototype.disable=function(b){b.clearDelayedChange();var a=this.eventHandlers_[b.getHashCode()];if(a){a.dispose();delete this.eventHandlers_[b.getHashCode()]}if(this.currentStates_[b.getHashCode()]){delete this.currentStates_[b.getHashCode()]}};goog.editor.plugins.UndoRedo.prototype.isEnabled=function(a){return !!this.eventHandlers_[a.getHashCode()]};goog.editor.plugins.UndoRedo.prototype.disposeInternal=function(){goog.editor.plugins.UndoRedo.superClass_.disposeInternal.call(this);for(var a in this.eventHandlers_){this.eventHandlers_[a].dispose();delete this.eventHandlers_[a]}this.fieldObject=null;if(this.undoManager_){this.undoManager_.dispose();delete this.undoManager_}};goog.editor.plugins.UndoRedo.prototype.getTrogClassId=function(){return"UndoRedo"};goog.editor.plugins.UndoRedo.prototype.execCommand=function(b,a){if(b==goog.editor.plugins.UndoRedo.COMMAND.UNDO){this.undoManager_.undo()}else{if(b==goog.editor.plugins.UndoRedo.COMMAND.REDO){this.undoManager_.redo()}}};goog.editor.plugins.UndoRedo.prototype.queryCommandValue=function(b){var a=null;if(b==goog.editor.plugins.UndoRedo.COMMAND.UNDO){a=this.undoManager_.hasUndoState()}else{if(b==goog.editor.plugins.UndoRedo.COMMAND.REDO){a=this.undoManager_.hasRedoState()}}return a};goog.editor.plugins.UndoRedo.prototype.dispatchCommandValueChange_=function(){var a=this.getCurrentEventTarget();a.dispatchEvent({type:goog.editor.Field.EventType.COMMAND_VALUE_CHANGE,commands:[goog.editor.plugins.UndoRedo.COMMAND.REDO,goog.editor.plugins.UndoRedo.COMMAND.UNDO]})};goog.editor.plugins.UndoRedo.prototype.restoreState=function(d,c,a){var b=this.getFieldObject(d.fieldHashCode);if(!b){return}b.stopChangeEvents(true,true);try{b.dispatchBeforeChange();b.execCommand(goog.editor.Command.CLEAR_LOREM,true);b.getElement().innerHTML=c;if(a){a.select()}var g=this.getCurrentFieldObject();b.focus();if(g&&g.getHashCode()!=d.fieldHashCode){g.execCommand(goog.editor.Command.UPDATE_LOREM)}this.currentStates_[d.fieldHashCode].setUndoState(c,a)}catch(f){this.logger.severe("Error while restoring undo state",f)}finally{this.inProgressUndo_=d;b.dispatchChange();b.dispatchSelectionChangeEvent()}};goog.editor.plugins.UndoRedo.prototype.handleKeyboardShortcut=function(d,a,b){if(b){var f;if(a=="z"){f=d.shiftKey?goog.editor.plugins.UndoRedo.COMMAND.REDO:goog.editor.plugins.UndoRedo.COMMAND.UNDO}else{if(a=="y"){f=goog.editor.plugins.UndoRedo.COMMAND.REDO}}if(f){var c=f==goog.editor.plugins.UndoRedo.COMMAND.UNDO?this.undoManager_.undoPeek():this.undoManager_.redoPeek();if(c&&c.fieldHashCode){this.getCurrentFieldObject().execCommand(f)}else{this.execCommand(f)}return true}}return false};goog.editor.plugins.UndoRedo.prototype.clearHistory=function(){this.fieldObject.stopChangeEvents(true,true);this.undoManager_.clearHistory();this.fieldObject.startChangeEvents()};goog.editor.plugins.UndoRedo.prototype.refreshCurrentState=function(a){if(this.isEnabled(a)){if(this.currentStates_[a.getHashCode()]){delete this.currentStates_[a.getHashCode()]}this.updateCurrentState_(a)}};goog.editor.plugins.UndoRedo.prototype.handleBeforeChange_=function(c){if(this.inProgressUndo_){return}var b=(c.target);var a=b.getHashCode();if(this.initialFieldChange_!=a){this.initialFieldChange_=a;this.updateCurrentState_(b)}};goog.editor.plugins.UndoRedo.prototype.handleDelayedChange_=function(b){if(this.inProgressUndo_){var a=this.inProgressUndo_;this.inProgressUndo_=null;a.dispatchEvent(goog.editor.plugins.UndoRedoState.ACTION_COMPLETED);return}this.updateCurrentState_((b.target))};goog.editor.plugins.UndoRedo.prototype.handleBlur_=function(b){var a=(b.target);if(a){a.clearDelayedChange()}};goog.editor.plugins.UndoRedo.prototype.getCursorPosition_=function(a){var b=new goog.editor.plugins.UndoRedo.CursorPosition_(a);if(!b.isValid()){return null}return b};goog.editor.plugins.UndoRedo.prototype.updateCurrentState_=function(d){var a=d.getHashCode();var e,f;if(d.queryCommandValue(goog.editor.Command.USING_LOREM)){e="";f=null}else{e=d.getElement().innerHTML;f=this.getCursorPosition_(d)}var c=this.currentStates_[a];if(c){if(c.undoContent_==e){return}else{if(e==""||c.undoContent_==""){var b=d.getInjectableContents("",{});if(e==b&&c.undoContent_==""||c.undoContent_==b&&e==""){return}}}c.setRedoState(e,f);this.undoManager_.addState(c)}this.currentStates_[a]=new goog.editor.plugins.UndoRedo.UndoState_(a,e,f,this.boundRestoreState_)};goog.editor.plugins.UndoRedo.UndoState_=function(b,d,a,c){goog.editor.plugins.UndoRedoState.call(this,true);this.fieldHashCode=b;this.restore_=c;this.setUndoState(d,a)};goog.inherits(goog.editor.plugins.UndoRedo.UndoState_,goog.editor.plugins.UndoRedoState);goog.editor.plugins.UndoRedo.UndoState_.prototype.undoContent_;goog.editor.plugins.UndoRedo.UndoState_.prototype.undoCursorPosition_;goog.editor.plugins.UndoRedo.UndoState_.prototype.redoContent_;goog.editor.plugins.UndoRedo.UndoState_.prototype.redoCursorPosition_;goog.editor.plugins.UndoRedo.UndoState_.prototype.undo=function(){this.restore_(this,this.undoContent_,this.undoCursorPosition_)};goog.editor.plugins.UndoRedo.UndoState_.prototype.redo=function(){this.restore_(this,this.redoContent_,this.redoCursorPosition_)};goog.editor.plugins.UndoRedo.UndoState_.prototype.setUndoState=function(b,a){this.undoContent_=b;this.undoCursorPosition_=a};goog.editor.plugins.UndoRedo.UndoState_.prototype.setRedoState=function(b,a){this.redoContent_=b;this.redoCursorPosition_=a};goog.editor.plugins.UndoRedo.UndoState_.prototype.equals=function(a){return this.fieldHashCode==a.fieldHashCode&&this.undoContent_==a.undoContent_&&this.redoContent_==a.redoContent_};goog.editor.plugins.UndoRedo.CursorPosition_=function(d){this.field_=d;var c=d.getEditableDomHelper().getWindow();var a=d.getRange();var b=!!a&&a.isRangeInDocument()&&a.getWindow()==c;a=b?a:null;if(goog.editor.BrowserFeature.HAS_W3C_RANGES){this.initW3C_(a)}else{if(goog.editor.BrowserFeature.HAS_IE_RANGES){this.initIE_(a)}}};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.initW3C_=function(c){this.isValid_=false;if(!c){return}var e=c.getAnchorNode();var g=c.getFocusNode();if(!e||!g){return}var f=c.getAnchorOffset();var d=new goog.dom.NodeOffset(e,this.field_.getElement());var b=c.getFocusOffset();var a=new goog.dom.NodeOffset(g,this.field_.getElement());if(c.isReversed()){this.startOffset_=a;this.startChildOffset_=b;this.endOffset_=d;this.endChildOffset_=f}else{this.startOffset_=d;this.startChildOffset_=f;this.endOffset_=a;this.endChildOffset_=b}this.isValid_=true};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.initIE_=function(a){this.isValid_=false;if(!a){return}var d=a.getTextRange(0).getBrowserRangeObject();if(!goog.dom.contains(this.field_.getElement(),d.parentElement())){return}var e=this.field_.getEditableDomHelper().getDocument().body.createTextRange();e.moveToElementText(this.field_.getElement());var b=d.duplicate();b.collapse(true);b.setEndPoint("StartToStart",e);this.startOffset_=goog.editor.plugins.UndoRedo.CursorPosition_.computeEndOffsetIE_(b);var c=d.duplicate();c.setEndPoint("StartToStart",e);this.endOffset_=goog.editor.plugins.UndoRedo.CursorPosition_.computeEndOffsetIE_(c);this.isValid_=true};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.isValid=function(){return this.isValid_};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.toString=function(){if(goog.editor.BrowserFeature.HAS_W3C_RANGES){return"W3C:"+this.startOffset_.toString()+"\n"+this.startChildOffset_+":"+this.endOffset_.toString()+"\n"+this.endChildOffset_}return"IE:"+this.startOffset_+","+this.endOffset_};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.select=function(){var a=this.getRange_(this.field_.getElement());if(a){if(goog.editor.BrowserFeature.HAS_IE_RANGES){this.field_.getElement().focus()}goog.dom.Range.createFromBrowserRange(a).select()}};goog.editor.plugins.UndoRedo.CursorPosition_.prototype.getRange_=function(d){if(goog.editor.BrowserFeature.HAS_W3C_RANGES){var b=this.startOffset_.findTargetNode(d);var a=this.endOffset_.findTargetNode(d);if(!b||!a){return null}return(goog.dom.Range.createFromNodes(b,this.startChildOffset_,a,this.endChildOffset_).getBrowserRangeObject())}var c=d.ownerDocument.body.createTextRange();c.moveToElementText(d);c.collapse(true);c.moveEnd("character",this.endOffset_);c.moveStart("character",this.startOffset_);return c};goog.editor.plugins.UndoRedo.CursorPosition_.computeEndOffsetIE_=function(b){var c=b.duplicate();var f=b.text;var h=f.length;c.collapse(true);c.moveEnd("character",h);var d;var a=10;while(d=c.compareEndPoints("EndToEnd",b)){h-=d;c.moveEnd("character",-d);--a;if(0==a){break}}var e=0;var g=f.indexOf("\n\r");while(g!=-1){++e;g=f.indexOf("\n\r",g+1)}return h+e};